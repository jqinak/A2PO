/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
2025-12-31 22:09:07,273	INFO worker.py:2003 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/ray/_private/worker.py:2051: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
[36m(pid=418303)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=418303)[0m   import pynvml  # type: ignore[import]
[33m(raylet)[0m [2025-12-31 22:09:26,297 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.015 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(TaskRunner pid=418303)[0m /project/peilab/qjl/CODE/verl/verl/trainer/main_ppo.py:307: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=418303)[0m   use_critic=need_critic(config),
ray init kwargs: {'num_cpus': None, 'runtime_env': {'env_vars': {'TOKENIZERS_PARALLELISM': 'true', 'NCCL_DEBUG': 'WARN', 'VLLM_LOGGING_LEVEL': 'WARN', 'VLLM_ALLOW_RUNTIME_LORA_UPDATING': 'true', 'VLLM_ALLREDUCE_USE_SYMM_MEM': '0', 'CUDA_DEVICE_MAX_CONNECTIONS': '1', 'NCCL_CUMEM_ENABLE': '0'}, 'working_dir': None}}
[36m(TaskRunner pid=418303)[0m TaskRunner hostname: dgx-12, PID: 418303
[36m(TaskRunner pid=418303)[0m {'actor_rollout_ref': {'actor': {'_target_': 'verl.workers.config.FSDPActorConfig',
[36m(TaskRunner pid=418303)[0m                                  'calculate_entropy': False,
[36m(TaskRunner pid=418303)[0m                                  'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=418303)[0m                                                 'async_save': False,
[36m(TaskRunner pid=418303)[0m                                                 'load_contents': ['model',
[36m(TaskRunner pid=418303)[0m                                                                   'optimizer',
[36m(TaskRunner pid=418303)[0m                                                                   'extra'],
[36m(TaskRunner pid=418303)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=418303)[0m                                                                   'optimizer',
[36m(TaskRunner pid=418303)[0m                                                                   'extra']},
[36m(TaskRunner pid=418303)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=418303)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=418303)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=418303)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=418303)[0m                                  'data_loader_seed': 42,
[36m(TaskRunner pid=418303)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=418303)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=418303)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=418303)[0m                                  'freeze_vision_tower': False,
[36m(TaskRunner pid=418303)[0m                                  'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=418303)[0m                                                  'dtype': 'bfloat16',
[36m(TaskRunner pid=418303)[0m                                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=418303)[0m                                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=418303)[0m                                                  'forward_only': False,
[36m(TaskRunner pid=418303)[0m                                                  'forward_prefetch': False,
[36m(TaskRunner pid=418303)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=418303)[0m                                                  'full_determinism': False,
[36m(TaskRunner pid=418303)[0m                                                  'model_dtype': 'fp32',
[36m(TaskRunner pid=418303)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=418303)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=418303)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=418303)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=418303)[0m                                                  'seed': 42,
[36m(TaskRunner pid=418303)[0m                                                  'strategy': 'fsdp',
[36m(TaskRunner pid=418303)[0m                                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=418303)[0m                                                  'use_orig_params': False,
[36m(TaskRunner pid=418303)[0m                                                  'use_torch_compile': True,
[36m(TaskRunner pid=418303)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=418303)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=418303)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=418303)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=418303)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=418303)[0m                                  'loss_scale_factor': None,
[36m(TaskRunner pid=418303)[0m                                  'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=418303)[0m                                            'betas': [0.9, 0.999],
[36m(TaskRunner pid=418303)[0m                                            'clip_grad': 1.0,
[36m(TaskRunner pid=418303)[0m                                            'lr': 1e-06,
[36m(TaskRunner pid=418303)[0m                                            'lr_scheduler_type': 'constant',
[36m(TaskRunner pid=418303)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=418303)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=418303)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=418303)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=418303)[0m                                            'optimizer': 'AdamW',
[36m(TaskRunner pid=418303)[0m                                            'optimizer_impl': 'torch.optim',
[36m(TaskRunner pid=418303)[0m                                            'override_optimizer_config': None,
[36m(TaskRunner pid=418303)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=418303)[0m                                            'warmup_style': None,
[36m(TaskRunner pid=418303)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=418303)[0m                                  'policy_loss': {'_target_': 'verl.workers.config.PolicyLossConfig',
[36m(TaskRunner pid=418303)[0m                                                  'clip_cov_lb': 1.0,
[36m(TaskRunner pid=418303)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=418303)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=418303)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=418303)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=418303)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=418303)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=418303)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=418303)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=418303)[0m                                  'ppo_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=418303)[0m                                  'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=418303)[0m                                  'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=418303)[0m                                               'all_ranks': False,
[36m(TaskRunner pid=418303)[0m                                               'enable': False,
[36m(TaskRunner pid=418303)[0m                                               'ranks': [],
[36m(TaskRunner pid=418303)[0m                                               'save_path': 'outputs/profile',
[36m(TaskRunner pid=418303)[0m                                               'tool': None,
[36m(TaskRunner pid=418303)[0m                                               'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=418303)[0m                                                                       'analysis': True,
[36m(TaskRunner pid=418303)[0m                                                                       'contents': [],
[36m(TaskRunner pid=418303)[0m                                                                       'discrete': False,
[36m(TaskRunner pid=418303)[0m                                                                       'level': 'level0'},
[36m(TaskRunner pid=418303)[0m                                                               'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=418303)[0m                                                                        'discrete': False},
[36m(TaskRunner pid=418303)[0m                                                               'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=418303)[0m                                                                         'step_end': None,
[36m(TaskRunner pid=418303)[0m                                                                         'step_start': 0},
[36m(TaskRunner pid=418303)[0m                                                               'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=418303)[0m                                                                                'stack_depth': 32,
[36m(TaskRunner pid=418303)[0m                                                                                'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=418303)[0m                                  'rollout_n': 16,
[36m(TaskRunner pid=418303)[0m                                  'router_replay': {'_target_': 'verl.workers.config.RouterReplayConfig',
[36m(TaskRunner pid=418303)[0m                                                    'mode': 'disabled',
[36m(TaskRunner pid=418303)[0m                                                    'record_file': None,
[36m(TaskRunner pid=418303)[0m                                                    'replay_file': None},
[36m(TaskRunner pid=418303)[0m                                  'shuffle': False,
[36m(TaskRunner pid=418303)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=418303)[0m                                  'tau_neg': 1.05,
[36m(TaskRunner pid=418303)[0m                                  'tau_pos': 1.0,
[36m(TaskRunner pid=418303)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=418303)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=418303)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=418303)[0m                                  'use_kl_loss': False,
[36m(TaskRunner pid=418303)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=418303)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=418303)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=418303)[0m                        'model': {'_target_': 'verl.workers.config.HFModelConfig',
[36m(TaskRunner pid=418303)[0m                                  'custom_chat_template': '{% set image_count = '
[36m(TaskRunner pid=418303)[0m                                                          'namespace(value=0) '
[36m(TaskRunner pid=418303)[0m                                                          '%}{% set video_count '
[36m(TaskRunner pid=418303)[0m                                                          '= namespace(value=0) '
[36m(TaskRunner pid=418303)[0m                                                          '%}{%- if tools %}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'<|im_start|>system\\n' "
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- if '
[36m(TaskRunner pid=418303)[0m                                                          "messages[0]['role'] "
[36m(TaskRunner pid=418303)[0m                                                          "== 'system' %}{{- "
[36m(TaskRunner pid=418303)[0m                                                          "messages[0]['content'] "
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- else %}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'You are a helpful "
[36m(TaskRunner pid=418303)[0m                                                          "assistant.' }}{%- "
[36m(TaskRunner pid=418303)[0m                                                          'endif %}{{- "\\n\\n# '
[36m(TaskRunner pid=418303)[0m                                                          'Tools\\n\\nYou may '
[36m(TaskRunner pid=418303)[0m                                                          'call one or more '
[36m(TaskRunner pid=418303)[0m                                                          'functions to assist '
[36m(TaskRunner pid=418303)[0m                                                          'with the user '
[36m(TaskRunner pid=418303)[0m                                                          'query.\\n\\nYou are '
[36m(TaskRunner pid=418303)[0m                                                          'provided with '
[36m(TaskRunner pid=418303)[0m                                                          'function signatures '
[36m(TaskRunner pid=418303)[0m                                                          'within '
[36m(TaskRunner pid=418303)[0m                                                          '<tools></tools> XML '
[36m(TaskRunner pid=418303)[0m                                                          'tags:\\n<tools>" '
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- for tool in '
[36m(TaskRunner pid=418303)[0m                                                          'tools %}{{- "\\n" '
[36m(TaskRunner pid=418303)[0m                                                          '}}{{- tool | tojson '
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- endfor %}{{- '
[36m(TaskRunner pid=418303)[0m                                                          '"\\n</tools>\\n\\nFor '
[36m(TaskRunner pid=418303)[0m                                                          'each function call, '
[36m(TaskRunner pid=418303)[0m                                                          'return a json object '
[36m(TaskRunner pid=418303)[0m                                                          'with function name '
[36m(TaskRunner pid=418303)[0m                                                          'and arguments within '
[36m(TaskRunner pid=418303)[0m                                                          '<tool_call></tool_call> '
[36m(TaskRunner pid=418303)[0m                                                          'XML '
[36m(TaskRunner pid=418303)[0m                                                          'tags:\\n<tool_call>\\n{\\"name\\": '
[36m(TaskRunner pid=418303)[0m                                                          '<function-name>, '
[36m(TaskRunner pid=418303)[0m                                                          '\\"arguments\\": '
[36m(TaskRunner pid=418303)[0m                                                          '<args-json-object>}\\n</tool_call><|im_end|>\\n" '
[36m(TaskRunner pid=418303)[0m                                                          '}}{% for message in '
[36m(TaskRunner pid=418303)[0m                                                          'messages %}{% if '
[36m(TaskRunner pid=418303)[0m                                                          "message['role'] != "
[36m(TaskRunner pid=418303)[0m                                                          "'system' or "
[36m(TaskRunner pid=418303)[0m                                                          'loop.first == false '
[36m(TaskRunner pid=418303)[0m                                                          '%}{%- if '
[36m(TaskRunner pid=418303)[0m                                                          '(message.role == '
[36m(TaskRunner pid=418303)[0m                                                          '"user") or '
[36m(TaskRunner pid=418303)[0m                                                          '(message.role == '
[36m(TaskRunner pid=418303)[0m                                                          '"system" and not '
[36m(TaskRunner pid=418303)[0m                                                          'loop.first) or '
[36m(TaskRunner pid=418303)[0m                                                          '(message.role == '
[36m(TaskRunner pid=418303)[0m                                                          '"assistant" and not '
[36m(TaskRunner pid=418303)[0m                                                          'message.tool_calls) '
[36m(TaskRunner pid=418303)[0m                                                          '%}<|im_start|>{{ '
[36m(TaskRunner pid=418303)[0m                                                          "message['role'] }}\n"
[36m(TaskRunner pid=418303)[0m                                                          '{% if '
[36m(TaskRunner pid=418303)[0m                                                          "message['content'] "
[36m(TaskRunner pid=418303)[0m                                                          'is string %}{{ '
[36m(TaskRunner pid=418303)[0m                                                          "message['content'] "
[36m(TaskRunner pid=418303)[0m                                                          '}}<|im_end|>\n'
[36m(TaskRunner pid=418303)[0m                                                          '{% else %}{% for '
[36m(TaskRunner pid=418303)[0m                                                          'content in '
[36m(TaskRunner pid=418303)[0m                                                          "message['content'] "
[36m(TaskRunner pid=418303)[0m                                                          '%}{% if '
[36m(TaskRunner pid=418303)[0m                                                          "content['type'] == "
[36m(TaskRunner pid=418303)[0m                                                          "'image' or 'image' "
[36m(TaskRunner pid=418303)[0m                                                          'in content or '
[36m(TaskRunner pid=418303)[0m                                                          "'image_url' in "
[36m(TaskRunner pid=418303)[0m                                                          'content %}{% set '
[36m(TaskRunner pid=418303)[0m                                                          'image_count.value = '
[36m(TaskRunner pid=418303)[0m                                                          'image_count.value + '
[36m(TaskRunner pid=418303)[0m                                                          '1 %}{% if '
[36m(TaskRunner pid=418303)[0m                                                          'add_vision_id '
[36m(TaskRunner pid=418303)[0m                                                          '%}Picture {{ '
[36m(TaskRunner pid=418303)[0m                                                          'image_count.value '
[36m(TaskRunner pid=418303)[0m                                                          '}}: {% endif '
[36m(TaskRunner pid=418303)[0m                                                          '%}<|vision_start|><|image_pad|><|vision_end|>{% '
[36m(TaskRunner pid=418303)[0m                                                          "elif content['type'] "
[36m(TaskRunner pid=418303)[0m                                                          "== 'video' or "
[36m(TaskRunner pid=418303)[0m                                                          "'video' in content "
[36m(TaskRunner pid=418303)[0m                                                          '%}{% set '
[36m(TaskRunner pid=418303)[0m                                                          'video_count.value = '
[36m(TaskRunner pid=418303)[0m                                                          'video_count.value + '
[36m(TaskRunner pid=418303)[0m                                                          '1 %}{% if '
[36m(TaskRunner pid=418303)[0m                                                          'add_vision_id '
[36m(TaskRunner pid=418303)[0m                                                          '%}Video {{ '
[36m(TaskRunner pid=418303)[0m                                                          'video_count.value '
[36m(TaskRunner pid=418303)[0m                                                          '}}: {% endif '
[36m(TaskRunner pid=418303)[0m                                                          '%}<|vision_start|><|video_pad|><|vision_end|>{% '
[36m(TaskRunner pid=418303)[0m                                                          "elif 'text' in "
[36m(TaskRunner pid=418303)[0m                                                          'content %}{{ '
[36m(TaskRunner pid=418303)[0m                                                          "content['text'] }}{% "
[36m(TaskRunner pid=418303)[0m                                                          'endif %}{% endfor '
[36m(TaskRunner pid=418303)[0m                                                          '%}<|im_end|>\n'
[36m(TaskRunner pid=418303)[0m                                                          '{% endif %}{%- elif '
[36m(TaskRunner pid=418303)[0m                                                          'message.role == '
[36m(TaskRunner pid=418303)[0m                                                          '"assistant" %}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'<|im_start|>' + "
[36m(TaskRunner pid=418303)[0m                                                          'message.role }}{%- '
[36m(TaskRunner pid=418303)[0m                                                          'if message.content '
[36m(TaskRunner pid=418303)[0m                                                          "%}{{- '\\n' + "
[36m(TaskRunner pid=418303)[0m                                                          'message.content '
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- endif %}{%- '
[36m(TaskRunner pid=418303)[0m                                                          'for tool_call in '
[36m(TaskRunner pid=418303)[0m                                                          'message.tool_calls '
[36m(TaskRunner pid=418303)[0m                                                          '%}{%- if '
[36m(TaskRunner pid=418303)[0m                                                          'tool_call.function '
[36m(TaskRunner pid=418303)[0m                                                          'is defined %}{%- set '
[36m(TaskRunner pid=418303)[0m                                                          'tool_call = '
[36m(TaskRunner pid=418303)[0m                                                          'tool_call.function '
[36m(TaskRunner pid=418303)[0m                                                          '%}{%- endif %}{{- '
[36m(TaskRunner pid=418303)[0m                                                          '\'\\n<tool_call>\\n{"name": '
[36m(TaskRunner pid=418303)[0m                                                          '"\' }}{{- '
[36m(TaskRunner pid=418303)[0m                                                          'tool_call.name }}{{- '
[36m(TaskRunner pid=418303)[0m                                                          '\'", "arguments": \' '
[36m(TaskRunner pid=418303)[0m                                                          '}}{{- '
[36m(TaskRunner pid=418303)[0m                                                          'tool_call.arguments '
[36m(TaskRunner pid=418303)[0m                                                          '| tojson }}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'}\\n</tool_call>' "
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- endfor %}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'<|im_end|>\\n' "
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- elif '
[36m(TaskRunner pid=418303)[0m                                                          'message.role == '
[36m(TaskRunner pid=418303)[0m                                                          '"tool" %}{%- if '
[36m(TaskRunner pid=418303)[0m                                                          '(loop.index0 == 0) '
[36m(TaskRunner pid=418303)[0m                                                          'or '
[36m(TaskRunner pid=418303)[0m                                                          '(messages[loop.index0 '
[36m(TaskRunner pid=418303)[0m                                                          '- 1].role != "tool") '
[36m(TaskRunner pid=418303)[0m                                                          '%}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'<|im_start|>user' "
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- endif %}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'\\n<tool_response>\\n' "
[36m(TaskRunner pid=418303)[0m                                                          '}}{% if '
[36m(TaskRunner pid=418303)[0m                                                          "message['content'] "
[36m(TaskRunner pid=418303)[0m                                                          'is string %}{{ '
[36m(TaskRunner pid=418303)[0m                                                          'message.content }}{% '
[36m(TaskRunner pid=418303)[0m                                                          'else %}{% for '
[36m(TaskRunner pid=418303)[0m                                                          'content in '
[36m(TaskRunner pid=418303)[0m                                                          "message['content'] "
[36m(TaskRunner pid=418303)[0m                                                          '%}{% if '
[36m(TaskRunner pid=418303)[0m                                                          "content['type'] == "
[36m(TaskRunner pid=418303)[0m                                                          "'image' or 'image' "
[36m(TaskRunner pid=418303)[0m                                                          'in content or '
[36m(TaskRunner pid=418303)[0m                                                          "'image_url' in "
[36m(TaskRunner pid=418303)[0m                                                          'content %}{% set '
[36m(TaskRunner pid=418303)[0m                                                          'image_count.value = '
[36m(TaskRunner pid=418303)[0m                                                          'image_count.value + '
[36m(TaskRunner pid=418303)[0m                                                          '1 %}{% if '
[36m(TaskRunner pid=418303)[0m                                                          'add_vision_id '
[36m(TaskRunner pid=418303)[0m                                                          '%}Picture {{ '
[36m(TaskRunner pid=418303)[0m                                                          'image_count.value '
[36m(TaskRunner pid=418303)[0m                                                          '}}: {% endif '
[36m(TaskRunner pid=418303)[0m                                                          '%}<|vision_start|><|image_pad|><|vision_end|>{% '
[36m(TaskRunner pid=418303)[0m                                                          "elif content['type'] "
[36m(TaskRunner pid=418303)[0m                                                          "== 'video' or "
[36m(TaskRunner pid=418303)[0m                                                          "'video' in content "
[36m(TaskRunner pid=418303)[0m                                                          '%}{% set '
[36m(TaskRunner pid=418303)[0m                                                          'video_count.value = '
[36m(TaskRunner pid=418303)[0m                                                          'video_count.value + '
[36m(TaskRunner pid=418303)[0m                                                          '1 %}{% if '
[36m(TaskRunner pid=418303)[0m                                                          'add_vision_id '
[36m(TaskRunner pid=418303)[0m                                                          '%}Video {{ '
[36m(TaskRunner pid=418303)[0m                                                          'video_count.value '
[36m(TaskRunner pid=418303)[0m                                                          '}}: {% endif '
[36m(TaskRunner pid=418303)[0m                                                          '%}<|vision_start|><|video_pad|><|vision_end|>{% '
[36m(TaskRunner pid=418303)[0m                                                          "elif content['type'] "
[36m(TaskRunner pid=418303)[0m                                                          "== 'text' or 'text' "
[36m(TaskRunner pid=418303)[0m                                                          'in content %}{{ '
[36m(TaskRunner pid=418303)[0m                                                          "content['text'] }}{% "
[36m(TaskRunner pid=418303)[0m                                                          'endif %}{% endfor '
[36m(TaskRunner pid=418303)[0m                                                          '%}{% endif %}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'\\n</tool_response>' "
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- if loop.last '
[36m(TaskRunner pid=418303)[0m                                                          'or '
[36m(TaskRunner pid=418303)[0m                                                          '(messages[loop.index0 '
[36m(TaskRunner pid=418303)[0m                                                          '+ 1].role != "tool") '
[36m(TaskRunner pid=418303)[0m                                                          '%}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'<|im_end|>\\n' "
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- endif %}{%- '
[36m(TaskRunner pid=418303)[0m                                                          'endif %}{% endif '
[36m(TaskRunner pid=418303)[0m                                                          '%}{% endfor %}{%- '
[36m(TaskRunner pid=418303)[0m                                                          'else %}{% for '
[36m(TaskRunner pid=418303)[0m                                                          'message in messages '
[36m(TaskRunner pid=418303)[0m                                                          '%}{% if loop.first '
[36m(TaskRunner pid=418303)[0m                                                          "and message['role'] "
[36m(TaskRunner pid=418303)[0m                                                          "!= 'system' "
[36m(TaskRunner pid=418303)[0m                                                          '%}<|im_start|>system\n'
[36m(TaskRunner pid=418303)[0m                                                          'You are a helpful '
[36m(TaskRunner pid=418303)[0m                                                          'assistant.<|im_end|>\n'
[36m(TaskRunner pid=418303)[0m                                                          '{% endif %}{%- if '
[36m(TaskRunner pid=418303)[0m                                                          '(message.role == '
[36m(TaskRunner pid=418303)[0m                                                          '"user") or '
[36m(TaskRunner pid=418303)[0m                                                          '(message.role == '
[36m(TaskRunner pid=418303)[0m                                                          '"system" and not '
[36m(TaskRunner pid=418303)[0m                                                          'loop.first) or '
[36m(TaskRunner pid=418303)[0m                                                          '(message.role == '
[36m(TaskRunner pid=418303)[0m                                                          '"assistant" and not '
[36m(TaskRunner pid=418303)[0m                                                          'message.tool_calls) '
[36m(TaskRunner pid=418303)[0m                                                          '%}<|im_start|>{{ '
[36m(TaskRunner pid=418303)[0m                                                          "message['role'] }}\n"
[36m(TaskRunner pid=418303)[0m                                                          '{% if '
[36m(TaskRunner pid=418303)[0m                                                          "message['content'] "
[36m(TaskRunner pid=418303)[0m                                                          'is string %}{{ '
[36m(TaskRunner pid=418303)[0m                                                          "message['content'] "
[36m(TaskRunner pid=418303)[0m                                                          '}}<|im_end|>\n'
[36m(TaskRunner pid=418303)[0m                                                          '{% else %}{% for '
[36m(TaskRunner pid=418303)[0m                                                          'content in '
[36m(TaskRunner pid=418303)[0m                                                          "message['content'] "
[36m(TaskRunner pid=418303)[0m                                                          '%}{% if '
[36m(TaskRunner pid=418303)[0m                                                          "content['type'] == "
[36m(TaskRunner pid=418303)[0m                                                          "'image' or 'image' "
[36m(TaskRunner pid=418303)[0m                                                          'in content or '
[36m(TaskRunner pid=418303)[0m                                                          "'image_url' in "
[36m(TaskRunner pid=418303)[0m                                                          'content %}{% set '
[36m(TaskRunner pid=418303)[0m                                                          'image_count.value = '
[36m(TaskRunner pid=418303)[0m                                                          'image_count.value + '
[36m(TaskRunner pid=418303)[0m                                                          '1 %}{% if '
[36m(TaskRunner pid=418303)[0m                                                          'add_vision_id '
[36m(TaskRunner pid=418303)[0m                                                          '%}Picture {{ '
[36m(TaskRunner pid=418303)[0m                                                          'image_count.value '
[36m(TaskRunner pid=418303)[0m                                                          '}}: {% endif '
[36m(TaskRunner pid=418303)[0m                                                          '%}<|vision_start|><|image_pad|><|vision_end|>{% '
[36m(TaskRunner pid=418303)[0m                                                          "elif content['type'] "
[36m(TaskRunner pid=418303)[0m                                                          "== 'video' or "
[36m(TaskRunner pid=418303)[0m                                                          "'video' in content "
[36m(TaskRunner pid=418303)[0m                                                          '%}{% set '
[36m(TaskRunner pid=418303)[0m                                                          'video_count.value = '
[36m(TaskRunner pid=418303)[0m                                                          'video_count.value + '
[36m(TaskRunner pid=418303)[0m                                                          '1 %}{% if '
[36m(TaskRunner pid=418303)[0m                                                          'add_vision_id '
[36m(TaskRunner pid=418303)[0m                                                          '%}Video {{ '
[36m(TaskRunner pid=418303)[0m                                                          'video_count.value '
[36m(TaskRunner pid=418303)[0m                                                          '}}: {% endif '
[36m(TaskRunner pid=418303)[0m                                                          '%}<|vision_start|><|video_pad|><|vision_end|>{% '
[36m(TaskRunner pid=418303)[0m                                                          "elif 'text' in "
[36m(TaskRunner pid=418303)[0m                                                          'content %}{{ '
[36m(TaskRunner pid=418303)[0m                                                          "content['text'] }}{% "
[36m(TaskRunner pid=418303)[0m                                                          'endif %}{% endfor '
[36m(TaskRunner pid=418303)[0m                                                          '%}<|im_end|>\n'
[36m(TaskRunner pid=418303)[0m                                                          '{% endif %}{%- elif '
[36m(TaskRunner pid=418303)[0m                                                          'message.role == '
[36m(TaskRunner pid=418303)[0m                                                          '"assistant" %}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'<|im_start|>' + "
[36m(TaskRunner pid=418303)[0m                                                          'message.role }}{%- '
[36m(TaskRunner pid=418303)[0m                                                          'if message.content '
[36m(TaskRunner pid=418303)[0m                                                          "%}{{- '\\n' + "
[36m(TaskRunner pid=418303)[0m                                                          'message.content '
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- endif %}{%- '
[36m(TaskRunner pid=418303)[0m                                                          'for tool_call in '
[36m(TaskRunner pid=418303)[0m                                                          'message.tool_calls '
[36m(TaskRunner pid=418303)[0m                                                          '%}{%- if '
[36m(TaskRunner pid=418303)[0m                                                          'tool_call.function '
[36m(TaskRunner pid=418303)[0m                                                          'is defined %}{%- set '
[36m(TaskRunner pid=418303)[0m                                                          'tool_call = '
[36m(TaskRunner pid=418303)[0m                                                          'tool_call.function '
[36m(TaskRunner pid=418303)[0m                                                          '%}{%- endif %}{{- '
[36m(TaskRunner pid=418303)[0m                                                          '\'\\n<tool_call>\\n{"name": '
[36m(TaskRunner pid=418303)[0m                                                          '"\' }}{{- '
[36m(TaskRunner pid=418303)[0m                                                          'tool_call.name }}{{- '
[36m(TaskRunner pid=418303)[0m                                                          '\'", "arguments": \' '
[36m(TaskRunner pid=418303)[0m                                                          '}}{{- '
[36m(TaskRunner pid=418303)[0m                                                          'tool_call.arguments '
[36m(TaskRunner pid=418303)[0m                                                          '| tojson }}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'}\\n</tool_call>' "
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- endfor %}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'<|im_end|>\\n' "
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- elif '
[36m(TaskRunner pid=418303)[0m                                                          'message.role == '
[36m(TaskRunner pid=418303)[0m                                                          '"tool" %}{%- if '
[36m(TaskRunner pid=418303)[0m                                                          '(loop.index0 == 0) '
[36m(TaskRunner pid=418303)[0m                                                          'or '
[36m(TaskRunner pid=418303)[0m                                                          '(messages[loop.index0 '
[36m(TaskRunner pid=418303)[0m                                                          '- 1].role != "tool") '
[36m(TaskRunner pid=418303)[0m                                                          '%}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'<|im_start|>user' "
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- endif %}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'\\n<tool_response>\\n' "
[36m(TaskRunner pid=418303)[0m                                                          '}}{% if '
[36m(TaskRunner pid=418303)[0m                                                          "message['content'] "
[36m(TaskRunner pid=418303)[0m                                                          'is string %}{{ '
[36m(TaskRunner pid=418303)[0m                                                          'message.content }}{% '
[36m(TaskRunner pid=418303)[0m                                                          'else %}{% for '
[36m(TaskRunner pid=418303)[0m                                                          'content in '
[36m(TaskRunner pid=418303)[0m                                                          "message['content'] "
[36m(TaskRunner pid=418303)[0m                                                          '%}{% if '
[36m(TaskRunner pid=418303)[0m                                                          "content['type'] == "
[36m(TaskRunner pid=418303)[0m                                                          "'image' or 'image' "
[36m(TaskRunner pid=418303)[0m                                                          'in content or '
[36m(TaskRunner pid=418303)[0m                                                          "'image_url' in "
[36m(TaskRunner pid=418303)[0m                                                          'content %}{% set '
[36m(TaskRunner pid=418303)[0m                                                          'image_count.value = '
[36m(TaskRunner pid=418303)[0m                                                          'image_count.value + '
[36m(TaskRunner pid=418303)[0m                                                          '1 %}{% if '
[36m(TaskRunner pid=418303)[0m                                                          'add_vision_id '
[36m(TaskRunner pid=418303)[0m                                                          '%}Picture {{ '
[36m(TaskRunner pid=418303)[0m                                                          'image_count.value '
[36m(TaskRunner pid=418303)[0m                                                          '}}: {% endif '
[36m(TaskRunner pid=418303)[0m                                                          '%}<|vision_start|><|image_pad|><|vision_end|>{% '
[36m(TaskRunner pid=418303)[0m                                                          "elif content['type'] "
[36m(TaskRunner pid=418303)[0m                                                          "== 'video' or "
[36m(TaskRunner pid=418303)[0m                                                          "'video' in content "
[36m(TaskRunner pid=418303)[0m                                                          '%}{% set '
[36m(TaskRunner pid=418303)[0m                                                          'video_count.value = '
[36m(TaskRunner pid=418303)[0m                                                          'video_count.value + '
[36m(TaskRunner pid=418303)[0m                                                          '1 %}{% if '
[36m(TaskRunner pid=418303)[0m                                                          'add_vision_id '
[36m(TaskRunner pid=418303)[0m                                                          '%}Video {{ '
[36m(TaskRunner pid=418303)[0m                                                          'video_count.value '
[36m(TaskRunner pid=418303)[0m                                                          '}}: {% endif '
[36m(TaskRunner pid=418303)[0m                                                          '%}<|vision_start|><|video_pad|><|vision_end|>{% '
[36m(TaskRunner pid=418303)[0m                                                          "elif content['type'] "
[36m(TaskRunner pid=418303)[0m                                                          "== 'text' or 'text' "
[36m(TaskRunner pid=418303)[0m                                                          'in content %}{{ '
[36m(TaskRunner pid=418303)[0m                                                          "content['text'] }}{% "
[36m(TaskRunner pid=418303)[0m                                                          'endif %}{% endfor '
[36m(TaskRunner pid=418303)[0m                                                          '%}{% endif %}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'\\n</tool_response>' "
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- if loop.last '
[36m(TaskRunner pid=418303)[0m                                                          'or '
[36m(TaskRunner pid=418303)[0m                                                          '(messages[loop.index0 '
[36m(TaskRunner pid=418303)[0m                                                          '+ 1].role != "tool") '
[36m(TaskRunner pid=418303)[0m                                                          '%}{{- '
[36m(TaskRunner pid=418303)[0m                                                          "'<|im_end|>\\n' "
[36m(TaskRunner pid=418303)[0m                                                          '}}{%- endif %}{%- '
[36m(TaskRunner pid=418303)[0m                                                          'endif %}{% endfor '
[36m(TaskRunner pid=418303)[0m                                                          '%}{%- endif %}{% if '
[36m(TaskRunner pid=418303)[0m                                                          'add_generation_prompt '
[36m(TaskRunner pid=418303)[0m                                                          '%}<|im_start|>assistant\n'
[36m(TaskRunner pid=418303)[0m                                                          '{% endif %}',
[36m(TaskRunner pid=418303)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=418303)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=418303)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=418303)[0m                                  'external_lib': None,
[36m(TaskRunner pid=418303)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=418303)[0m                                  'hf_config_path': None,
[36m(TaskRunner pid=418303)[0m                                  'lora_adapter_path': None,
[36m(TaskRunner pid=418303)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=418303)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=418303)[0m                                  'override_config': {},
[36m(TaskRunner pid=418303)[0m                                  'path': '/project/peilab/qjl/MODEL/Qwen3-VL-4B-Instruct',
[36m(TaskRunner pid=418303)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=418303)[0m                                  'tokenizer_path': None,
[36m(TaskRunner pid=418303)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=418303)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=418303)[0m                                  'use_liger': False,
[36m(TaskRunner pid=418303)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=418303)[0m                                  'use_shm': False},
[36m(TaskRunner pid=418303)[0m                        'nccl_timeout': 600,
[36m(TaskRunner pid=418303)[0m                        'ref': {'_target_': 'verl.workers.config.FSDPActorConfig',
[36m(TaskRunner pid=418303)[0m                                'entropy_checkpointing': False,
[36m(TaskRunner pid=418303)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=418303)[0m                                'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=418303)[0m                                                'dtype': 'bfloat16',
[36m(TaskRunner pid=418303)[0m                                                'entropy_checkpointing': False,
[36m(TaskRunner pid=418303)[0m                                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=418303)[0m                                                'forward_only': True,
[36m(TaskRunner pid=418303)[0m                                                'forward_prefetch': False,
[36m(TaskRunner pid=418303)[0m                                                'fsdp_size': -1,
[36m(TaskRunner pid=418303)[0m                                                'full_determinism': False,
[36m(TaskRunner pid=418303)[0m                                                'model_dtype': 'fp32',
[36m(TaskRunner pid=418303)[0m                                                'offload_policy': False,
[36m(TaskRunner pid=418303)[0m                                                'optimizer_offload': False,
[36m(TaskRunner pid=418303)[0m                                                'param_offload': True,
[36m(TaskRunner pid=418303)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=418303)[0m                                                'seed': 42,
[36m(TaskRunner pid=418303)[0m                                                'strategy': 'fsdp',
[36m(TaskRunner pid=418303)[0m                                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=418303)[0m                                                'use_orig_params': False,
[36m(TaskRunner pid=418303)[0m                                                'use_torch_compile': True,
[36m(TaskRunner pid=418303)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=418303)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=418303)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=418303)[0m                                'log_prob_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=418303)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=418303)[0m                                'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=418303)[0m                                             'all_ranks': False,
[36m(TaskRunner pid=418303)[0m                                             'enable': False,
[36m(TaskRunner pid=418303)[0m                                             'ranks': [],
[36m(TaskRunner pid=418303)[0m                                             'save_path': 'outputs/profile',
[36m(TaskRunner pid=418303)[0m                                             'tool': None,
[36m(TaskRunner pid=418303)[0m                                             'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=418303)[0m                                                                     'analysis': True,
[36m(TaskRunner pid=418303)[0m                                                                     'contents': [],
[36m(TaskRunner pid=418303)[0m                                                                     'discrete': False,
[36m(TaskRunner pid=418303)[0m                                                                     'level': 'level0'},
[36m(TaskRunner pid=418303)[0m                                                             'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=418303)[0m                                                                      'discrete': False},
[36m(TaskRunner pid=418303)[0m                                                             'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=418303)[0m                                                                       'step_end': None,
[36m(TaskRunner pid=418303)[0m                                                                       'step_start': 0},
[36m(TaskRunner pid=418303)[0m                                                             'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=418303)[0m                                                                              'stack_depth': 32,
[36m(TaskRunner pid=418303)[0m                                                                              'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=418303)[0m                                'rollout_n': 16,
[36m(TaskRunner pid=418303)[0m                                'router_replay': {'_target_': 'verl.workers.config.RouterReplayConfig',
[36m(TaskRunner pid=418303)[0m                                                  'mode': 'disabled',
[36m(TaskRunner pid=418303)[0m                                                  'record_file': None,
[36m(TaskRunner pid=418303)[0m                                                  'replay_file': None},
[36m(TaskRunner pid=418303)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=418303)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=418303)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=418303)[0m                        'rollout': {'_target_': 'verl.workers.config.RolloutConfig',
[36m(TaskRunner pid=418303)[0m                                    'agent': {'_target_': 'verl.workers.config.AgentLoopConfig',
[36m(TaskRunner pid=418303)[0m                                              'agent_loop_config_path': None,
[36m(TaskRunner pid=418303)[0m                                              'custom_async_server': {'_target_': 'verl.workers.config.CustomAsyncServerConfig',
[36m(TaskRunner pid=418303)[0m                                                                      'name': None,
[36m(TaskRunner pid=418303)[0m                                                                      'path': None},
[36m(TaskRunner pid=418303)[0m                                              'default_agent_loop': 'single_turn_agent',
[36m(TaskRunner pid=418303)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=418303)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=418303)[0m                                    'cudagraph_capture_sizes': None,
[36m(TaskRunner pid=418303)[0m                                    'data_parallel_size': 1,
[36m(TaskRunner pid=418303)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=418303)[0m                                    'do_sample': True,
[36m(TaskRunner pid=418303)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=418303)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=418303)[0m                                    'enable_prefix_caching': True,
[36m(TaskRunner pid=418303)[0m                                    'enable_rollout_routing_replay': False,
[36m(TaskRunner pid=418303)[0m                                    'enforce_eager': False,
[36m(TaskRunner pid=418303)[0m                                    'engine_kwargs': {'sglang': {}, 'vllm': {}},
[36m(TaskRunner pid=418303)[0m                                    'expert_parallel_size': 1,
[36m(TaskRunner pid=418303)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=418303)[0m                                    'gpu_memory_utilization': 0.5,
[36m(TaskRunner pid=418303)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=418303)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=418303)[0m                                    'load_format': 'dummy',
[36m(TaskRunner pid=418303)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=418303)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=418303)[0m                                    'log_prob_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=418303)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=418303)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=418303)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=418303)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=418303)[0m                                    'mode': 'async',
[36m(TaskRunner pid=418303)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=418303)[0m                                    'multi_turn': {'_target_': 'verl.workers.config.MultiTurnConfig',
[36m(TaskRunner pid=418303)[0m                                                   'enable': True,
[36m(TaskRunner pid=418303)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=418303)[0m                                                   'interaction_config_path': None,
[36m(TaskRunner pid=418303)[0m                                                   'max_assistant_turns': 5,
[36m(TaskRunner pid=418303)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=418303)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=418303)[0m                                                   'max_user_turns': None,
[36m(TaskRunner pid=418303)[0m                                                   'num_repeat_rollouts': None,
[36m(TaskRunner pid=418303)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=418303)[0m                                                   'tool_config_path': '/project/peilab/qjl/CODE/verl/examples/Answer-Ask_VL/a2agent_tool_config.yaml',
[36m(TaskRunner pid=418303)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=418303)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=418303)[0m                                    'n': 16,
[36m(TaskRunner pid=418303)[0m                                    'name': 'sglang',
[36m(TaskRunner pid=418303)[0m                                    'over_sample_rate': 0,
[36m(TaskRunner pid=418303)[0m                                    'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=418303)[0m                                    'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=418303)[0m                                                 'all_ranks': False,
[36m(TaskRunner pid=418303)[0m                                                 'enable': False,
[36m(TaskRunner pid=418303)[0m                                                 'ranks': [],
[36m(TaskRunner pid=418303)[0m                                                 'save_path': 'outputs/profile',
[36m(TaskRunner pid=418303)[0m                                                 'tool': None,
[36m(TaskRunner pid=418303)[0m                                                 'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=418303)[0m                                                                         'analysis': True,
[36m(TaskRunner pid=418303)[0m                                                                         'contents': [],
[36m(TaskRunner pid=418303)[0m                                                                         'discrete': False,
[36m(TaskRunner pid=418303)[0m                                                                         'level': 'level0'},
[36m(TaskRunner pid=418303)[0m                                                                 'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=418303)[0m                                                                          'discrete': False},
[36m(TaskRunner pid=418303)[0m                                                                 'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=418303)[0m                                                                           'step_end': None,
[36m(TaskRunner pid=418303)[0m                                                                           'step_start': 0},
[36m(TaskRunner pid=418303)[0m                                                                 'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=418303)[0m                                                                                  'stack_depth': 32,
[36m(TaskRunner pid=418303)[0m                                                                                  'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=418303)[0m                                    'prometheus': {'_target_': 'verl.workers.config.PrometheusConfig',
[36m(TaskRunner pid=418303)[0m                                                   'enable': False,
[36m(TaskRunner pid=418303)[0m                                                   'file': '/tmp/ray/session_latest/metrics/prometheus/prometheus.yml',
[36m(TaskRunner pid=418303)[0m                                                   'port': 9090,
[36m(TaskRunner pid=418303)[0m                                                   'served_model_name': '/project/peilab/qjl/MODEL/Qwen3-VL-4B-Instruct'},
[36m(TaskRunner pid=418303)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=418303)[0m                                    'quantization': None,
[36m(TaskRunner pid=418303)[0m                                    'quantization_config_file': None,
[36m(TaskRunner pid=418303)[0m                                    'response_length': 2048,
[36m(TaskRunner pid=418303)[0m                                    'skip_dump_dir': '/tmp/rollout_dump',
[36m(TaskRunner pid=418303)[0m                                    'skip_rollout': False,
[36m(TaskRunner pid=418303)[0m                                    'skip_tokenizer_init': True,
[36m(TaskRunner pid=418303)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=418303)[0m                                    'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=418303)[0m                                    'top_k': -1,
[36m(TaskRunner pid=418303)[0m                                    'top_p': 1,
[36m(TaskRunner pid=418303)[0m                                    'trace': {'_target_': 'verl.workers.config.TraceConfig',
[36m(TaskRunner pid=418303)[0m                                              'backend': None,
[36m(TaskRunner pid=418303)[0m                                              'max_samples_per_step_per_worker': None,
[36m(TaskRunner pid=418303)[0m                                              'token2text': False},
[36m(TaskRunner pid=418303)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=418303)[0m                                    'val_kwargs': {'_target_': 'verl.workers.config.SamplingConfig',
[36m(TaskRunner pid=418303)[0m                                                   'do_sample': False,
[36m(TaskRunner pid=418303)[0m                                                   'n': 1,
[36m(TaskRunner pid=418303)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=418303)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=418303)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=418303)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=418303)[0m                'adv_estimator': 'grpo',
[36m(TaskRunner pid=418303)[0m                'gamma': 1.0,
[36m(TaskRunner pid=418303)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=418303)[0m                            'horizon': 10000,
[36m(TaskRunner pid=418303)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=418303)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=418303)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=418303)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=418303)[0m                'lam': 1.0,
[36m(TaskRunner pid=418303)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=418303)[0m                'pf_ppo': {'reweight_method': 'pow', 'weight_pow': 2.0},
[36m(TaskRunner pid=418303)[0m                'rollout_correction': {'bypass_mode': False,
[36m(TaskRunner pid=418303)[0m                                       'loss_type': 'ppo_clip',
[36m(TaskRunner pid=418303)[0m                                       'rollout_is': None,
[36m(TaskRunner pid=418303)[0m                                       'rollout_is_batch_normalize': False,
[36m(TaskRunner pid=418303)[0m                                       'rollout_is_threshold': 2.0,
[36m(TaskRunner pid=418303)[0m                                       'rollout_rs': None,
[36m(TaskRunner pid=418303)[0m                                       'rollout_rs_threshold': None,
[36m(TaskRunner pid=418303)[0m                                       'rollout_rs_threshold_lower': None,
[36m(TaskRunner pid=418303)[0m                                       'rollout_token_veto_threshold': None},
[36m(TaskRunner pid=418303)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=418303)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=418303)[0m  'critic': {'_target_': 'verl.workers.config.FSDPCriticConfig',
[36m(TaskRunner pid=418303)[0m             'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=418303)[0m                            'async_save': False,
[36m(TaskRunner pid=418303)[0m                            'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=418303)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=418303)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=418303)[0m             'data_loader_seed': 42,
[36m(TaskRunner pid=418303)[0m             'enable': None,
[36m(TaskRunner pid=418303)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=418303)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=418303)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=418303)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=418303)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=418303)[0m             'model': {'_target_': 'verl.workers.config.FSDPCriticModelCfg',
[36m(TaskRunner pid=418303)[0m                       'enable_activation_offload': False,
[36m(TaskRunner pid=418303)[0m                       'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=418303)[0m                       'external_lib': None,
[36m(TaskRunner pid=418303)[0m                       'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=418303)[0m                                       'dtype': 'bfloat16',
[36m(TaskRunner pid=418303)[0m                                       'entropy_checkpointing': False,
[36m(TaskRunner pid=418303)[0m                                       'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=418303)[0m                                       'forward_only': False,
[36m(TaskRunner pid=418303)[0m                                       'forward_prefetch': False,
[36m(TaskRunner pid=418303)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=418303)[0m                                       'full_determinism': False,
[36m(TaskRunner pid=418303)[0m                                       'model_dtype': 'fp32',
[36m(TaskRunner pid=418303)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=418303)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=418303)[0m                                       'param_offload': False,
[36m(TaskRunner pid=418303)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=418303)[0m                                       'seed': 42,
[36m(TaskRunner pid=418303)[0m                                       'strategy': 'fsdp',
[36m(TaskRunner pid=418303)[0m                                       'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=418303)[0m                                       'use_orig_params': False,
[36m(TaskRunner pid=418303)[0m                                       'use_torch_compile': True,
[36m(TaskRunner pid=418303)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=418303)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=418303)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=418303)[0m                       'override_config': {},
[36m(TaskRunner pid=418303)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=418303)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=418303)[0m                       'tokenizer_path': '/project/peilab/qjl/MODEL/Qwen3-VL-4B-Instruct',
[36m(TaskRunner pid=418303)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=418303)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=418303)[0m                       'use_shm': False},
[36m(TaskRunner pid=418303)[0m             'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=418303)[0m                       'betas': [0.9, 0.999],
[36m(TaskRunner pid=418303)[0m                       'clip_grad': 1.0,
[36m(TaskRunner pid=418303)[0m                       'lr': 1e-05,
[36m(TaskRunner pid=418303)[0m                       'lr_scheduler_type': 'constant',
[36m(TaskRunner pid=418303)[0m                       'lr_warmup_steps': -1,
[36m(TaskRunner pid=418303)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=418303)[0m                       'min_lr_ratio': 0.0,
[36m(TaskRunner pid=418303)[0m                       'num_cycles': 0.5,
[36m(TaskRunner pid=418303)[0m                       'optimizer': 'AdamW',
[36m(TaskRunner pid=418303)[0m                       'optimizer_impl': 'torch.optim',
[36m(TaskRunner pid=418303)[0m                       'override_optimizer_config': None,
[36m(TaskRunner pid=418303)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=418303)[0m                       'warmup_style': None,
[36m(TaskRunner pid=418303)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=418303)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=418303)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=418303)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=418303)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=418303)[0m             'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=418303)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=418303)[0m                          'all_ranks': False,
[36m(TaskRunner pid=418303)[0m                          'enable': False,
[36m(TaskRunner pid=418303)[0m                          'ranks': [],
[36m(TaskRunner pid=418303)[0m                          'save_path': 'outputs/profile',
[36m(TaskRunner pid=418303)[0m                          'tool': None,
[36m(TaskRunner pid=418303)[0m                          'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=418303)[0m                                                  'analysis': True,
[36m(TaskRunner pid=418303)[0m                                                  'contents': [],
[36m(TaskRunner pid=418303)[0m                                                  'discrete': False,
[36m(TaskRunner pid=418303)[0m                                                  'level': 'level0'},
[36m(TaskRunner pid=418303)[0m                                          'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=418303)[0m                                                   'discrete': False},
[36m(TaskRunner pid=418303)[0m                                          'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=418303)[0m                                                    'step_end': None,
[36m(TaskRunner pid=418303)[0m                                                    'step_start': 0},
[36m(TaskRunner pid=418303)[0m                                          'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=418303)[0m                                                           'stack_depth': 32,
[36m(TaskRunner pid=418303)[0m                                                           'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=418303)[0m             'rollout_n': 16,
[36m(TaskRunner pid=418303)[0m             'shuffle': False,
[36m(TaskRunner pid=418303)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=418303)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=418303)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=418303)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=418303)[0m  'data': {'apply_chat_template_kwargs': {},
[36m(TaskRunner pid=418303)[0m           'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=418303)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=418303)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=418303)[0m           'filter_overlong_prompts': False,
[36m(TaskRunner pid=418303)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=418303)[0m           'image_key': 'images',
[36m(TaskRunner pid=418303)[0m           'image_patch_size': 14,
[36m(TaskRunner pid=418303)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=418303)[0m           'max_response_length': 2048,
[36m(TaskRunner pid=418303)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=418303)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=418303)[0m           'return_multi_modal_inputs': False,
[36m(TaskRunner pid=418303)[0m           'return_raw_chat': True,
[36m(TaskRunner pid=418303)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=418303)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=418303)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=418303)[0m           'seed': None,
[36m(TaskRunner pid=418303)[0m           'shuffle': True,
[36m(TaskRunner pid=418303)[0m           'tokenizer': None,
[36m(TaskRunner pid=418303)[0m           'tool_config_path': '/project/peilab/qjl/CODE/verl/examples/Answer-Ask_VL/a2agent_tool_config.yaml',
[36m(TaskRunner pid=418303)[0m           'train_batch_size': 32,
[36m(TaskRunner pid=418303)[0m           'train_files': '/project/peilab/qjl/CODE/DATA/train.parquet',
[36m(TaskRunner pid=418303)[0m           'train_max_samples': -1,
[36m(TaskRunner pid=418303)[0m           'truncation': 'error',
[36m(TaskRunner pid=418303)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=418303)[0m           'use_shm': False,
[36m(TaskRunner pid=418303)[0m           'val_batch_size': None,
[36m(TaskRunner pid=418303)[0m           'val_files': '/project/peilab/qjl/CODE/DATA/test.parquet',
[36m(TaskRunner pid=418303)[0m           'val_max_samples': -1,
[36m(TaskRunner pid=418303)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=418303)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=418303)[0m  'global_profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=418303)[0m                      'global_tool_config': {'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=418303)[0m                                                      'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=418303)[0m                                                                                    'cuda-memory-usage': 'true',
[36m(TaskRunner pid=418303)[0m                                                                                    'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=418303)[0m                                                      'discrete': False,
[36m(TaskRunner pid=418303)[0m                                                      'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=418303)[0m                                                                                'capture-range-end': None,
[36m(TaskRunner pid=418303)[0m                                                                                'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=418303)[0m                                                                                'cuda-memory-usage': 'true',
[36m(TaskRunner pid=418303)[0m                                                                                'kill': 'none',
[36m(TaskRunner pid=418303)[0m                                                                                'trace': 'cuda,nvtx,cublas,ucx'}},
[36m(TaskRunner pid=418303)[0m                                             'torch_memory': {'context': 'all',
[36m(TaskRunner pid=418303)[0m                                                              'kw_args': {},
[36m(TaskRunner pid=418303)[0m                                                              'stack_depth': 32,
[36m(TaskRunner pid=418303)[0m                                                              'stacks': 'all',
[36m(TaskRunner pid=418303)[0m                                                              'trace_alloc_max_entries': 100000}},
[36m(TaskRunner pid=418303)[0m                      'profile_continuous_steps': False,
[36m(TaskRunner pid=418303)[0m                      'save_path': 'outputs/profile',
[36m(TaskRunner pid=418303)[0m                      'steps': None,
[36m(TaskRunner pid=418303)[0m                      'tool': None},
[36m(TaskRunner pid=418303)[0m  'ray_kwargs': {'ray_init': {'num_cpus': None}, 'timeline_json_file': None},
[36m(TaskRunner pid=418303)[0m  'reward_manager': {'_target_': 'verl.trainer.config.config.RewardManagerConfig',
[36m(TaskRunner pid=418303)[0m                     'module': {'_target_': 'verl.trainer.config.config.ModuleConfig',
[36m(TaskRunner pid=418303)[0m                                'name': 'custom_reward_manager',
[36m(TaskRunner pid=418303)[0m                                'path': None},
[36m(TaskRunner pid=418303)[0m                     'name': 'naive',
[36m(TaskRunner pid=418303)[0m                     'source': 'register'},
[36m(TaskRunner pid=418303)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=418303)[0m                   'enable_resource_pool': False,
[36m(TaskRunner pid=418303)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=418303)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=418303)[0m                   'max_length': None,
[36m(TaskRunner pid=418303)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=418303)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=418303)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=418303)[0m                             'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=418303)[0m                                             'forward_prefetch': False,
[36m(TaskRunner pid=418303)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=418303)[0m                                             'param_offload': False,
[36m(TaskRunner pid=418303)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=418303)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=418303)[0m                             'input_tokenizer': '/project/peilab/qjl/MODEL/Qwen3-VL-4B-Instruct',
[36m(TaskRunner pid=418303)[0m                             'override_config': {},
[36m(TaskRunner pid=418303)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=418303)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=418303)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=418303)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=418303)[0m                             'use_shm': False},
[36m(TaskRunner pid=418303)[0m                   'n_gpus_per_node': 8,
[36m(TaskRunner pid=418303)[0m                   'nnodes': 0,
[36m(TaskRunner pid=418303)[0m                   'num_workers': 1,
[36m(TaskRunner pid=418303)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=418303)[0m                                'all_ranks': False,
[36m(TaskRunner pid=418303)[0m                                'enable': False,
[36m(TaskRunner pid=418303)[0m                                'ranks': [],
[36m(TaskRunner pid=418303)[0m                                'save_path': 'outputs/profile',
[36m(TaskRunner pid=418303)[0m                                'tool': None,
[36m(TaskRunner pid=418303)[0m                                'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=418303)[0m                                                        'analysis': True,
[36m(TaskRunner pid=418303)[0m                                                        'contents': [],
[36m(TaskRunner pid=418303)[0m                                                        'discrete': False,
[36m(TaskRunner pid=418303)[0m                                                        'level': 'level0'},
[36m(TaskRunner pid=418303)[0m                                                'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=418303)[0m                                                         'discrete': False},
[36m(TaskRunner pid=418303)[0m                                                'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=418303)[0m                                                          'step_end': None,
[36m(TaskRunner pid=418303)[0m                                                          'step_start': 0},
[36m(TaskRunner pid=418303)[0m                                                'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=418303)[0m                                                                 'stack_depth': 32,
[36m(TaskRunner pid=418303)[0m                                                                 'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=418303)[0m                   'reward_loop_class_name': None,
[36m(TaskRunner pid=418303)[0m                   'reward_loop_module_path': None,
[36m(TaskRunner pid=418303)[0m                   'reward_loop_source': 'register',
[36m(TaskRunner pid=418303)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=418303)[0m                   'rollout': {'_target_': 'verl.workers.config.RolloutConfig',
[36m(TaskRunner pid=418303)[0m                               'cudagraph_capture_sizes': None,
[36m(TaskRunner pid=418303)[0m                               'data_parallel_size': 1,
[36m(TaskRunner pid=418303)[0m                               'disable_log_stats': True,
[36m(TaskRunner pid=418303)[0m                               'dtype': 'bfloat16',
[36m(TaskRunner pid=418303)[0m                               'enable_chunked_prefill': True,
[36m(TaskRunner pid=418303)[0m                               'enable_prefix_caching': True,
[36m(TaskRunner pid=418303)[0m                               'enforce_eager': True,
[36m(TaskRunner pid=418303)[0m                               'engine_kwargs': {},
[36m(TaskRunner pid=418303)[0m                               'expert_parallel_size': 1,
[36m(TaskRunner pid=418303)[0m                               'free_cache_engine': True,
[36m(TaskRunner pid=418303)[0m                               'gpu_memory_utilization': 0.5,
[36m(TaskRunner pid=418303)[0m                               'limit_images': None,
[36m(TaskRunner pid=418303)[0m                               'load_format': 'auto',
[36m(TaskRunner pid=418303)[0m                               'max_model_len': None,
[36m(TaskRunner pid=418303)[0m                               'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=418303)[0m                               'max_num_seqs': 1024,
[36m(TaskRunner pid=418303)[0m                               'name': '???',
[36m(TaskRunner pid=418303)[0m                               'prompt_length': 2048,
[36m(TaskRunner pid=418303)[0m                               'response_length': 2048,
[36m(TaskRunner pid=418303)[0m                               'skip_tokenizer_init': False,
[36m(TaskRunner pid=418303)[0m                               'tensor_model_parallel_size': 2},
[36m(TaskRunner pid=418303)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=418303)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=418303)[0m                                      'url': None},
[36m(TaskRunner pid=418303)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=418303)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=418303)[0m                   'use_dynamic_bsz': False,
[36m(TaskRunner pid=418303)[0m                   'use_reward_loop': True},
[36m(TaskRunner pid=418303)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=418303)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=418303)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=418303)[0m /project/peilab/qjl/CODE/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(TaskRunner pid=418303)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(TaskRunner pid=418303)[0m /project/peilab/qjl/CODE/verl/verl/trainer/ppo/ray_trainer.py:335: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=418303)[0m   self.use_critic = need_critic(self.config)
[36m(pid=431388)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=431388)[0m   import pynvml  # type: ignore[import]
[33m(raylet)[0m [2025-12-31 22:09:36,334 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.015 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(WorkerDict pid=431390)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(WorkerDict pid=431390)[0m Flash Attention 2 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen3VLForConditionalGeneration is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", dtype=torch.float16)`
[36m(WorkerDict pid=431390)[0m Flash Attention 2 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen3VLModel is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", dtype=torch.float16)`
[36m(WorkerDict pid=431390)[0m Flash Attention 2 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen3VLVisionModel is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", dtype=torch.float16)`
[36m(pid=431389)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(pid=431389)[0m   import pynvml  # type: ignore[import][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431390)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(TaskRunner pid=418303)[0m              'default_local_dir': 'checkpoints/answer-ask_async_rl/qwen3-4b-a2po-sgl-multi-w-tool',
[36m(TaskRunner pid=418303)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=418303)[0m              'device': 'cuda',
[36m(TaskRunner pid=418303)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=418303)[0m              'experiment_name': 'qwen3-4b-a2po-sgl-multi-w-tool',
[36m(TaskRunner pid=418303)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=418303)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=418303)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=418303)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=418303)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=418303)[0m              'nnodes': 1,
[36m(TaskRunner pid=418303)[0m              'project_name': 'answer-ask_async_rl',
[36m(TaskRunner pid=418303)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=418303)[0m              'resume_from_path': None,
[36m(TaskRunner pid=418303)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=418303)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=418303)[0m              'save_freq': 20,
[36m(TaskRunner pid=418303)[0m              'test_freq': 20,
[36m(TaskRunner pid=418303)[0m              'total_epochs': 15,
[36m(TaskRunner pid=418303)[0m              'total_training_steps': None,
[36m(TaskRunner pid=418303)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=418303)[0m              'val_before_train': True,
[36m(TaskRunner pid=418303)[0m              'val_only': False,
[36m(TaskRunner pid=418303)[0m              'validation_data_dir': None},
[36m(TaskRunner pid=418303)[0m  'transfer_queue': {'enable': False}}
[36m(TaskRunner pid=418303)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=418303)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=418303)[0m {
[36m(TaskRunner pid=418303)[0m   "type": "function",
[36m(TaskRunner pid=418303)[0m   "function": {
[36m(TaskRunner pid=418303)[0m     "name": "calc_geo3k_reward",
[36m(TaskRunner pid=418303)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",
[36m(TaskRunner pid=418303)[0m     "parameters": {
[36m(TaskRunner pid=418303)[0m       "type": "object",
[36m(TaskRunner pid=418303)[0m       "properties": {
[36m(TaskRunner pid=418303)[0m         "answer": {
[36m(TaskRunner pid=418303)[0m           "type": "string",
[36m(TaskRunner pid=418303)[0m           "description": "The model's answer to the geo3k problem, must be a digits"
[36m(TaskRunner pid=418303)[0m         }
[36m(TaskRunner pid=418303)[0m       },
[36m(TaskRunner pid=418303)[0m       "required": [
[36m(TaskRunner pid=418303)[0m         "answer"
[36m(TaskRunner pid=418303)[0m       ]
[36m(TaskRunner pid=418303)[0m     }
[36m(TaskRunner pid=418303)[0m   }
[36m(TaskRunner pid=418303)[0m }
[36m(TaskRunner pid=418303)[0m dataset len: 7473
[36m(TaskRunner pid=418303)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=418303)[0m {
[36m(TaskRunner pid=418303)[0m   "type": "function",
[36m(TaskRunner pid=418303)[0m   "function": {
[36m(TaskRunner pid=418303)[0m     "name": "calc_geo3k_reward",
[36m(TaskRunner pid=418303)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",
[36m(TaskRunner pid=418303)[0m     "parameters": {
[36m(TaskRunner pid=418303)[0m       "type": "object",
[36m(TaskRunner pid=418303)[0m       "properties": {
[36m(TaskRunner pid=418303)[0m         "answer": {
[36m(TaskRunner pid=418303)[0m           "type": "string",
[36m(TaskRunner pid=418303)[0m           "description": "The model's answer to the geo3k problem, must be a digits"
[36m(TaskRunner pid=418303)[0m         }
[36m(TaskRunner pid=418303)[0m       },
[36m(TaskRunner pid=418303)[0m       "required": [
[36m(TaskRunner pid=418303)[0m         "answer"
[36m(TaskRunner pid=418303)[0m       ]
[36m(TaskRunner pid=418303)[0m     }
[36m(TaskRunner pid=418303)[0m   }
[36m(TaskRunner pid=418303)[0m }
[36m(TaskRunner pid=418303)[0m dataset len: 1319
[36m(TaskRunner pid=418303)[0m Size of train dataloader: 233, Size of val dataloader: 1
[36m(TaskRunner pid=418303)[0m Total training steps: 3495
[36m(TaskRunner pid=418303)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(TaskRunner pid=418303)[0m bind role actor_rollout method chat_completion to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=418303)[0m bind role actor_rollout method generate to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=418303)[0m bind role actor_rollout method get_zeromq_address to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=418303)[0m bind role actor_rollout method sleep to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=418303)[0m bind role actor_rollout method wake_up to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(WorkerDict pid=431387)[0m [Gloo] Rank 4 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[36m(WorkerDict pid=431383)[0m Model config after override: Qwen3VLConfig {
[36m(WorkerDict pid=431383)[0m   "architectures": [
[36m(WorkerDict pid=431383)[0m     "Qwen3VLForConditionalGeneration"
[36m(WorkerDict pid=431383)[0m   ],
[36m(WorkerDict pid=431383)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=431383)[0m   "image_token_id": 151655,
[36m(WorkerDict pid=431383)[0m   "model_type": "qwen3_vl",
[36m(WorkerDict pid=431383)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=431383)[0m   "text_config": {
[36m(WorkerDict pid=431383)[0m     "attention_bias": false,
[36m(WorkerDict pid=431383)[0m     "attention_dropout": 0.0,
[36m(WorkerDict pid=431383)[0m     "bos_token_id": 151643,
[36m(WorkerDict pid=431383)[0m     "dtype": "bfloat16",
[36m(WorkerDict pid=431383)[0m     "eos_token_id": 151645,
[36m(WorkerDict pid=431383)[0m     "head_dim": 128,
[36m(WorkerDict pid=431383)[0m     "hidden_act": "silu",
[36m(WorkerDict pid=431383)[0m     "hidden_size": 2560,
[36m(WorkerDict pid=431383)[0m     "initializer_range": 0.02,
[36m(WorkerDict pid=431383)[0m     "intermediate_size": 9728,
[36m(WorkerDict pid=431383)[0m     "max_position_embeddings": 262144,
[36m(WorkerDict pid=431383)[0m     "model_type": "qwen3_vl_text",
[36m(WorkerDict pid=431383)[0m     "num_attention_heads": 32,
[36m(WorkerDict pid=431383)[0m     "num_hidden_layers": 36,
[36m(WorkerDict pid=431383)[0m     "num_key_value_heads": 8,
[36m(WorkerDict pid=431383)[0m     "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=431383)[0m     "rope_scaling": {
[36m(WorkerDict pid=431383)[0m       "mrope_interleaved": true,
[36m(WorkerDict pid=431383)[0m       "mrope_section": [
[36m(WorkerDict pid=431383)[0m         24,
[36m(WorkerDict pid=431383)[0m         20,
[36m(WorkerDict pid=431383)[0m         20
[36m(WorkerDict pid=431383)[0m       ],
[36m(WorkerDict pid=431383)[0m       "rope_type": "default"
[36m(WorkerDict pid=431383)[0m     },
[36m(WorkerDict pid=431383)[0m     "rope_theta": 5000000,
[36m(WorkerDict pid=431383)[0m     "tie_word_embeddings": true,
[36m(WorkerDict pid=431383)[0m     "use_cache": true,
[36m(WorkerDict pid=431383)[0m     "vocab_size": 151936
[36m(WorkerDict pid=431383)[0m   },
[36m(WorkerDict pid=431383)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=431383)[0m   "transformers_version": "4.57.3",
[33m(raylet)[0m [2025-12-31 22:09:46,415 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.015 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(WorkerDict pid=431385)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:04<00:04,  4.29s/it]
[36m(WorkerDict pid=431383)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431383)[0m Flash Attention 2 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen3VLTextModel is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", dtype=torch.float16)`[32m [repeated 29x across cluster][0m
[36m(WorkerDict pid=431383)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431385)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.08s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.11s/it]
[36m(WorkerDict pid=431387)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:05<00:05,  5.61s/it][32m [repeated 7x across cluster][0m
[33m(raylet)[0m [2025-12-31 22:09:56,465 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.015 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(WorkerDict pid=431386)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.81s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.82s/it][32m [repeated 7x across cluster][0m
[33m(raylet)[0m [2025-12-31 22:10:06,540 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.015 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(WorkerDict pid=431388)[0m /project/peilab/qjl/CODE/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(WorkerDict pid=431388)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(WorkerDict pid=431388)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:678: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=431388)[0m   warnings.warn(
[36m(TaskRunner pid=418303)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/sglang/srt/layers/quantization/awq.py:62: UserWarning: Only CUDA and HIP support AWQ currently.
[36m(TaskRunner pid=418303)[0m   warnings.warn(f"Only CUDA and HIP support AWQ currently.")
[36m(WorkerDict pid=431389)[0m /project/peilab/qjl/CODE/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431389)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=418303)[0m W1231 22:10:14.170000 418303 site-packages/torch/utils/cpp_extension.py:118] No CUDA runtime is found, using CUDA_HOME='/home/hzhangex/anaconda3/envs/a2po'
[33m(raylet)[0m [2025-12-31 22:10:16,573 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.014 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(WorkerDict pid=431389)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:678: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431389)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(pid=433795)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=433795)[0m   import pynvml  # type: ignore[import]
[36m(TaskRunner pid=418303)[0m /project/peilab/qjl/CODE/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(TaskRunner pid=418303)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[33m(raylet)[0m [2025-12-31 22:10:26,607 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.013 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(pid=433797)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 7x across cluster][0m
[36m(pid=433797)[0m   import pynvml  # type: ignore[import][32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=433794)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[33m(raylet)[0m [2025-12-31 22:10:36,647 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.013 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(SGLangHttpServer pid=433800)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(SGLangHttpServer pid=433800)[0m   import pynvml  # type: ignore[import]
[36m(SGLangHttpServer pid=433799)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 7x across cluster][0m
[33m(raylet)[0m [2025-12-31 22:10:46,700 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.013 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(SGLangHttpServer pid=433799)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 15x across cluster][0m
[36m(SGLangHttpServer pid=433799)[0m   import pynvml  # type: ignore[import][32m [repeated 15x across cluster][0m
[36m(SGLangHttpServer pid=433794)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(SGLangHttpServer pid=433794)[0m [W1231 22:10:53.972779769 ProcessGroupNCCL.cpp:981] Warning: TORCH_NCCL_AVOID_RECORD_STREAMS is the default now, this environment variable is thus deprecated. (function operator())
[33m(raylet)[0m [2025-12-31 22:10:56,786 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.013 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(SGLangHttpServer pid=433799)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=433799)[0m [W1231 22:10:55.026503469 ProcessGroupNCCL.cpp:981] Warning: TORCH_NCCL_AVOID_RECORD_STREAMS is the default now, this environment variable is thus deprecated. (function operator())[32m [repeated 7x across cluster][0m
[33m(raylet)[0m [2025-12-31 22:11:06,823 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.013 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[33m(raylet)[0m [2025-12-31 22:11:16,879 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.012 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(SGLangHttpServer pid=433795)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(SGLangHttpServer pid=433795)[0m   0%|          | 0/23 [00:00<?, ?it/s]Capturing batches (bs=160 avail_mem=33.55 GB):   0%|          | 0/23 [00:00<?, ?it/s]
[36m(SGLangHttpServer pid=433795)[0m Capturing batches (bs=160 avail_mem=33.55 GB):   4%|▍         | 1/23 [00:00<00:09,  2.36it/s]Capturing batches (bs=152 avail_mem=33.39 GB):   4%|▍         | 1/23 [00:00<00:09,  2.36it/s]
[36m(SGLangHttpServer pid=433796)[0m Capturing batches (bs=32 avail_mem=33.21 GB):  74%|███████▍  | 17/23 [00:02<00:00,  7.04it/s]Capturing batches (bs=24 avail_mem=33.19 GB):  74%|███████▍  | 17/23 [00:02<00:00,  7.04it/s]Capturing batches (bs=24 avail_mem=33.19 GB):  78%|███████▊  | 18/23 [00:02<00:00,  7.57it/s]Capturing batches (bs=16 avail_mem=33.17 GB):  78%|███████▊  | 18/23 [00:02<00:00,  7.57it/s]
[36m(SGLangHttpServer pid=433800)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=433796)[0m Capturing batches (bs=4 avail_mem=33.12 GB):  91%|█████████▏| 21/23 [00:03<00:00,  7.97it/s]Capturing batches (bs=2 avail_mem=33.10 GB):  91%|█████████▏| 21/23 [00:03<00:00,  7.97it/s]
[36m(SGLangHttpServer pid=433796)[0m Capturing batches (bs=2 avail_mem=33.10 GB):  96%|█████████▌| 22/23 [00:03<00:00,  7.84it/s]Capturing batches (bs=1 avail_mem=33.08 GB):  96%|█████████▌| 22/23 [00:03<00:00,  7.84it/s]
[33m(raylet)[0m [2025-12-31 22:11:26,925 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.012 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(SGLangHttpServer pid=433800)[0m   0%|          | 0/23 [00:00<?, ?it/s]Capturing batches (bs=160 avail_mem=33.55 GB):   0%|          | 0/23 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=433801)[0m Capturing batches (bs=8 avail_mem=32.99 GB):  87%|████████▋ | 20/23 [00:03<00:00,  6.26it/s]Capturing batches (bs=4 avail_mem=32.97 GB):  87%|████████▋ | 20/23 [00:03<00:00,  6.26it/s][32m [repeated 157x across cluster][0m
[36m(pid=436892)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=436892)[0m   import pynvml  # type: ignore[import]
[36m(WorkerDict pid=431389)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 8x across cluster][0m
[36m(SGLangHttpServer pid=433801)[0m Capturing batches (bs=1 avail_mem=32.92 GB): 100%|██████████| 23/23 [00:03<00:00,  7.06it/s]Capturing batches (bs=1 avail_mem=32.92 GB): 100%|██████████| 23/23 [00:03<00:00,  6.17it/s][32m [repeated 22x across cluster][0m
[33m(raylet)[0m [2025-12-31 22:11:36,948 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.011 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(pid=436895)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 7x across cluster][0m
[36m(pid=436895)[0m   import pynvml  # type: ignore[import][32m [repeated 7x across cluster][0m
[33m(raylet)[0m [2025-12-31 22:11:46,979 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.011 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(AgentLoopWorker pid=436895)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/sglang/srt/layers/quantization/awq.py:62: UserWarning: Only CUDA and HIP support AWQ currently.
[36m(AgentLoopWorker pid=436895)[0m   warnings.warn(f"Only CUDA and HIP support AWQ currently.")
[36m(AgentLoopWorker pid=436895)[0m W1231 22:11:53.556000 436895 site-packages/torch/utils/cpp_extension.py:118] No CUDA runtime is found, using CUDA_HOME='/home/hzhangex/anaconda3/envs/a2po'
[36m(TaskRunner pid=418303)[0m wandb: Currently logged in as: royaltobe (royaltobe-beijing-institute-of-technology) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[36m(TaskRunner pid=418303)[0m wandb: Tracking run with wandb version 0.22.3
[36m(TaskRunner pid=418303)[0m wandb: Run data is saved locally in /project/peilab/qjl/CODE/verl/wandb/run-20251231_221154-flwrfepu
[36m(TaskRunner pid=418303)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(TaskRunner pid=418303)[0m wandb: Syncing run qwen3-4b-a2po-sgl-multi-w-tool
[36m(TaskRunner pid=418303)[0m wandb: ⭐️ View project at https://wandb.ai/royaltobe-beijing-institute-of-technology/answer-ask_async_rl
[36m(TaskRunner pid=418303)[0m wandb: 🚀 View run at https://wandb.ai/royaltobe-beijing-institute-of-technology/answer-ask_async_rl/runs/flwrfepu
[36m(TaskRunner pid=418303)[0m wandb: Detected [openai] in use.
[36m(TaskRunner pid=418303)[0m wandb: Use W&B Weave for improved LLM call tracing. Install Weave with `pip install weave` then add `import weave` to the top of your script.
[36m(TaskRunner pid=418303)[0m wandb: For more information, check out the docs at: https://weave-docs.wandb.ai/
[36m(WorkerDict pid=431388)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:678: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=431388)[0m   warnings.warn(
[33m(raylet)[0m [2025-12-31 22:11:57,030 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.011 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(pid=438756)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=438756)[0m   import pynvml  # type: ignore[import]
[36m(AgentLoopWorker pid=436891)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/sglang/srt/layers/quantization/awq.py:62: UserWarning: Only CUDA and HIP support AWQ currently.[32m [repeated 7x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m   warnings.warn(f"Only CUDA and HIP support AWQ currently.")[32m [repeated 7x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m W1231 22:11:56.478000 436891 site-packages/torch/utils/cpp_extension.py:118] No CUDA runtime is found, using CUDA_HOME='/home/hzhangex/anaconda3/envs/a2po'[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431389)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:678: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431389)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[33m(raylet)[0m [2025-12-31 22:12:07,068 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.011 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(pid=439567)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 7x across cluster][0m
[36m(pid=439567)[0m   import pynvml  # type: ignore[import][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431388)[0m INFO:2025-12-31 22:12:09,524:[Rank 5] Loaded model from /project/peilab/qjl/CODE/verl/checkpoints/answer-ask_async_rl/qwen3-4b-a2po-sgl-multi-w-tool/global_step_20/actor/model_world_size_8_rank_5.pt
[36m(WorkerDict pid=431384)[0m INFO:2025-12-31 22:12:14,906:[Rank 1] Loaded optimizer from /project/peilab/qjl/CODE/verl/checkpoints/answer-ask_async_rl/qwen3-4b-a2po-sgl-multi-w-tool/global_step_20/actor/optim_world_size_8_rank_1.pt
[36m(WorkerDict pid=431384)[0m INFO:2025-12-31 22:12:14,916:[Rank 1] Loaded rng from /project/peilab/qjl/CODE/verl/checkpoints/answer-ask_async_rl/qwen3-4b-a2po-sgl-multi-w-tool/global_step_20/actor/extra_state_world_size_8_rank_1.pt
[36m(WorkerDict pid=431384)[0m INFO:2025-12-31 22:12:14,916:[Rank 1] Loaded lr_scheduler from /project/peilab/qjl/CODE/verl/checkpoints/answer-ask_async_rl/qwen3-4b-a2po-sgl-multi-w-tool/global_step_20/actor/extra_state_world_size_8_rank_1.pt
[36m(WorkerDict pid=431389)[0m INFO:2025-12-31 22:12:09,526:[Rank 6] Loaded model from /project/peilab/qjl/CODE/verl/checkpoints/answer-ask_async_rl/qwen3-4b-a2po-sgl-multi-w-tool/global_step_20/actor/model_world_size_8_rank_6.pt[32m [repeated 7x across cluster][0m
[33m(raylet)[0m [2025-12-31 22:12:17,141 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.01 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(WorkerDict pid=431388)[0m INFO:2025-12-31 22:12:17,907:[Rank 5] Loaded optimizer from /project/peilab/qjl/CODE/verl/checkpoints/answer-ask_async_rl/qwen3-4b-a2po-sgl-multi-w-tool/global_step_20/actor/optim_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431388)[0m INFO:2025-12-31 22:12:17,916:[Rank 5] Loaded rng from /project/peilab/qjl/CODE/verl/checkpoints/answer-ask_async_rl/qwen3-4b-a2po-sgl-multi-w-tool/global_step_20/actor/extra_state_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431388)[0m INFO:2025-12-31 22:12:17,916:[Rank 5] Loaded lr_scheduler from /project/peilab/qjl/CODE/verl/checkpoints/answer-ask_async_rl/qwen3-4b-a2po-sgl-multi-w-tool/global_step_20/actor/extra_state_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[33m(raylet)[0m [2025-12-31 22:12:27,213 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.01 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(WorkerDict pid=431383)[0m   "video_token_id": 151656,
[36m(WorkerDict pid=431383)[0m   "vision_config": {
[36m(WorkerDict pid=431383)[0m     "deepstack_visual_indexes": [
[36m(WorkerDict pid=431383)[0m       5,
[36m(WorkerDict pid=431383)[0m       11,
[36m(WorkerDict pid=431383)[0m       17
[36m(WorkerDict pid=431383)[0m     ],
[36m(WorkerDict pid=431383)[0m     "depth": 24,
[36m(WorkerDict pid=431383)[0m     "hidden_act": "gelu_pytorch_tanh",
[36m(WorkerDict pid=431383)[0m     "hidden_size": 1024,
[36m(WorkerDict pid=431383)[0m     "in_channels": 3,
[36m(WorkerDict pid=431383)[0m     "initializer_range": 0.02,
[36m(WorkerDict pid=431383)[0m     "intermediate_size": 4096,
[36m(WorkerDict pid=431383)[0m     "model_type": "qwen3_vl",
[36m(WorkerDict pid=431383)[0m     "num_heads": 16,
[36m(WorkerDict pid=431383)[0m     "num_position_embeddings": 2304,
[36m(WorkerDict pid=431383)[0m     "out_hidden_size": 2560,
[36m(WorkerDict pid=431383)[0m     "patch_size": 16,
[36m(WorkerDict pid=431383)[0m     "spatial_merge_size": 2,
[36m(WorkerDict pid=431383)[0m     "temporal_patch_size": 2
[36m(WorkerDict pid=431383)[0m   },
[36m(WorkerDict pid=431383)[0m   "vision_end_token_id": 151653,
[36m(WorkerDict pid=431383)[0m   "vision_start_token_id": 151652
[36m(WorkerDict pid=431383)[0m }
[36m(WorkerDict pid=431383)[0m 
[36m(WorkerDict pid=431385)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. 
[36m(WorkerDict pid=431385)[0m Monkey patch Qwen3VLForConditionalGeneration model forward
[36m(WorkerDict pid=431385)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=431385)[0m Skipping monkey patch for Qwen3VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=431386)[0m [Gloo] Rank 3 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431383)[0m Qwen3VLForConditionalGeneration contains 4.44B parameters
[36m(WorkerDict pid=431383)[0m wrap_policy: functools.partial(<function _or_policy at 0x1524e64fb490>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x1524e64fb370>, transformer_layer_cls={<class 'transformers.models.qwen3_vl.modeling_qwen3_vl.Qwen3VLVisionBlock'>, <class 'transformers.models.qwen3_vl.modeling_qwen3_vl.Qwen3VLTextDecoderLayer'>})])
[36m(WorkerDict pid=431383)[0m Total steps: 3495, num_warmup_steps: 0
[36m(WorkerDict pid=431383)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=431383)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=431386)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. [32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431386)[0m Monkey patch Qwen3VLForConditionalGeneration model forward[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431386)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431386)[0m Skipping monkey patch for Qwen3VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=431387)[0m 
[36m(WorkerDict pid=431387)[0m [2025-12-31 22:10:00] dgx-12:431387:433077 [0] transport/net_ib.cc:587 NCCL WARN NET/IB : Attempted to merge incompatible devices: [1]mlx5_1:1/IB and [2]mlx5_2:1/RoCE. Try selecting NICs of only one link type using NCCL_IB_HCA
[36m(WorkerDict pid=431387)[0m 
[36m(WorkerDict pid=431387)[0m [2025-12-31 22:10:00] dgx-12:431387:433077 [0] transport/net_ib.cc:587 NCCL WARN NET/IB : Attempted to merge incompatible devices: [7]mlx5_7:1/IB and [8]mlx5_8:1/RoCE. Try selecting NICs of only one link type using NCCL_IB_HCA
[36m(WorkerDict pid=431387)[0m [Gloo] Rank 4 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[36m(WorkerDict pid=431387)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=431387)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=431384)[0m 
[36m(WorkerDict pid=431384)[0m 
[36m(WorkerDict pid=431390)[0m 
[36m(WorkerDict pid=431390)[0m 
[36m(WorkerDict pid=431385)[0m 
[36m(WorkerDict pid=431385)[0m 
[36m(WorkerDict pid=431389)[0m 
[36m(WorkerDict pid=431389)[0m 
[36m(WorkerDict pid=431383)[0m NCCL version 2.27.3+cuda12.9
[36m(WorkerDict pid=431383)[0m 
[36m(WorkerDict pid=431383)[0m 
[36m(WorkerDict pid=431388)[0m 
[36m(WorkerDict pid=431388)[0m 
[36m(WorkerDict pid=431386)[0m 
[36m(WorkerDict pid=431386)[0m 
[36m(WorkerDict pid=431387)[0m All deep_gemm operations loaded successfully!
[36m(WorkerDict pid=431386)[0m [2025-12-31 22:10:00] dgx-12:431386:433075 [0] transport/net_ib.cc:587 NCCL WARN NET/IB : Attempted to merge incompatible devices: [7]mlx5_7:1/IB and [8]mlx5_8:1/RoCE. Try selecting NICs of only one link type using NCCL_IB_HCA[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=431386)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 21x across cluster][0m
[36m(pid=433793)[0m All deep_gemm operations loaded successfully![32m [repeated 8x across cluster][0m
[36m(SGLangHttpServer pid=433793)[0m SGLang http server: rollout_mode=<RolloutMode.HYBRID: 'hybrid'>, replica_rank=3, node_rank=0, nnodes=1, cuda_visible_devices='3'
[36m(SGLangHttpServer pid=433794)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 4x across cluster][0m
[36m(pid=433796)[0m All deep_gemm operations loaded successfully![32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=433799)[0m SGLang http server: rollout_mode=<RolloutMode.HYBRID: 'hybrid'>, replica_rank=2, node_rank=0, nnodes=1, cuda_visible_devices='2'[32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=433799)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 28x across cluster][0m
[36m(SGLangHttpServer pid=433795)[0m All deep_gemm operations loaded successfully!
[36m(SGLangHttpServer pid=433799)[0m All deep_gemm operations loaded successfully!
[36m(TaskRunner pid=418303)[0m AgentLoopManager: ['10.22.4.86:35911', '10.22.4.86:33677', '10.22.4.86:34671', '10.22.4.86:38501', '10.22.4.86:46261', '10.22.4.86:34049', '10.22.4.86:45327', '10.22.4.86:38411']
[36m(TaskRunner pid=418303)[0m Found checkpoint: %s /project/peilab/qjl/CODE/verl/checkpoints/answer-ask_async_rl/qwen3-4b-a2po-sgl-multi-w-tool/global_step_20
[36m(TaskRunner pid=418303)[0m Load from checkpoint folder: /project/peilab/qjl/CODE/verl/checkpoints/answer-ask_async_rl/qwen3-4b-a2po-sgl-multi-w-tool/global_step_20
[36m(TaskRunner pid=418303)[0m Setting global step to 20
[36m(TaskRunner pid=418303)[0m Resuming from /project/peilab/qjl/CODE/verl/checkpoints/answer-ask_async_rl/qwen3-4b-a2po-sgl-multi-w-tool/global_step_20
[36m(SGLangHttpServer pid=433800)[0m All deep_gemm operations loaded successfully![32m [repeated 6x across cluster][0m
[36m(TaskRunner pid=418303)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 20}
[36m(AgentLoopWorker pid=436898)[0m {
[36m(AgentLoopWorker pid=436898)[0m   "type": "function",
[36m(AgentLoopWorker pid=436898)[0m   "function": {
[36m(AgentLoopWorker pid=436898)[0m     "name": "calc_geo3k_reward",
[36m(AgentLoopWorker pid=436898)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",
[36m(AgentLoopWorker pid=436898)[0m     "parameters": {
[36m(AgentLoopWorker pid=436898)[0m       "type": "object",
[36m(AgentLoopWorker pid=436898)[0m       "properties": {
[36m(AgentLoopWorker pid=436898)[0m         "answer": {
[33m(raylet)[0m [2025-12-31 22:12:37,291 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.009 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[33m(raylet)[0m [2025-12-31 22:12:47,353 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.008 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[33m(raylet)[0m [2025-12-31 22:12:57,362 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.008 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(AgentLoopWorker pid=436898)[0m           "type": "string",
[36m(AgentLoopWorker pid=436898)[0m           "description": "The model's answer to the geo3k problem, must be a digits"
[36m(AgentLoopWorker pid=436898)[0m         }
[36m(AgentLoopWorker pid=436898)[0m       },
[36m(AgentLoopWorker pid=436898)[0m       "required": [
[36m(AgentLoopWorker pid=436898)[0m         "answer"
[36m(AgentLoopWorker pid=436898)[0m       ]
[36m(AgentLoopWorker pid=436898)[0m     }
[36m(AgentLoopWorker pid=436898)[0m   }
[36m(AgentLoopWorker pid=436898)[0m }
[36m(AgentLoopWorker pid=436898)[0m {[32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "type": "function",[32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "function": {[32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "name": "calc_geo3k_reward",[32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "parameters": {[32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "type": "object",[32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "properties": {[32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer": {[32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "type": "string",[32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m }[32m [repeated 304x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       },[32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "required": [[32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer"[32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       ][32m [repeated 76x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m {[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "type": "function",[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "function": {[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "name": "calc_geo3k_reward",[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "parameters": {[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "type": "object",[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "properties": {[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer": {[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "type": "string",[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m }[32m [repeated 216x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       },[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "required": [[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer"[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       ][32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m {[32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m   "type": "function",[32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m   "function": {[32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m     "name": "calc_geo3k_reward",[32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m     "parameters": {[32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m       "type": "object",[32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m       "properties": {[32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m         "answer": {[32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m           "type": "string",[32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m }[32m [repeated 276x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m       },[32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m       "required": [[32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m         "answer"[32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436894)[0m       ][32m [repeated 69x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m {[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m   "type": "function",[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m   "function": {[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m     "name": "calc_geo3k_reward",[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m     "parameters": {[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m       "type": "object",[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m       "properties": {[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m         "answer": {[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m           "type": "string",[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m }[32m [repeated 216x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m       },[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m       "required": [[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m         "answer"[32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m       ][32m [repeated 54x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m {[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m   "type": "function",[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m   "function": {[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m     "name": "calc_geo3k_reward",[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m     "parameters": {[32m [repeated 34x across cluster][0m
[36m(pid=440621)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=440621)[0m   import pynvml  # type: ignore[import]
[33m(raylet)[0m [2025-12-31 22:13:07,444 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.007 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[33m(raylet)[0m [2025-12-31 22:13:17,541 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.005 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(AgentLoopWorker pid=436890)[0m       "type": "object",[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m       "properties": {[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m         "answer": {[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m           "type": "string",[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m }[32m [repeated 136x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m       },[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m       "required": [[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m         "answer"[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m       ][32m [repeated 34x across cluster][0m
[33m(raylet)[0m WARNING: 901 PYTHON worker processes have been started on node: c6050fea88602aeb14f30ebf6ea7f1cec4cfcc3eedcb5fe7f17579fc with address: 10.22.4.86. This could be a result of using a large number of actors, or due to tasks blocked in ray.get() calls (see https://github.com/ray-project/ray/issues/3644 for some discussion of workarounds).
[36m(AgentLoopWorker pid=436892)[0m {[32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m   "type": "function",[32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m   "function": {[32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "name": "calc_geo3k_reward",[32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "parameters": {[32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "type": "object",[32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "properties": {[32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m         "answer": {[32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m           "type": "string",[32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m }[32m [repeated 152x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       },[32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "required": [[32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m         "answer"[32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       ][32m [repeated 38x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m {[32m [repeated 55x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m   "type": "function",[32m [repeated 55x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m   "function": {[32m [repeated 55x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "name": "calc_geo3k_reward",[32m [repeated 55x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 55x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "parameters": {[32m [repeated 55x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "type": "object",[32m [repeated 55x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "properties": {[32m [repeated 55x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m         "answer": {[32m [repeated 55x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m           "type": "string",[32m [repeated 55x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 55x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m }[32m [repeated 220x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       },[32m [repeated 55x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "required": [[32m [repeated 55x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m         "answer"[32m [repeated 55x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       ][32m [repeated 55x across cluster][0m
[33m(raylet)[0m WARNING: 1120 PYTHON worker processes have been started on node: c6050fea88602aeb14f30ebf6ea7f1cec4cfcc3eedcb5fe7f17579fc with address: 10.22.4.86. This could be a result of using a large number of actors, or due to tasks blocked in ray.get() calls (see https://github.com/ray-project/ray/issues/3644 for some discussion of workarounds).
[36m(AgentLoopWorker pid=436892)[0m {[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m   "type": "function",[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m   "function": {[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "name": "calc_geo3k_reward",[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "parameters": {[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "type": "object",[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "properties": {[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m         "answer": {[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m           "type": "string",[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m }[32m [repeated 172x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       },[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "required": [[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m         "answer"[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       ][32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m {[32m [repeated 52x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m   "type": "function",[32m [repeated 52x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m   "function": {[32m [repeated 52x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m     "name": "calc_geo3k_reward",[32m [repeated 52x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 52x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m     "parameters": {[32m [repeated 52x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m       "type": "object",[32m [repeated 52x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m       "properties": {[32m [repeated 52x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m         "answer": {[32m [repeated 52x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m           "type": "string",[32m [repeated 52x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 52x across cluster][0m
[33m(raylet)[0m [2025-12-31 22:13:27,624 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.004 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[33m(raylet)[0m [2025-12-31 22:13:37,712 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.003 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[33m(raylet)[0m [2025-12-31 22:13:47,735 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.002 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(AgentLoopWorker pid=436895)[0m }[32m [repeated 208x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m       },[32m [repeated 52x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m       "required": [[32m [repeated 52x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m         "answer"[32m [repeated 52x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m       ][32m [repeated 52x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m {[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "type": "function",[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "function": {[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "name": "calc_geo3k_reward",[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "parameters": {[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "type": "object",[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "properties": {[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer": {[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "type": "string",[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m }[32m [repeated 136x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       },[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "required": [[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer"[32m [repeated 34x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       ][32m [repeated 34x across cluster][0m
[33m(raylet)[0m WARNING: 1346 PYTHON worker processes have been started on node: c6050fea88602aeb14f30ebf6ea7f1cec4cfcc3eedcb5fe7f17579fc with address: 10.22.4.86. This could be a result of using a large number of actors, or due to tasks blocked in ray.get() calls (see https://github.com/ray-project/ray/issues/3644 for some discussion of workarounds).
[36m(AgentLoopWorker pid=436891)[0m {[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m   "type": "function",[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m   "function": {[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m     "name": "calc_geo3k_reward",[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m     "parameters": {[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m       "type": "object",[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m       "properties": {[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m         "answer": {[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m           "type": "string",[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m }[32m [repeated 172x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m       },[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m       "required": [[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m         "answer"[32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436891)[0m       ][32m [repeated 43x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m {[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m   "type": "function",[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m   "function": {[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "name": "calc_geo3k_reward",[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "parameters": {[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "type": "object",[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "properties": {[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m         "answer": {[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m           "type": "string",[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m }[32m [repeated 144x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       },[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "required": [[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m         "answer"[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       ][32m [repeated 36x across cluster][0m
[33m(raylet)[0m WARNING: 1582 PYTHON worker processes have been started on node: c6050fea88602aeb14f30ebf6ea7f1cec4cfcc3eedcb5fe7f17579fc with address: 10.22.4.86. This could be a result of using a large number of actors, or due to tasks blocked in ray.get() calls (see https://github.com/ray-project/ray/issues/3644 for some discussion of workarounds).
[36m(AgentLoopWorker pid=436889)[0m {[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m   "type": "function",[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m   "function": {[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m     "name": "calc_geo3k_reward",[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m     "parameters": {[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m       "type": "object",[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m       "properties": {[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m         "answer": {[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m           "type": "string",[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m }[32m [repeated 144x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m       },[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m       "required": [[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m         "answer"[32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436889)[0m       ][32m [repeated 36x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m {[32m [repeated 45x across cluster][0m
[33m(raylet)[0m [2025-12-31 22:13:57,815 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 148.001 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[33m(raylet)[0m [2025-12-31 22:14:07,886 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 147.999 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(AgentLoopWorker pid=436898)[0m   "type": "function",[32m [repeated 45x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "function": {[32m [repeated 45x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "name": "calc_geo3k_reward",[32m [repeated 45x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 45x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "parameters": {[32m [repeated 45x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "type": "object",[32m [repeated 45x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "properties": {[32m [repeated 45x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer": {[32m [repeated 45x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "type": "string",[32m [repeated 45x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 45x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m }[32m [repeated 180x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       },[32m [repeated 45x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "required": [[32m [repeated 45x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer"[32m [repeated 45x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       ][32m [repeated 45x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m 
[36m(AgentLoopWorker pid=436896)[0m {[32m [repeated 15x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m   "type": "function",[32m [repeated 15x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m   "function": {[32m [repeated 15x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m     "name": "calc_geo3k_reward",[32m [repeated 15x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 15x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m     "parameters": {[32m [repeated 15x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       "type": "object",[32m [repeated 15x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       "properties": {[32m [repeated 15x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m         "answer": {[32m [repeated 15x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m           "type": "string",[32m [repeated 15x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 15x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m }[32m [repeated 60x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       },[32m [repeated 15x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       "required": [[32m [repeated 15x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m         "answer"[32m [repeated 15x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       ][32m [repeated 15x across cluster][0m
[33m(raylet)[0m WARNING: 1792 PYTHON worker processes have been started on node: c6050fea88602aeb14f30ebf6ea7f1cec4cfcc3eedcb5fe7f17579fc with address: 10.22.4.86. This could be a result of using a large number of actors, or due to tasks blocked in ray.get() calls (see https://github.com/ray-project/ray/issues/3644 for some discussion of workarounds).
[36m(AgentLoopWorker pid=436896)[0m {[32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m   "type": "function",[32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m   "function": {[32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m     "name": "calc_geo3k_reward",[32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m     "parameters": {[32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       "type": "object",[32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       "properties": {[32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m         "answer": {[32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m           "type": "string",[32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m }[32m [repeated 104x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       },[32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       "required": [[32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m         "answer"[32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       ][32m [repeated 26x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m 
[36m(AgentLoopWorker pid=436898)[0m {[32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "type": "function",[32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "function": {[32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "name": "calc_geo3k_reward",[32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "parameters": {[32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "type": "object",[32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "properties": {[32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer": {[32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "type": "string",[32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m }[32m [repeated 316x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       },[32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "required": [[32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer"[32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       ][32m [repeated 79x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m {[32m [repeated 37x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m   "type": "function",[32m [repeated 37x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m   "function": {[32m [repeated 37x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "name": "calc_geo3k_reward",[32m [repeated 37x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 37x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "parameters": {[32m [repeated 37x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "type": "object",[32m [repeated 37x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "properties": {[32m [repeated 37x across cluster][0m
[33m(raylet)[0m [2025-12-31 22:14:17,887 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 147.997 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[33m(raylet)[0m [2025-12-31 22:14:27,901 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 147.996 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[33m(raylet)[0m [2025-12-31 22:14:37,919 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 147.995 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(AgentLoopWorker pid=436892)[0m         "answer": {[32m [repeated 37x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m           "type": "string",[32m [repeated 37x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 37x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m }[32m [repeated 148x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       },[32m [repeated 37x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "required": [[32m [repeated 37x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m         "answer"[32m [repeated 37x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       ][32m [repeated 37x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m {[32m [repeated 20x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "type": "function",[32m [repeated 20x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "function": {[32m [repeated 20x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "name": "calc_geo3k_reward",[32m [repeated 20x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 20x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "parameters": {[32m [repeated 20x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "type": "object",[32m [repeated 20x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "properties": {[32m [repeated 20x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer": {[32m [repeated 20x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "type": "string",[32m [repeated 20x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 20x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m }[32m [repeated 80x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       },[32m [repeated 20x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "required": [[32m [repeated 20x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer"[32m [repeated 20x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       ][32m [repeated 20x across cluster][0m
[33m(raylet)[0m WARNING: 2016 PYTHON worker processes have been started on node: c6050fea88602aeb14f30ebf6ea7f1cec4cfcc3eedcb5fe7f17579fc with address: 10.22.4.86. This could be a result of using a large number of actors, or due to tasks blocked in ray.get() calls (see https://github.com/ray-project/ray/issues/3644 for some discussion of workarounds).
[36m(AgentLoopWorker pid=436896)[0m {[32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m   "type": "function",[32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m   "function": {[32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m     "name": "calc_geo3k_reward",[32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m     "parameters": {[32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       "type": "object",[32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       "properties": {[32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m         "answer": {[32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m           "type": "string",[32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m }[32m [repeated 344x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       },[32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       "required": [[32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m         "answer"[32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       ][32m [repeated 86x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m {[32m [repeated 17x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "type": "function",[32m [repeated 17x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "function": {[32m [repeated 17x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "name": "calc_geo3k_reward",[32m [repeated 17x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 17x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "parameters": {[32m [repeated 17x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "type": "object",[32m [repeated 17x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "properties": {[32m [repeated 17x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer": {[32m [repeated 17x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "type": "string",[32m [repeated 17x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 17x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m }[32m [repeated 68x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       },[32m [repeated 17x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "required": [[32m [repeated 17x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer"[32m [repeated 17x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       ][32m [repeated 17x across cluster][0m
[33m(raylet)[0m WARNING: 2242 PYTHON worker processes have been started on node: c6050fea88602aeb14f30ebf6ea7f1cec4cfcc3eedcb5fe7f17579fc with address: 10.22.4.86. This could be a result of using a large number of actors, or due to tasks blocked in ray.get() calls (see https://github.com/ray-project/ray/issues/3644 for some discussion of workarounds).
[36m(AgentLoopWorker pid=436898)[0m {[32m [repeated 25x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "type": "function",[32m [repeated 25x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m   "function": {[32m [repeated 25x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "name": "calc_geo3k_reward",[32m [repeated 25x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 25x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m     "parameters": {[32m [repeated 25x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "type": "object",[32m [repeated 25x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       "properties": {[32m [repeated 25x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer": {[32m [repeated 25x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "type": "string",[32m [repeated 25x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 25x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m }[32m [repeated 100x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       },[32m [repeated 25x across cluster][0m
[33m(raylet)[0m [2025-12-31 22:14:47,990 E 404252 404293] (raylet) file_system_monitor.cc:116: /project/peilab/qjl/tmp/ray/session_2025-12-31_22-09-01_964257_403219 is over 95% full, available space: 147.994 GB; capacity: 5120 GB. Object creation will fail if spilling is required.
[36m(AgentLoopWorker pid=436898)[0m       "required": [[32m [repeated 25x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m         "answer"[32m [repeated 25x across cluster][0m
[36m(AgentLoopWorker pid=436898)[0m       ][32m [repeated 25x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m {[32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m   "type": "function",[32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m   "function": {[32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m     "name": "calc_geo3k_reward",[32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m     "parameters": {[32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m       "type": "object",[32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m       "properties": {[32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m         "answer": {[32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m           "type": "string",[32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m }[32m [repeated 200x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m       },[32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m       "required": [[32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m         "answer"[32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436890)[0m       ][32m [repeated 50x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m {[32m [repeated 16x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m   "type": "function",[32m [repeated 16x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m   "function": {[32m [repeated 16x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m     "name": "calc_geo3k_reward",[32m [repeated 16x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 16x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m     "parameters": {[32m [repeated 16x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       "type": "object",[32m [repeated 16x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       "properties": {[32m [repeated 16x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m         "answer": {[32m [repeated 16x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m           "type": "string",[32m [repeated 16x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 16x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m }[32m [repeated 64x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       },[32m [repeated 16x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       "required": [[32m [repeated 16x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m         "answer"[32m [repeated 16x across cluster][0m
[36m(AgentLoopWorker pid=436896)[0m       ][32m [repeated 16x across cluster][0m
[33m(raylet)[0m WARNING: 2470 PYTHON worker processes have been started on node: c6050fea88602aeb14f30ebf6ea7f1cec4cfcc3eedcb5fe7f17579fc with address: 10.22.4.86. This could be a result of using a large number of actors, or due to tasks blocked in ray.get() calls (see https://github.com/ray-project/ray/issues/3644 for some discussion of workarounds).
[36m(AgentLoopWorker pid=436892)[0m {[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m   "type": "function",[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m   "function": {[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "name": "calc_geo3k_reward",[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m     "parameters": {[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "type": "object",[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "properties": {[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m         "answer": {[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m           "type": "string",[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m }[32m [repeated 96x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       },[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       "required": [[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m         "answer"[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436892)[0m       ][32m [repeated 24x across cluster][0m
Error executing job with overrides: ['algorithm.adv_estimator=grpo', 'data.train_batch_size=32', 'data.max_prompt_length=1024', 'data.max_response_length=2048', 'data.filter_overlong_prompts=False', 'data.truncation=error', 'data.return_raw_chat=True', 'actor_rollout_ref.model.path=/project/peilab/qjl/MODEL/Qwen3-VL-4B-Instruct', 'actor_rollout_ref.actor.optim.lr=1e-6', 'actor_rollout_ref.model.use_remove_padding=True', 'actor_rollout_ref.actor.ppo_mini_batch_size=32', 'actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=4', 'actor_rollout_ref.actor.use_kl_loss=False', 'actor_rollout_ref.actor.entropy_coeff=0', 'actor_rollout_ref.model.enable_gradient_checkpointing=True', 'actor_rollout_ref.actor.fsdp_config.param_offload=False', 'actor_rollout_ref.actor.fsdp_config.optimizer_offload=False', 'actor_rollout_ref.rollout.log_prob_micro_batch_size_per_gpu=4', 'actor_rollout_ref.rollout.tensor_model_parallel_size=1', 'actor_rollout_ref.rollout.name=sglang', 'actor_rollout_ref.rollout.gpu_memory_utilization=0.5', 'actor_rollout_ref.rollout.n=16', 'actor_rollout_ref.ref.log_prob_micro_batch_size_per_gpu=4', 'actor_rollout_ref.ref.fsdp_config.param_offload=True', 'algorithm.use_kl_in_reward=False', 'trainer.critic_warmup=0', 'trainer.logger=["console","wandb"]', 'trainer.project_name=answer-ask_async_rl', 'trainer.experiment_name=qwen3-4b-a2po-sgl-multi-w-tool', 'trainer.n_gpus_per_node=8', 'trainer.nnodes=1', 'trainer.save_freq=20', 'trainer.test_freq=20', 'data.train_files=/project/peilab/qjl/CODE/DATA/train.parquet', 'data.val_files=/project/peilab/qjl/CODE/DATA/test.parquet', 'actor_rollout_ref.rollout.multi_turn.tool_config_path=/project/peilab/qjl/CODE/verl/examples/Answer-Ask_VL/a2agent_tool_config.yaml', 'trainer.total_epochs=15']
[36mray::TaskRunner.run()[39m (pid=418303, ip=10.22.4.86, actor_id=957c89e07091b8f90c4704aa01000000, repr=<main_ppo.TaskRunner object at 0x15242f4c9270>)
  File "/project/peilab/qjl/CODE/verl/verl/trainer/main_ppo.py", line 374, in run
    trainer.fit()
  File "/project/peilab/qjl/CODE/verl/verl/trainer/ppo/ray_trainer.py", line 1281, in fit
    val_metrics = self._validate()
  File "/project/peilab/qjl/CODE/verl/verl/trainer/ppo/ray_trainer.py", line 669, in _validate
    test_output_gen_batch_padded = self.async_rollout_manager.generate_sequences(test_gen_batch_padded)
  File "/project/peilab/qjl/CODE/verl/verl/experimental/agent_loop/agent_loop.py", line 815, in generate_sequences
    outputs = ray.get(
ray.exceptions.RayTaskError(InstantiationException): [36mray::AgentLoopWorker.generate_sequences()[39m (pid=436898, ip=10.22.4.86, actor_id=11468052241062b1e25fe61a01000000, repr=<verl.experimental.agent_loop.agent_loop.AgentLoopWorker object at 0x1523d61c1000>)
  File "/project/peilab/qjl/CODE/verl/verl/experimental/agent_loop/tool_agent_loop.py", line 116, in __init__
    self.tool_parser = MultiModalCodeToolParser()
TypeError: MultiModalCodeToolParser.__init__() missing 1 required positional argument: 'tokenizer'

The above exception was the direct cause of the following exception:

[36mray::AgentLoopWorker.generate_sequences()[39m (pid=436898, ip=10.22.4.86, actor_id=11468052241062b1e25fe61a01000000, repr=<verl.experimental.agent_loop.agent_loop.AgentLoopWorker object at 0x1523d61c1000>)
  File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/concurrent/futures/_base.py", line 451, in result
    return self.__get_result()
  File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
    raise self._exception
  File "/project/peilab/qjl/CODE/verl/verl/utils/transferqueue_utils.py", line 319, in dummy_async_inner
    output = await func(*args, **kwargs)
  File "/project/peilab/qjl/CODE/verl/verl/experimental/agent_loop/agent_loop.py", line 379, in generate_sequences
    outputs = await asyncio.gather(*tasks)
  File "/project/peilab/qjl/CODE/verl/verl/experimental/agent_loop/agent_loop.py", line 407, in _run_agent_loop
    agent_loop = hydra.utils.instantiate(
  File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'verl.experimental.agent_loop.tool_agent_loop.ToolAgentLoop':
TypeError("MultiModalCodeToolParser.__init__() missing 1 required positional argument: 'tokenizer'")

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
[36m(AgentLoopWorker pid=436895)[0m {[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m   "type": "function",[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m   "function": {[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m     "name": "calc_geo3k_reward",[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m     "description": "A tool for calculating the reward of geo3k. (1.0 if parsed answer is correct, 0.0 if parsed answer is incorrect or not correctly parsed)",[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m     "parameters": {[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m       "type": "object",[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m       "properties": {[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m         "answer": {[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m           "type": "string",[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m           "description": "The model's answer to the geo3k problem, must be a digits"[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m }[32m [repeated 96x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m       },[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m       "required": [[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m         "answer"[32m [repeated 24x across cluster][0m
[36m(AgentLoopWorker pid=436895)[0m       ][32m [repeated 24x across cluster][0m
