/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
2025-12-29 23:47:28,660	INFO worker.py:2003 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/ray/_private/worker.py:2051: FutureWarning: Tip: In future versions of Ray, Ray will no longer override accelerator visible devices env var if num_gpus=0 or num_gpus=None (default). To enable this behavior and turn off this error message, set RAY_ACCEL_ENV_VAR_OVERRIDE_ON_ZERO=0
  warnings.warn(
[36m(pid=2544183)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=2544183)[0m   import pynvml  # type: ignore[import]
ray init kwargs: {'num_cpus': None, 'runtime_env': {'env_vars': {'TOKENIZERS_PARALLELISM': 'true', 'NCCL_DEBUG': 'WARN', 'VLLM_LOGGING_LEVEL': 'WARN', 'VLLM_ALLOW_RUNTIME_LORA_UPDATING': 'true', 'VLLM_ALLREDUCE_USE_SYMM_MEM': '0', 'CUDA_DEVICE_MAX_CONNECTIONS': '1', 'NCCL_CUMEM_ENABLE': '0'}, 'working_dir': None}}
[36m(TaskRunner pid=2544183)[0m TaskRunner hostname: dgx-10, PID: 2544183
[36m(TaskRunner pid=2544183)[0m {'actor_rollout_ref': {'actor': {'_target_': 'verl.workers.config.FSDPActorConfig',
[36m(TaskRunner pid=2544183)[0m                                  'calculate_entropy': False,
[36m(TaskRunner pid=2544183)[0m                                  'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=2544183)[0m                                                 'async_save': False,
[36m(TaskRunner pid=2544183)[0m                                                 'load_contents': ['model',
[36m(TaskRunner pid=2544183)[0m                                                                   'optimizer',
[36m(TaskRunner pid=2544183)[0m                                                                   'extra'],
[36m(TaskRunner pid=2544183)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=2544183)[0m                                                                   'optimizer',
[36m(TaskRunner pid=2544183)[0m                                                                   'extra']},
[36m(TaskRunner pid=2544183)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=2544183)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=2544183)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=2544183)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=2544183)[0m                                  'data_loader_seed': 42,
[36m(TaskRunner pid=2544183)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=2544183)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=2544183)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2544183)[0m                                  'freeze_vision_tower': False,
[36m(TaskRunner pid=2544183)[0m                                  'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2544183)[0m                                                  'dtype': 'bfloat16',
[36m(TaskRunner pid=2544183)[0m                                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=2544183)[0m                                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2544183)[0m                                                  'forward_only': False,
[36m(TaskRunner pid=2544183)[0m                                                  'forward_prefetch': False,
[36m(TaskRunner pid=2544183)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=2544183)[0m                                                  'full_determinism': False,
[36m(TaskRunner pid=2544183)[0m                                                  'model_dtype': 'bfloat16',
[36m(TaskRunner pid=2544183)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=2544183)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=2544183)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=2544183)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=2544183)[0m                                                  'seed': 42,
[36m(TaskRunner pid=2544183)[0m                                                  'strategy': 'fsdp',
[36m(TaskRunner pid=2544183)[0m                                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2544183)[0m                                                  'use_orig_params': False,
[36m(TaskRunner pid=2544183)[0m                                                  'use_torch_compile': True,
[36m(TaskRunner pid=2544183)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2544183)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=2544183)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=2544183)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=2544183)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2544183)[0m                                  'loss_scale_factor': None,
[36m(TaskRunner pid=2544183)[0m                                  'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=2544183)[0m                                            'betas': [0.9, 0.999],
[36m(TaskRunner pid=2544183)[0m                                            'clip_grad': 1.0,
[36m(TaskRunner pid=2544183)[0m                                            'lr': 1e-06,
[36m(TaskRunner pid=2544183)[0m                                            'lr_scheduler_type': 'constant',
[36m(TaskRunner pid=2544183)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=2544183)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2544183)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=2544183)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=2544183)[0m                                            'optimizer': 'AdamW',
[36m(TaskRunner pid=2544183)[0m                                            'optimizer_impl': 'torch.optim',
[36m(TaskRunner pid=2544183)[0m                                            'override_optimizer_config': None,
[36m(TaskRunner pid=2544183)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=2544183)[0m                                            'warmup_style': None,
[36m(TaskRunner pid=2544183)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=2544183)[0m                                  'policy_loss': {'_target_': 'verl.workers.config.PolicyLossConfig',
[36m(TaskRunner pid=2544183)[0m                                                  'clip_cov_lb': 1.0,
[36m(TaskRunner pid=2544183)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=2544183)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=2544183)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=2544183)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=2544183)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=2544183)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=2544183)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2544183)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2544183)[0m                                  'ppo_micro_batch_size_per_gpu': 8,
[36m(TaskRunner pid=2544183)[0m                                  'ppo_mini_batch_size': 512,
[36m(TaskRunner pid=2544183)[0m                                  'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2544183)[0m                                               'all_ranks': False,
[36m(TaskRunner pid=2544183)[0m                                               'enable': False,
[36m(TaskRunner pid=2544183)[0m                                               'ranks': [],
[36m(TaskRunner pid=2544183)[0m                                               'save_path': 'outputs/profile',
[36m(TaskRunner pid=2544183)[0m                                               'tool': None,
[36m(TaskRunner pid=2544183)[0m                                               'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                                       'analysis': True,
[36m(TaskRunner pid=2544183)[0m                                                                       'contents': [],
[36m(TaskRunner pid=2544183)[0m                                                                       'discrete': False,
[36m(TaskRunner pid=2544183)[0m                                                                       'level': 'level0'},
[36m(TaskRunner pid=2544183)[0m                                                               'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                                        'discrete': False},
[36m(TaskRunner pid=2544183)[0m                                                               'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                                         'step_end': None,
[36m(TaskRunner pid=2544183)[0m                                                                         'step_start': 0},
[36m(TaskRunner pid=2544183)[0m                                                               'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                                                'stack_depth': 32,
[36m(TaskRunner pid=2544183)[0m                                                                                'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=2544183)[0m                                  'rollout_n': 8,
[36m(TaskRunner pid=2544183)[0m                                  'router_replay': {'_target_': 'verl.workers.config.RouterReplayConfig',
[36m(TaskRunner pid=2544183)[0m                                                    'mode': 'disabled',
[36m(TaskRunner pid=2544183)[0m                                                    'record_file': None,
[36m(TaskRunner pid=2544183)[0m                                                    'replay_file': None},
[36m(TaskRunner pid=2544183)[0m                                  'shuffle': False,
[36m(TaskRunner pid=2544183)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=2544183)[0m                                  'tau_neg': 1.05,
[36m(TaskRunner pid=2544183)[0m                                  'tau_pos': 1.0,
[36m(TaskRunner pid=2544183)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2544183)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=2544183)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=2544183)[0m                                  'use_kl_loss': True,
[36m(TaskRunner pid=2544183)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=2544183)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=2544183)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=2544183)[0m                        'model': {'_target_': 'verl.workers.config.HFModelConfig',
[36m(TaskRunner pid=2544183)[0m                                  'custom_chat_template': None,
[36m(TaskRunner pid=2544183)[0m                                  'enable_activation_offload': True,
[36m(TaskRunner pid=2544183)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=2544183)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=2544183)[0m                                  'external_lib': None,
[36m(TaskRunner pid=2544183)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=2544183)[0m                                  'hf_config_path': None,
[36m(TaskRunner pid=2544183)[0m                                  'lora_adapter_path': None,
[36m(TaskRunner pid=2544183)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=2544183)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=2544183)[0m                                  'override_config': {},
[36m(TaskRunner pid=2544183)[0m                                  'path': '/project/peilab/qjl/MODEL/Qwen3-VL-4B-Instruct',
[36m(TaskRunner pid=2544183)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=2544183)[0m                                  'tokenizer_path': None,
[36m(TaskRunner pid=2544183)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=2544183)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=2544183)[0m                                  'use_liger': False,
[36m(TaskRunner pid=2544183)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=2544183)[0m                                  'use_shm': False},
[36m(TaskRunner pid=2544183)[0m                        'nccl_timeout': 600,
[36m(TaskRunner pid=2544183)[0m                        'ref': {'_target_': 'verl.workers.config.FSDPActorConfig',
[36m(TaskRunner pid=2544183)[0m                                'entropy_checkpointing': False,
[36m(TaskRunner pid=2544183)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2544183)[0m                                'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2544183)[0m                                                'dtype': 'bfloat16',
[36m(TaskRunner pid=2544183)[0m                                                'entropy_checkpointing': False,
[36m(TaskRunner pid=2544183)[0m                                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2544183)[0m                                                'forward_only': True,
[36m(TaskRunner pid=2544183)[0m                                                'forward_prefetch': False,
[36m(TaskRunner pid=2544183)[0m                                                'fsdp_size': -1,
[36m(TaskRunner pid=2544183)[0m                                                'full_determinism': False,
[36m(TaskRunner pid=2544183)[0m                                                'model_dtype': 'fp32',
[36m(TaskRunner pid=2544183)[0m                                                'offload_policy': False,
[36m(TaskRunner pid=2544183)[0m                                                'optimizer_offload': False,
[36m(TaskRunner pid=2544183)[0m                                                'param_offload': False,
[36m(TaskRunner pid=2544183)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=2544183)[0m                                                'seed': 42,
[36m(TaskRunner pid=2544183)[0m                                                'strategy': 'fsdp',
[36m(TaskRunner pid=2544183)[0m                                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2544183)[0m                                                'use_orig_params': False,
[36m(TaskRunner pid=2544183)[0m                                                'use_torch_compile': True,
[36m(TaskRunner pid=2544183)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2544183)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2544183)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=2544183)[0m                                'log_prob_micro_batch_size_per_gpu': 8,
[36m(TaskRunner pid=2544183)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2544183)[0m                                'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2544183)[0m                                             'all_ranks': False,
[36m(TaskRunner pid=2544183)[0m                                             'enable': False,
[36m(TaskRunner pid=2544183)[0m                                             'ranks': [],
[36m(TaskRunner pid=2544183)[0m                                             'save_path': 'outputs/profile',
[36m(TaskRunner pid=2544183)[0m                                             'tool': None,
[36m(TaskRunner pid=2544183)[0m                                             'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                                     'analysis': True,
[36m(TaskRunner pid=2544183)[0m                                                                     'contents': [],
[36m(TaskRunner pid=2544183)[0m                                                                     'discrete': False,
[36m(TaskRunner pid=2544183)[0m                                                                     'level': 'level0'},
[36m(TaskRunner pid=2544183)[0m                                                             'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                                      'discrete': False},
[36m(TaskRunner pid=2544183)[0m                                                             'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                                       'step_end': None,
[36m(TaskRunner pid=2544183)[0m                                                                       'step_start': 0},
[36m(TaskRunner pid=2544183)[0m                                                             'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                                              'stack_depth': 32,
[36m(TaskRunner pid=2544183)[0m                                                                              'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=2544183)[0m                                'rollout_n': 8,
[36m(TaskRunner pid=2544183)[0m                                'router_replay': {'_target_': 'verl.workers.config.RouterReplayConfig',
[36m(TaskRunner pid=2544183)[0m                                                  'mode': 'disabled',
[36m(TaskRunner pid=2544183)[0m                                                  'record_file': None,
[36m(TaskRunner pid=2544183)[0m                                                  'replay_file': None},
[36m(TaskRunner pid=2544183)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=2544183)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2544183)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=2544183)[0m                        'rollout': {'_target_': 'verl.workers.config.RolloutConfig',
[36m(TaskRunner pid=2544183)[0m                                    'agent': {'_target_': 'verl.workers.config.AgentLoopConfig',
[36m(TaskRunner pid=2544183)[0m                                              'agent_loop_config_path': None,
[36m(TaskRunner pid=2544183)[0m                                              'custom_async_server': {'_target_': 'verl.workers.config.CustomAsyncServerConfig',
[36m(TaskRunner pid=2544183)[0m                                                                      'name': None,
[36m(TaskRunner pid=2544183)[0m                                                                      'path': None},
[36m(TaskRunner pid=2544183)[0m                                              'default_agent_loop': 'single_turn_agent',
[36m(TaskRunner pid=2544183)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=2544183)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=2544183)[0m                                    'cudagraph_capture_sizes': None,
[36m(TaskRunner pid=2544183)[0m                                    'data_parallel_size': 1,
[36m(TaskRunner pid=2544183)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=2544183)[0m                                    'do_sample': True,
[36m(TaskRunner pid=2544183)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=2544183)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=2544183)[0m                                    'enable_prefix_caching': True,
[36m(TaskRunner pid=2544183)[0m                                    'enable_rollout_routing_replay': False,
[36m(TaskRunner pid=2544183)[0m                                    'enforce_eager': False,
[36m(TaskRunner pid=2544183)[0m                                    'engine_kwargs': {'sglang': {}, 'vllm': {}},
[36m(TaskRunner pid=2544183)[0m                                    'expert_parallel_size': 1,
[36m(TaskRunner pid=2544183)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=2544183)[0m                                    'gpu_memory_utilization': 0.7,
[36m(TaskRunner pid=2544183)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=2544183)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=2544183)[0m                                    'load_format': 'dummy',
[36m(TaskRunner pid=2544183)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2544183)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=2544183)[0m                                    'log_prob_micro_batch_size_per_gpu': 8,
[36m(TaskRunner pid=2544183)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2544183)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=2544183)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=2544183)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=2544183)[0m                                    'mode': 'async',
[36m(TaskRunner pid=2544183)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=2544183)[0m                                    'multi_turn': {'_target_': 'verl.workers.config.MultiTurnConfig',
[36m(TaskRunner pid=2544183)[0m                                                   'enable': True,
[36m(TaskRunner pid=2544183)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=2544183)[0m                                                   'interaction_config_path': '/project/peilab/qjl/CODE/verl/examples/sglang_multiturn/config/interaction_config/gsm8k_interaction_config.yaml',
[36m(TaskRunner pid=2544183)[0m                                                   'max_assistant_turns': None,
[36m(TaskRunner pid=2544183)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=2544183)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=2544183)[0m                                                   'max_user_turns': 5,
[36m(TaskRunner pid=2544183)[0m                                                   'num_repeat_rollouts': None,
[36m(TaskRunner pid=2544183)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=2544183)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=2544183)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=2544183)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=2544183)[0m                                    'n': 8,
[36m(TaskRunner pid=2544183)[0m                                    'name': 'sglang',
[36m(TaskRunner pid=2544183)[0m                                    'over_sample_rate': 0,
[36m(TaskRunner pid=2544183)[0m                                    'pipeline_model_parallel_size': 1,
[36m(TaskRunner pid=2544183)[0m                                    'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2544183)[0m                                                 'all_ranks': False,
[36m(TaskRunner pid=2544183)[0m                                                 'enable': False,
[36m(TaskRunner pid=2544183)[0m                                                 'ranks': [],
[36m(TaskRunner pid=2544183)[0m                                                 'save_path': 'outputs/profile',
[36m(TaskRunner pid=2544183)[0m                                                 'tool': None,
[36m(TaskRunner pid=2544183)[0m                                                 'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                                         'analysis': True,
[36m(TaskRunner pid=2544183)[0m                                                                         'contents': [],
[36m(TaskRunner pid=2544183)[0m                                                                         'discrete': False,
[36m(TaskRunner pid=2544183)[0m                                                                         'level': 'level0'},
[36m(TaskRunner pid=2544183)[0m                                                                 'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                                          'discrete': False},
[36m(TaskRunner pid=2544183)[0m                                                                 'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                                           'step_end': None,
[36m(TaskRunner pid=2544183)[0m                                                                           'step_start': 0},
[36m(TaskRunner pid=2544183)[0m                                                                 'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                                                  'stack_depth': 32,
[36m(TaskRunner pid=2544183)[0m                                                                                  'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=2544183)[0m                                    'prometheus': {'_target_': 'verl.workers.config.PrometheusConfig',
[36m(TaskRunner pid=2544183)[0m                                                   'enable': False,
[36m(TaskRunner pid=2544183)[0m                                                   'file': '/tmp/ray/session_latest/metrics/prometheus/prometheus.yml',
[36m(TaskRunner pid=2544183)[0m                                                   'port': 9090,
[36m(TaskRunner pid=2544183)[0m                                                   'served_model_name': '/project/peilab/qjl/MODEL/Qwen3-VL-4B-Instruct'},
[36m(TaskRunner pid=2544183)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=2544183)[0m                                    'quantization': None,
[36m(TaskRunner pid=2544183)[0m                                    'quantization_config_file': None,
[36m(TaskRunner pid=2544183)[0m                                    'response_length': 3072,
[36m(TaskRunner pid=2544183)[0m                                    'skip_dump_dir': '/tmp/rollout_dump',
[36m(TaskRunner pid=2544183)[0m                                    'skip_rollout': False,
[36m(TaskRunner pid=2544183)[0m                                    'skip_tokenizer_init': True,
[36m(TaskRunner pid=2544183)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=2544183)[0m                                    'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=2544183)[0m                                    'top_k': -1,
[36m(TaskRunner pid=2544183)[0m                                    'top_p': 1,
[36m(TaskRunner pid=2544183)[0m                                    'trace': {'_target_': 'verl.workers.config.TraceConfig',
[36m(TaskRunner pid=2544183)[0m                                              'backend': None,
[36m(TaskRunner pid=2544183)[0m                                              'max_samples_per_step_per_worker': None,
[36m(TaskRunner pid=2544183)[0m                                              'token2text': False},
[36m(TaskRunner pid=2544183)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=2544183)[0m                                    'val_kwargs': {'_target_': 'verl.workers.config.SamplingConfig',
[36m(TaskRunner pid=2544183)[0m                                                   'do_sample': False,
[36m(TaskRunner pid=2544183)[0m                                                   'n': 1,
[36m(TaskRunner pid=2544183)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=2544183)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=2544183)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=2544183)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=2544183)[0m                'adv_estimator': 'grpo',
[36m(TaskRunner pid=2544183)[0m                'gamma': 1.0,
[36m(TaskRunner pid=2544183)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=2544183)[0m                            'horizon': 10000,
[36m(TaskRunner pid=2544183)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=2544183)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=2544183)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=2544183)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=2544183)[0m                'lam': 1.0,
[36m(TaskRunner pid=2544183)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=2544183)[0m                'pf_ppo': {'reweight_method': 'pow', 'weight_pow': 2.0},
[36m(TaskRunner pid=2544183)[0m                'rollout_correction': {'bypass_mode': False,
[36m(TaskRunner pid=2544183)[0m                                       'loss_type': 'ppo_clip',
[36m(TaskRunner pid=2544183)[0m                                       'rollout_is': None,
[36m(TaskRunner pid=2544183)[0m                                       'rollout_is_batch_normalize': False,
[36m(TaskRunner pid=2544183)[0m                                       'rollout_is_threshold': 2.0,
[36m(TaskRunner pid=2544183)[0m                                       'rollout_rs': None,
[36m(TaskRunner pid=2544183)[0m                                       'rollout_rs_threshold': None,
[36m(TaskRunner pid=2544183)[0m                                       'rollout_rs_threshold_lower': None,
[36m(TaskRunner pid=2544183)[0m                                       'rollout_token_veto_threshold': None},
[36m(TaskRunner pid=2544183)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=2544183)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=2544183)[0m  'critic': {'_target_': 'verl.workers.config.FSDPCriticConfig',
[36m(TaskRunner pid=2544183)[0m             'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=2544183)[0m                            'async_save': False,
[36m(TaskRunner pid=2544183)[0m                            'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=2544183)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=2544183)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=2544183)[0m             'data_loader_seed': 42,
[36m(TaskRunner pid=2544183)[0m             'enable': None,
[36m(TaskRunner pid=2544183)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2544183)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=2544183)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2544183)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=2544183)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2544183)[0m             'model': {'_target_': 'verl.workers.config.FSDPCriticModelCfg',
[36m(TaskRunner pid=2544183)[0m                       'enable_activation_offload': False,
[36m(TaskRunner pid=2544183)[0m                       'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=2544183)[0m                       'external_lib': None,
[36m(TaskRunner pid=2544183)[0m                       'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2544183)[0m                                       'dtype': 'bfloat16',
[36m(TaskRunner pid=2544183)[0m                                       'entropy_checkpointing': False,
[36m(TaskRunner pid=2544183)[0m                                       'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2544183)[0m                                       'forward_only': False,
[36m(TaskRunner pid=2544183)[0m                                       'forward_prefetch': False,
[36m(TaskRunner pid=2544183)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=2544183)[0m                                       'full_determinism': False,
[36m(TaskRunner pid=2544183)[0m                                       'model_dtype': 'fp32',
[36m(TaskRunner pid=2544183)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=2544183)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=2544183)[0m                                       'param_offload': False,
[36m(TaskRunner pid=2544183)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=2544183)[0m                                       'seed': 42,
[36m(TaskRunner pid=2544183)[0m                                       'strategy': 'fsdp',
[36m(TaskRunner pid=2544183)[0m                                       'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2544183)[0m                                       'use_orig_params': False,
[36m(TaskRunner pid=2544183)[0m                                       'use_torch_compile': True,
[36m(TaskRunner pid=2544183)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2544183)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=2544183)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=2544183)[0m                       'override_config': {},
[36m(TaskRunner pid=2544183)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=2544183)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=2544183)[0m                       'tokenizer_path': '/project/peilab/qjl/MODEL/Qwen3-VL-4B-Instruct',
[36m(TaskRunner pid=2544183)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=2544183)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=2544183)[0m                       'use_shm': False},
[36m(TaskRunner pid=2544183)[0m             'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=2544183)[0m                       'betas': [0.9, 0.999],
[36m(TaskRunner pid=2544183)[0m                       'clip_grad': 1.0,
[36m(TaskRunner pid=2544183)[0m                       'lr': 1e-05,
[36m(TaskRunner pid=2544183)[0m                       'lr_scheduler_type': 'constant',
[36m(TaskRunner pid=2544183)[0m                       'lr_warmup_steps': -1,
[36m(TaskRunner pid=2544183)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2544183)[0m                       'min_lr_ratio': 0.0,
[36m(TaskRunner pid=2544183)[0m                       'num_cycles': 0.5,
[36m(TaskRunner pid=2544183)[0m                       'optimizer': 'AdamW',
[36m(TaskRunner pid=2544183)[0m                       'optimizer_impl': 'torch.optim',
[36m(TaskRunner pid=2544183)[0m                       'override_optimizer_config': None,
[36m(TaskRunner pid=2544183)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=2544183)[0m                       'warmup_style': None,
[36m(TaskRunner pid=2544183)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=2544183)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=2544183)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2544183)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2544183)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2544183)[0m             'ppo_mini_batch_size': 512,
[36m(TaskRunner pid=2544183)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2544183)[0m                          'all_ranks': False,
[36m(TaskRunner pid=2544183)[0m                          'enable': False,
[36m(TaskRunner pid=2544183)[0m                          'ranks': [],
[36m(TaskRunner pid=2544183)[0m                          'save_path': 'outputs/profile',
[36m(TaskRunner pid=2544183)[0m                          'tool': None,
[36m(TaskRunner pid=2544183)[0m                          'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                  'analysis': True,
[36m(TaskRunner pid=2544183)[0m                                                  'contents': [],
[36m(TaskRunner pid=2544183)[0m                                                  'discrete': False,
[36m(TaskRunner pid=2544183)[0m                                                  'level': 'level0'},
[36m(TaskRunner pid=2544183)[0m                                          'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                   'discrete': False},
[36m(TaskRunner pid=2544183)[0m                                          'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                    'step_end': None,
[36m(TaskRunner pid=2544183)[0m                                                    'step_start': 0},
[36m(TaskRunner pid=2544183)[0m                                          'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                           'stack_depth': 32,
[36m(TaskRunner pid=2544183)[0m                                                           'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=2544183)[0m             'rollout_n': 8,
[36m(TaskRunner pid=2544183)[0m             'shuffle': False,
[36m(TaskRunner pid=2544183)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=2544183)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2544183)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=2544183)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=2544183)[0m  'data': {'apply_chat_template_kwargs': {},
[36m(TaskRunner pid=2544183)[0m           'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=2544183)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=2544183)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=2544183)[0m           'filter_overlong_prompts': True,
[36m(TaskRunner pid=2544183)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=2544183)[0m           'image_key': 'images',
[36m(TaskRunner pid=2544183)[0m           'image_patch_size': 14,
[36m(TaskRunner pid=2544183)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=2544183)[0m           'max_response_length': 3072,
[36m(TaskRunner pid=2544183)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=2544183)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=2544183)[0m           'return_multi_modal_inputs': True,
[36m(TaskRunner pid=2544183)[0m           'return_raw_chat': True,
[36m(TaskRunner pid=2544183)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=2544183)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=2544183)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=2544183)[0m           'seed': None,
[36m(TaskRunner pid=2544183)[0m           'shuffle': True,
[36m(TaskRunner pid=2544183)[0m           'tokenizer': None,
[36m(TaskRunner pid=2544183)[0m           'tool_config_path': None,
[36m(TaskRunner pid=2544183)[0m           'train_batch_size': 512,
[36m(TaskRunner pid=2544183)[0m           'train_files': '/project/peilab/qjl/CODE/verl/examples/Answer-Ask_VL/gsm8k/train.parquet',
[36m(TaskRunner pid=2544183)[0m           'train_max_samples': -1,
[36m(TaskRunner pid=2544183)[0m           'truncation': 'error',
[36m(TaskRunner pid=2544183)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=2544183)[0m           'use_shm': False,
[36m(TaskRunner pid=2544183)[0m           'val_batch_size': None,
[36m(TaskRunner pid=2544183)[0m           'val_files': '/project/peilab/qjl/CODE/verl/examples/Answer-Ask_VL/gsm8k/test.parquet',
[36m(TaskRunner pid=2544183)[0m           'val_max_samples': -1,
[36m(TaskRunner pid=2544183)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=2544183)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=2544183)[0m  'global_profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2544183)[0m                      'global_tool_config': {'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                      'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=2544183)[0m                                                                                    'cuda-memory-usage': 'true',
[36m(TaskRunner pid=2544183)[0m                                                                                    'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=2544183)[0m                                                      'discrete': False,
[36m(TaskRunner pid=2544183)[0m                                                      'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=2544183)[0m                                                                                'capture-range-end': None,
[36m(TaskRunner pid=2544183)[0m                                                                                'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=2544183)[0m                                                                                'cuda-memory-usage': 'true',
[36m(TaskRunner pid=2544183)[0m                                                                                'kill': 'none',
[36m(TaskRunner pid=2544183)[0m                                                                                'trace': 'cuda,nvtx,cublas,ucx'}},
[36m(TaskRunner pid=2544183)[0m                                             'torch_memory': {'context': 'all',
[36m(TaskRunner pid=2544183)[0m                                                              'kw_args': {},
[36m(TaskRunner pid=2544183)[0m                                                              'stack_depth': 32,
[36m(TaskRunner pid=2544183)[0m                                                              'stacks': 'all',
[36m(TaskRunner pid=2544183)[0m                                                              'trace_alloc_max_entries': 100000}},
[36m(TaskRunner pid=2544183)[0m                      'profile_continuous_steps': False,
[36m(TaskRunner pid=2544183)[0m                      'save_path': 'outputs/profile',
[36m(TaskRunner pid=2544183)[0m                      'steps': None,
[36m(TaskRunner pid=2544183)[0m                      'tool': None},
[36m(TaskRunner pid=2544183)[0m  'ray_kwargs': {'ray_init': {'num_cpus': None}, 'timeline_json_file': None},
[36m(TaskRunner pid=2544183)[0m  'reward_manager': {'_target_': 'verl.trainer.config.config.RewardManagerConfig',
[36m(TaskRunner pid=2544183)[0m                     'module': {'_target_': 'verl.trainer.config.config.ModuleConfig',
[36m(TaskRunner pid=2544183)[0m                                'name': 'custom_reward_manager',
[36m(TaskRunner pid=2544183)[0m                                'path': None},
[36m(TaskRunner pid=2544183)[0m                     'name': 'naive',
[36m(TaskRunner pid=2544183)[0m                     'source': 'register'},
[36m(TaskRunner pid=2544183)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=2544183)[0m                   'enable_resource_pool': False,
[36m(TaskRunner pid=2544183)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2544183)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=2544183)[0m                   'max_length': None,
[36m(TaskRunner pid=2544183)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=2544183)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2544183)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=2544183)[0m                             'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2544183)[0m                                             'forward_prefetch': False,
[36m(TaskRunner pid=2544183)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=2544183)[0m                                             'param_offload': False,
[36m(TaskRunner pid=2544183)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=2544183)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2544183)[0m                             'input_tokenizer': '/project/peilab/qjl/MODEL/Qwen3-VL-4B-Instruct',
[36m(TaskRunner pid=2544183)[0m                             'override_config': {},
[36m(TaskRunner pid=2544183)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=2544183)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=2544183)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=2544183)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=2544183)[0m                             'use_shm': False},
[36m(TaskRunner pid=2544183)[0m                   'n_gpus_per_node': 8,
[36m(TaskRunner pid=2544183)[0m                   'nnodes': 0,
[36m(TaskRunner pid=2544183)[0m                   'num_workers': 1,
[36m(TaskRunner pid=2544183)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2544183)[0m /project/peilab/qjl/CODE/verl/verl/trainer/main_ppo.py:307: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=2544183)[0m   use_critic=need_critic(config),
[36m(TaskRunner pid=2544183)[0m /project/peilab/qjl/CODE/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(TaskRunner pid=2544183)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(TaskRunner pid=2544183)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=2544183)[0m WARNING:2025-12-29 23:47:50,150:Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=2544183)[0m Filtering prompts longer than 1024 tokens (num_proc=1):   0%|          | 0/7473 [00:00<?, ? examples/s]
[36m(TaskRunner pid=2544183)[0m Filtering prompts longer than 1024 tokens (num_proc=1):  13%|█▎        | 1000/7473 [00:01<00:07, 861.22 examples/s]
[36m(TaskRunner pid=2544183)[0m Filtering prompts longer than 1024 tokens (num_proc=1):  27%|██▋       | 2000/7473 [00:01<00:03, 1505.02 examples/s]
[36m(TaskRunner pid=2544183)[0m Filtering prompts longer than 1024 tokens (num_proc=1):  40%|████      | 3000/7473 [00:01<00:02, 1983.26 examples/s]
[36m(TaskRunner pid=2544183)[0m Filtering prompts longer than 1024 tokens (num_proc=1):  54%|█████▎    | 4000/7473 [00:02<00:01, 2308.75 examples/s]
[36m(TaskRunner pid=2544183)[0m Filtering prompts longer than 1024 tokens (num_proc=1):  67%|██████▋   | 5000/7473 [00:02<00:00, 2541.56 examples/s]
[36m(TaskRunner pid=2544183)[0m Filtering prompts longer than 1024 tokens (num_proc=1):  80%|████████  | 6000/7473 [00:02<00:00, 2699.18 examples/s]
[36m(TaskRunner pid=2544183)[0m Filtering prompts longer than 1024 tokens (num_proc=1):  94%|█████████▎| 7000/7473 [00:03<00:00, 2835.05 examples/s]
[36m(TaskRunner pid=2544183)[0m Filtering prompts longer than 1024 tokens (num_proc=1): 100%|██████████| 7473/7473 [00:03<00:00, 2882.72 examples/s]Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/multiprocess/process.py", line 314, in _bootstrap
[36m(TaskRunner pid=2544183)[0m     self.run()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/multiprocess/process.py", line 108, in run
[36m(TaskRunner pid=2544183)[0m     self._target(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/multiprocess/managers.py", line 599, in _run_server
[36m(TaskRunner pid=2544183)[0m     server.serve_forever()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/multiprocess/managers.py", line 184, in serve_forever
[36m(TaskRunner pid=2544183)[0m     sys.exit(0)
[36m(TaskRunner pid=2544183)[0m SystemExit: 0
[36m(TaskRunner pid=2544183)[0m 
[36m(TaskRunner pid=2544183)[0m During handling of the above exception, another exception occurred:
[36m(TaskRunner pid=2544183)[0m 
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/multiprocess/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/multiprocess/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/multiprocess/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076817d74c0000050b'
[36m(TaskRunner pid=2544183)[0m Filtering prompts longer than 1024 tokens (num_proc=1): 100%|██████████| 7473/7473 [00:03<00:00, 2226.94 examples/s]
[36m(TaskRunner pid=2544183)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=2544183)[0m WARNING:2025-12-29 23:47:53,993:Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=2544183)[0m Filtering prompts longer than 1024 tokens (num_proc=1):   0%|          | 0/1319 [00:00<?, ? examples/s]
[36m(TaskRunner pid=2544183)[0m Filtering prompts longer than 1024 tokens (num_proc=1):  76%|███████▌  | 1000/1319 [00:01<00:00, 848.13 examples/s]
[36m(TaskRunner pid=2544183)[0m Filtering prompts longer than 1024 tokens (num_proc=1): 100%|██████████| 1319/1319 [00:01<00:00, 1095.33 examples/s]
[36m(TaskRunner pid=2544183)[0m                                'all_ranks': False,
[36m(TaskRunner pid=2544183)[0m                                'enable': False,
[36m(TaskRunner pid=2544183)[0m                                'ranks': [],
[36m(TaskRunner pid=2544183)[0m                                'save_path': 'outputs/profile',
[36m(TaskRunner pid=2544183)[0m                                'tool': None,
[36m(TaskRunner pid=2544183)[0m                                'tool_config': {'npu': {'_target_': 'verl.utils.profiler.config.NPUToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                        'analysis': True,
[36m(TaskRunner pid=2544183)[0m                                                        'contents': [],
[36m(TaskRunner pid=2544183)[0m                                                        'discrete': False,
[36m(TaskRunner pid=2544183)[0m                                                        'level': 'level0'},
[36m(TaskRunner pid=2544183)[0m                                                'nsys': {'_target_': 'verl.utils.profiler.config.NsightToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                         'discrete': False},
[36m(TaskRunner pid=2544183)[0m                                                'torch': {'_target_': 'verl.utils.profiler.config.TorchProfilerToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                          'step_end': None,
[36m(TaskRunner pid=2544183)[0m                                                          'step_start': 0},
[36m(TaskRunner pid=2544183)[0m                                                'torch_memory': {'_target_': 'verl.utils.profiler.config.TorchMemoryToolConfig',
[36m(TaskRunner pid=2544183)[0m                                                                 'stack_depth': 32,
[36m(TaskRunner pid=2544183)[0m                                                                 'trace_alloc_max_entries': 100000}}},
[36m(TaskRunner pid=2544183)[0m                   'reward_loop_class_name': None,
[36m(TaskRunner pid=2544183)[0m                   'reward_loop_module_path': None,
[36m(TaskRunner pid=2544183)[0m                   'reward_loop_source': 'register',
[36m(TaskRunner pid=2544183)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=2544183)[0m                   'rollout': {'_target_': 'verl.workers.config.RolloutConfig',
[36m(TaskRunner pid=2544183)[0m                               'cudagraph_capture_sizes': None,
[36m(TaskRunner pid=2544183)[0m                               'data_parallel_size': 1,
[36m(TaskRunner pid=2544183)[0m                               'disable_log_stats': True,
[36m(TaskRunner pid=2544183)[0m                               'dtype': 'bfloat16',
[36m(TaskRunner pid=2544183)[0m                               'enable_chunked_prefill': True,
[36m(TaskRunner pid=2544183)[0m                               'enable_prefix_caching': True,
[36m(TaskRunner pid=2544183)[0m                               'enforce_eager': True,
[36m(TaskRunner pid=2544183)[0m                               'engine_kwargs': {},
[36m(TaskRunner pid=2544183)[0m                               'expert_parallel_size': 1,
[36m(TaskRunner pid=2544183)[0m                               'free_cache_engine': True,
[36m(TaskRunner pid=2544183)[0m                               'gpu_memory_utilization': 0.5,
[36m(TaskRunner pid=2544183)[0m                               'limit_images': None,
[36m(TaskRunner pid=2544183)[0m                               'load_format': 'auto',
[36m(TaskRunner pid=2544183)[0m                               'max_model_len': None,
[36m(TaskRunner pid=2544183)[0m                               'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=2544183)[0m                               'max_num_seqs': 1024,
[36m(TaskRunner pid=2544183)[0m                               'name': '???',
[36m(TaskRunner pid=2544183)[0m                               'prompt_length': 2048,
[36m(TaskRunner pid=2544183)[0m                               'response_length': 2048,
[36m(TaskRunner pid=2544183)[0m                               'skip_tokenizer_init': False,
[36m(TaskRunner pid=2544183)[0m                               'tensor_model_parallel_size': 2},
[36m(TaskRunner pid=2544183)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=2544183)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=2544183)[0m                                      'url': None},
[36m(TaskRunner pid=2544183)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=2544183)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2544183)[0m                   'use_dynamic_bsz': False,
[36m(TaskRunner pid=2544183)[0m                   'use_reward_loop': True},
[36m(TaskRunner pid=2544183)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=2544183)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=2544183)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=2544183)[0m              'default_local_dir': 'checkpoints/gsm8k_async_rl/qwen2.5-0.5b_function_rm-gsm8k-sgl-multi-w-interaction-n8',
[36m(TaskRunner pid=2544183)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=2544183)[0m              'device': 'cuda',
[36m(TaskRunner pid=2544183)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=2544183)[0m              'experiment_name': 'qwen2.5-0.5b_function_rm-gsm8k-sgl-multi-w-interaction-n8',
[36m(TaskRunner pid=2544183)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=2544183)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=2544183)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=2544183)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=2544183)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=2544183)[0m              'nnodes': 1,
[36m(TaskRunner pid=2544183)[0m              'project_name': 'gsm8k_async_rl',
[36m(TaskRunner pid=2544183)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=2544183)[0m              'resume_from_path': None,
[36m(TaskRunner pid=2544183)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=2544183)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=2544183)[0m              'save_freq': -1,
[36m(TaskRunner pid=2544183)[0m              'test_freq': 20,
[36m(TaskRunner pid=2544183)[0m              'total_epochs': 15,
[36m(TaskRunner pid=2544183)[0m              'total_training_steps': None,
[36m(TaskRunner pid=2544183)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=2544183)[0m              'val_before_train': True,
[36m(TaskRunner pid=2544183)[0m              'val_only': False,
[36m(TaskRunner pid=2544183)[0m              'validation_data_dir': None},
[36m(TaskRunner pid=2544183)[0m  'transfer_queue': {'enable': False}}
[36m(TaskRunner pid=2544183)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=2544183)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=2544183)[0m dataset len: 7473
[36m(TaskRunner pid=2544183)[0m filter dataset len: 7473
[36m(TaskRunner pid=2544183)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=2544183)[0m dataset len: 1319
[36m(TaskRunner pid=2544183)[0m filter dataset len: 1319
[36m(TaskRunner pid=2544183)[0m Size of train dataloader: 14, Size of val dataloader: 1
[36m(TaskRunner pid=2544183)[0m Total training steps: 210
[36m(TaskRunner pid=2544183)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(TaskRunner pid=2544183)[0m bind role actor_rollout method chat_completion to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/multiprocess/process.py", line 314, in _bootstrap
[36m(TaskRunner pid=2544183)[0m     self.run()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/multiprocess/process.py", line 108, in run
[36m(TaskRunner pid=2544183)[0m     self._target(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/multiprocess/managers.py", line 599, in _run_server
[36m(TaskRunner pid=2544183)[0m     server.serve_forever()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/multiprocess/managers.py", line 184, in serve_forever
[36m(TaskRunner pid=2544183)[0m     sys.exit(0)
[36m(TaskRunner pid=2544183)[0m SystemExit: 0
[36m(TaskRunner pid=2544183)[0m 
[36m(TaskRunner pid=2544183)[0m During handling of the above exception, another exception occurred:
[36m(TaskRunner pid=2544183)[0m 
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/multiprocess/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/multiprocess/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/multiprocess/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076857b4b70000050c'
[36m(TaskRunner pid=2544183)[0m Filtering prompts longer than 1024 tokens (num_proc=1): 100%|██████████| 1319/1319 [00:01<00:00, 948.95 examples/s] 
[36m(TaskRunner pid=2544183)[0m /project/peilab/qjl/CODE/verl/verl/trainer/ppo/ray_trainer.py:335: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=2544183)[0m   self.use_critic = need_critic(self.config)
[36m(pid=2557535)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=2557535)[0m   import pynvml  # type: ignore[import]
[36m(WorkerDict pid=2557534)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(WorkerDict pid=2557534)[0m Flash Attention 2 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen3VLForConditionalGeneration is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", dtype=torch.float16)`
[36m(WorkerDict pid=2557534)[0m Flash Attention 2 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen3VLModel is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", dtype=torch.float16)`
[36m(WorkerDict pid=2557534)[0m Flash Attention 2 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen3VLVisionModel is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", dtype=torch.float16)`
[36m(pid=2557546)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(pid=2557546)[0m   import pynvml  # type: ignore[import][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2557534)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=2557546)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:04<00:04,  4.39s/it]
[36m(WorkerDict pid=2557544)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2557544)[0m Flash Attention 2 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen3VLTextModel is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", dtype=torch.float16)`[32m [repeated 29x across cluster][0m
[36m(WorkerDict pid=2557545)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2557546)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  3.96s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:08<00:00,  4.02s/it]
[36m(WorkerDict pid=2557533)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:05<00:05,  5.15s/it][32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2544183)[0m bind role actor_rollout method generate to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=2544183)[0m bind role actor_rollout method get_zeromq_address to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=2544183)[0m bind role actor_rollout method sleep to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(TaskRunner pid=2544183)[0m bind role actor_rollout method wake_up to class <class 'verl.single_controller.ray.base.create_colocated_worker_cls.<locals>.WorkerDict'>
[36m(WorkerDict pid=2557535)[0m [Gloo] Rank 2 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[36m(WorkerDict pid=2557533)[0m reference model: /project/peilab/qjl/MODEL/Qwen3-VL-4B-Instruct
[36m(WorkerDict pid=2557533)[0m Model config after override: Qwen3VLConfig {
[36m(WorkerDict pid=2557533)[0m   "architectures": [
[36m(WorkerDict pid=2557533)[0m     "Qwen3VLForConditionalGeneration"
[36m(WorkerDict pid=2557533)[0m   ],
[36m(WorkerDict pid=2557533)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=2557533)[0m   "image_token_id": 151655,
[36m(WorkerDict pid=2557533)[0m   "model_type": "qwen3_vl",
[36m(WorkerDict pid=2557533)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=2557533)[0m   "text_config": {
[36m(WorkerDict pid=2557533)[0m     "attention_bias": false,
[36m(WorkerDict pid=2557533)[0m     "attention_dropout": 0.0,
[36m(WorkerDict pid=2557533)[0m     "bos_token_id": 151643,
[36m(WorkerDict pid=2557533)[0m     "dtype": "bfloat16",
[36m(WorkerDict pid=2557533)[0m     "eos_token_id": 151645,
[36m(WorkerDict pid=2557533)[0m     "head_dim": 128,
[36m(WorkerDict pid=2557533)[0m     "hidden_act": "silu",
[36m(WorkerDict pid=2557533)[0m     "hidden_size": 2560,
[36m(WorkerDict pid=2557533)[0m     "initializer_range": 0.02,
[36m(WorkerDict pid=2557533)[0m     "intermediate_size": 9728,
[36m(WorkerDict pid=2557533)[0m     "max_position_embeddings": 262144,
[36m(WorkerDict pid=2557533)[0m     "model_type": "qwen3_vl_text",
[36m(WorkerDict pid=2557533)[0m     "num_attention_heads": 32,
[36m(WorkerDict pid=2557533)[0m     "num_hidden_layers": 36,
[36m(WorkerDict pid=2557533)[0m     "num_key_value_heads": 8,
[36m(WorkerDict pid=2557533)[0m     "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=2557533)[0m     "rope_scaling": {
[36m(WorkerDict pid=2557533)[0m       "mrope_interleaved": true,
[36m(WorkerDict pid=2557533)[0m       "mrope_section": [
[36m(WorkerDict pid=2557533)[0m         24,
[36m(WorkerDict pid=2557533)[0m         20,
[36m(WorkerDict pid=2557533)[0m         20
[36m(WorkerDict pid=2557533)[0m       ],
[36m(WorkerDict pid=2557533)[0m       "rope_type": "default"
[36m(WorkerDict pid=2557533)[0m     },
[36m(WorkerDict pid=2557533)[0m     "rope_theta": 5000000,
[36m(WorkerDict pid=2557533)[0m     "tie_word_embeddings": true,
[36m(WorkerDict pid=2557533)[0m     "use_cache": true,
[36m(WorkerDict pid=2557533)[0m     "vocab_size": 151936
[36m(WorkerDict pid=2557533)[0m   },
[36m(WorkerDict pid=2557533)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=2557533)[0m   "transformers_version": "4.57.3",
[36m(WorkerDict pid=2557533)[0m   "video_token_id": 151656,
[36m(WorkerDict pid=2557533)[0m   "vision_config": {
[36m(WorkerDict pid=2557533)[0m     "deepstack_visual_indexes": [
[36m(WorkerDict pid=2557533)[0m       5,
[36m(WorkerDict pid=2557533)[0m       11,
[36m(WorkerDict pid=2557533)[0m       17
[36m(WorkerDict pid=2557533)[0m     ],
[36m(WorkerDict pid=2557533)[0m     "depth": 24,
[36m(WorkerDict pid=2557533)[0m     "hidden_act": "gelu_pytorch_tanh",
[36m(WorkerDict pid=2557533)[0m     "hidden_size": 1024,
[36m(WorkerDict pid=2557533)[0m     "in_channels": 3,
[36m(WorkerDict pid=2557533)[0m     "initializer_range": 0.02,
[36m(WorkerDict pid=2557533)[0m     "intermediate_size": 4096,
[36m(WorkerDict pid=2557533)[0m     "model_type": "qwen3_vl",
[36m(WorkerDict pid=2557533)[0m     "num_heads": 16,
[36m(WorkerDict pid=2557533)[0m     "num_position_embeddings": 2304,
[36m(WorkerDict pid=2557533)[0m     "out_hidden_size": 2560,
[36m(WorkerDict pid=2557533)[0m     "patch_size": 16,
[36m(WorkerDict pid=2557533)[0m     "spatial_merge_size": 2,
[36m(WorkerDict pid=2557533)[0m     "temporal_patch_size": 2
[36m(WorkerDict pid=2557533)[0m   },
[36m(WorkerDict pid=2557533)[0m   "vision_end_token_id": 151653,
[36m(WorkerDict pid=2557533)[0m   "vision_start_token_id": 151652
[36m(WorkerDict pid=2557533)[0m }
[36m(WorkerDict pid=2557533)[0m 
[36m(WorkerDict pid=2557545)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. 
[36m(WorkerDict pid=2557539)[0m [Gloo] Rank 3 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2557546)[0m Monkey patch Qwen3VLForConditionalGeneration model forward
[36m(WorkerDict pid=2557546)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=2557546)[0m Skipping monkey patch for Qwen3VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=2557533)[0m Qwen3VLForConditionalGeneration contains 4.44B parameters
[36m(WorkerDict pid=2557533)[0m wrap_policy: functools.partial(<function _or_policy at 0x1524e7b5d120>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x1524e7b5d000>, transformer_layer_cls={<class 'transformers.models.qwen3_vl.modeling_qwen3_vl.Qwen3VLVisionBlock'>, <class 'transformers.models.qwen3_vl.modeling_qwen3_vl.Qwen3VLTextDecoderLayer'>})])
[36m(WorkerDict pid=2557533)[0m Ref use_remove_padding=True
[36m(WorkerDict pid=2557533)[0m Ref use_fused_kernels=False
[36m(WorkerDict pid=2557533)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. [32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2557533)[0m Monkey patch Qwen3VLForConditionalGeneration model forward[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2557533)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2557533)[0m Skipping monkey patch for Qwen3VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2557533)[0m Model config after override: Qwen3VLConfig {
[36m(WorkerDict pid=2557533)[0m   "architectures": [
[36m(WorkerDict pid=2557533)[0m     "Qwen3VLForConditionalGeneration"
[36m(WorkerDict pid=2557533)[0m   ],
[36m(WorkerDict pid=2557533)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=2557533)[0m   "image_token_id": 151655,
[36m(WorkerDict pid=2557533)[0m   "model_type": "qwen3_vl",
[36m(WorkerDict pid=2557533)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=2557533)[0m   "text_config": {
[36m(WorkerDict pid=2557533)[0m     "attention_bias": false,
[36m(WorkerDict pid=2557533)[0m     "attention_dropout": 0.0,
[36m(WorkerDict pid=2557533)[0m     "bos_token_id": 151643,
[36m(WorkerDict pid=2557533)[0m     "dtype": "bfloat16",
[36m(WorkerDict pid=2557533)[0m     "eos_token_id": 151645,
[36m(WorkerDict pid=2557533)[0m     "head_dim": 128,
[36m(WorkerDict pid=2557533)[0m     "hidden_act": "silu",
[36m(WorkerDict pid=2557533)[0m     "hidden_size": 2560,
[36m(WorkerDict pid=2557533)[0m     "initializer_range": 0.02,
[36m(WorkerDict pid=2557533)[0m     "intermediate_size": 9728,
[36m(WorkerDict pid=2557533)[0m     "max_position_embeddings": 262144,
[36m(WorkerDict pid=2557533)[0m     "model_type": "qwen3_vl_text",
[36m(WorkerDict pid=2557533)[0m     "num_attention_heads": 32,
[36m(WorkerDict pid=2557533)[0m     "num_hidden_layers": 36,
[36m(WorkerDict pid=2557533)[0m     "num_key_value_heads": 8,
[36m(WorkerDict pid=2557533)[0m     "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=2557543)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=2557535)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.54s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.63s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2557546)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=2557543)[0m /project/peilab/qjl/CODE/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(WorkerDict pid=2557543)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(WorkerDict pid=2557535)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:678: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=2557535)[0m   warnings.warn(
[36m(WorkerDict pid=2557539)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00, 13.54it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00, 13.52it/s][32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=2557545)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 6x across cluster][0m
[36m(TaskRunner pid=2544183)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/sglang/srt/layers/quantization/awq.py:62: UserWarning: Only CUDA and HIP support AWQ currently.
[36m(TaskRunner pid=2544183)[0m   warnings.warn(f"Only CUDA and HIP support AWQ currently.")
[36m(WorkerDict pid=2557544)[0m /project/peilab/qjl/CODE/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2557544)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2544183)[0m W1229 23:48:46.550000 2544183 site-packages/torch/utils/cpp_extension.py:118] No CUDA runtime is found, using CUDA_HOME='/home/hzhangex/anaconda3/envs/a2po'
[36m(pid=2559813)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=2559813)[0m   import pynvml  # type: ignore[import]
[36m(WorkerDict pid=2557544)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:678: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2557544)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=2559816)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(TaskRunner pid=2544183)[0m /project/peilab/qjl/CODE/verl/verl/utils/profiler/config.py:49: UserWarning: Torch profiler tool config is not fully supported now.
[36m(TaskRunner pid=2544183)[0m   warnings.warn("Torch profiler tool config is not fully supported now.", stacklevel=1)
[36m(pid=2559818)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 7x across cluster][0m
[36m(pid=2559818)[0m   import pynvml  # type: ignore[import][32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=2559818)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=2559812)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 14x across cluster][0m
[36m(SGLangHttpServer pid=2559812)[0m   import pynvml  # type: ignore[import][32m [repeated 14x across cluster][0m
[36m(SGLangHttpServer pid=2559816)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(SGLangHttpServer pid=2559818)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 2x across cluster][0m
[36m(SGLangHttpServer pid=2559818)[0m   import pynvml  # type: ignore[import][32m [repeated 2x across cluster][0m
[36m(SGLangHttpServer pid=2559816)[0m [W1229 23:49:19.492340852 ProcessGroupNCCL.cpp:981] Warning: TORCH_NCCL_AVOID_RECORD_STREAMS is the default now, this environment variable is thus deprecated. (function operator())
[36m(SGLangHttpServer pid=2559810)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(SGLangHttpServer pid=2559818)[0m [W1229 23:49:23.571645087 ProcessGroupNCCL.cpp:981] Warning: TORCH_NCCL_AVOID_RECORD_STREAMS is the default now, this environment variable is thus deprecated. (function operator())[32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=2559816)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=2559816)[0m   0%|          | 0/23 [00:00<?, ?it/s]Capturing batches (bs=160 avail_mem=20.16 GB):   0%|          | 0/23 [00:00<?, ?it/s]
[36m(SGLangHttpServer pid=2559816)[0m Capturing batches (bs=160 avail_mem=20.16 GB):   4%|▍         | 1/23 [00:00<00:11,  1.90it/s]Capturing batches (bs=152 avail_mem=20.00 GB):   4%|▍         | 1/23 [00:00<00:11,  1.90it/s]
[36m(SGLangHttpServer pid=2559816)[0m Capturing batches (bs=152 avail_mem=20.00 GB):   9%|▊         | 2/23 [00:00<00:06,  3.19it/s]Capturing batches (bs=144 avail_mem=19.98 GB):   9%|▊         | 2/23 [00:00<00:06,  3.19it/s]
[36m(SGLangHttpServer pid=2559816)[0m Capturing batches (bs=144 avail_mem=19.98 GB):  13%|█▎        | 3/23 [00:00<00:04,  4.24it/s]Capturing batches (bs=136 avail_mem=19.96 GB):  13%|█▎        | 3/23 [00:00<00:04,  4.24it/s]
[36m(SGLangHttpServer pid=2559816)[0m Capturing batches (bs=136 avail_mem=19.96 GB):  17%|█▋        | 4/23 [00:00<00:03,  5.21it/s]Capturing batches (bs=128 avail_mem=19.93 GB):  17%|█▋        | 4/23 [00:00<00:03,  5.21it/s]
[36m(SGLangHttpServer pid=2559816)[0m Capturing batches (bs=128 avail_mem=19.93 GB):  22%|██▏       | 5/23 [00:01<00:03,  5.74it/s]Capturing batches (bs=120 avail_mem=19.91 GB):  22%|██▏       | 5/23 [00:01<00:03,  5.74it/s]
[36m(SGLangHttpServer pid=2559816)[0m Capturing batches (bs=4 avail_mem=19.58 GB):  91%|█████████▏| 21/23 [00:03<00:00,  6.64it/s]Capturing batches (bs=2 avail_mem=19.56 GB):  91%|█████████▏| 21/23 [00:03<00:00,  6.64it/s]
[36m(SGLangHttpServer pid=2559816)[0m Capturing batches (bs=2 avail_mem=19.56 GB):  96%|█████████▌| 22/23 [00:03<00:00,  6.87it/s]Capturing batches (bs=1 avail_mem=19.54 GB):  96%|█████████▌| 22/23 [00:03<00:00,  6.87it/s]
[36m(SGLangHttpServer pid=2559816)[0m Capturing batches (bs=1 avail_mem=19.54 GB): 100%|██████████| 23/23 [00:03<00:00,  7.44it/s]Capturing batches (bs=1 avail_mem=19.54 GB): 100%|██████████| 23/23 [00:03<00:00,  6.25it/s]
[36m(SGLangHttpServer pid=2559812)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=2559812)[0m   0%|          | 0/23 [00:00<?, ?it/s]Capturing batches (bs=160 avail_mem=20.16 GB):   0%|          | 0/23 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=2559813)[0m Capturing batches (bs=8 avail_mem=19.60 GB):  87%|████████▋ | 20/23 [00:03<00:00,  7.16it/s]Capturing batches (bs=4 avail_mem=19.58 GB):  87%|████████▋ | 20/23 [00:03<00:00,  7.16it/s][32m [repeated 92x across cluster][0m
[36m(SGLangHttpServer pid=2559815)[0m Capturing batches (bs=4 avail_mem=19.58 GB):  91%|█████████▏| 21/23 [00:03<00:00,  7.34it/s]Capturing batches (bs=2 avail_mem=19.56 GB):  91%|█████████▏| 21/23 [00:03<00:00,  7.34it/s]Capturing batches (bs=2 avail_mem=19.56 GB):  96%|█████████▌| 22/23 [00:03<00:00,  7.61it/s]Capturing batches (bs=1 avail_mem=19.54 GB):  96%|█████████▌| 22/23 [00:03<00:00,  7.61it/s]
[36m(SGLangHttpServer pid=2559812)[0m Capturing batches (bs=1 avail_mem=19.54 GB): 100%|██████████| 23/23 [00:03<00:00,  6.44it/s]Capturing batches (bs=1 avail_mem=19.54 GB): 100%|██████████| 23/23 [00:03<00:00,  6.16it/s][32m [repeated 19x across cluster][0m
[36m(WorkerDict pid=2557544)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(WorkerDict pid=2557539)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(SGLangHttpServer pid=2559819)[0m Capturing batches (bs=8 avail_mem=19.60 GB):  87%|████████▋ | 20/23 [00:03<00:00,  6.07it/s]Capturing batches (bs=4 avail_mem=19.58 GB):  87%|████████▋ | 20/23 [00:03<00:00,  6.07it/s][32m [repeated 63x across cluster][0m
[36m(pid=2562957)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=2562957)[0m   import pynvml  # type: ignore[import]
[36m(AgentLoopWorker pid=2562957)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/sglang/srt/layers/quantization/awq.py:62: UserWarning: Only CUDA and HIP support AWQ currently.
[36m(AgentLoopWorker pid=2562957)[0m   warnings.warn(f"Only CUDA and HIP support AWQ currently.")
[36m(WorkerDict pid=2557543)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 6x across cluster][0m
[36m(pid=2562956)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 7x across cluster][0m
[36m(pid=2562956)[0m   import pynvml  # type: ignore[import][32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2544183)[0m wandb: Currently logged in as: royaltobe (royaltobe-beijing-institute-of-technology) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[36m(AgentLoopWorker pid=2562957)[0m W1229 23:50:19.321000 2562957 site-packages/torch/utils/cpp_extension.py:118] No CUDA runtime is found, using CUDA_HOME='/home/hzhangex/anaconda3/envs/a2po'
[36m(TaskRunner pid=2544183)[0m wandb: setting up run 2cnefinq
[36m(TaskRunner pid=2544183)[0m wandb: Tracking run with wandb version 0.22.3
[36m(TaskRunner pid=2544183)[0m wandb: Run data is saved locally in /project/peilab/qjl/CODE/verl/wandb/run-20251229_235018-2cnefinq
[36m(TaskRunner pid=2544183)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(TaskRunner pid=2544183)[0m wandb: Syncing run qwen2.5-0.5b_function_rm-gsm8k-sgl-multi-w-interaction-n8
[36m(TaskRunner pid=2544183)[0m wandb: ⭐️ View project at https://wandb.ai/royaltobe-beijing-institute-of-technology/gsm8k_async_rl
[36m(TaskRunner pid=2544183)[0m wandb: 🚀 View run at https://wandb.ai/royaltobe-beijing-institute-of-technology/gsm8k_async_rl/runs/2cnefinq
[36m(TaskRunner pid=2544183)[0m wandb: Detected [openai] in use.
[36m(TaskRunner pid=2544183)[0m wandb: Use W&B Weave for improved LLM call tracing. Install Weave with `pip install weave` then add `import weave` to the top of your script.
[36m(TaskRunner pid=2544183)[0m wandb: For more information, check out the docs at: https://weave-docs.wandb.ai/
[36m(AgentLoopWorker pid=2562959)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/sglang/srt/layers/quantization/awq.py:62: UserWarning: Only CUDA and HIP support AWQ currently.[32m [repeated 4x across cluster][0m
[36m(AgentLoopWorker pid=2562959)[0m   warnings.warn(f"Only CUDA and HIP support AWQ currently.")[32m [repeated 4x across cluster][0m
[36m(AgentLoopWorker pid=2562958)[0m W1229 23:50:24.552000 2562958 site-packages/torch/utils/cpp_extension.py:118] No CUDA runtime is found, using CUDA_HOME='/home/hzhangex/anaconda3/envs/a2po'[32m [repeated 2x across cluster][0m
[36m(pid=2564567)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=2564567)[0m   import pynvml  # type: ignore[import]
[36m(AgentLoopWorker pid=2562956)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/sglang/srt/layers/quantization/awq.py:62: UserWarning: Only CUDA and HIP support AWQ currently.[32m [repeated 3x across cluster][0m
[36m(AgentLoopWorker pid=2562956)[0m   warnings.warn(f"Only CUDA and HIP support AWQ currently.")[32m [repeated 3x across cluster][0m
[36m(AgentLoopWorker pid=2562956)[0m W1229 23:50:25.621000 2562956 site-packages/torch/utils/cpp_extension.py:118] No CUDA runtime is found, using CUDA_HOME='/home/hzhangex/anaconda3/envs/a2po'[32m [repeated 5x across cluster][0m
[36m(pid=2564990)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 2x across cluster][0m
[36m(pid=2564990)[0m   import pynvml  # type: ignore[import][32m [repeated 2x across cluster][0m
[36m(SGLangHttpServer pid=2559813)[0m nvcc warning : incompatible redefinition for option 'compiler-bindir', the last value of this option was used
[36m(pid=2565282)[0m /home/hzhangex/anaconda3/envs/a2po/lib/python3.10/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 5x across cluster][0m
[36m(pid=2565282)[0m   import pynvml  # type: ignore[import][32m [repeated 5x across cluster][0m
[36m(AgentLoopWorker pid=2562961)[0m You're using a Qwen2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076ad335620000056e'
[36m(SGLangHttpServer pid=2559810)[0m nvcc warning : incompatible redefinition for option 'compiler-bindir', the last value of this option was used[32m [repeated 7x across cluster][0m
[36m(AgentLoopWorker pid=2562963)[0m You're using a Qwen2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2557533)[0m     "rope_scaling": {
[36m(WorkerDict pid=2557533)[0m       "mrope_interleaved": true,
[36m(WorkerDict pid=2557533)[0m       "mrope_section": [
[36m(WorkerDict pid=2557533)[0m         24,
[36m(WorkerDict pid=2557533)[0m         20,
[36m(WorkerDict pid=2557533)[0m         20
[36m(WorkerDict pid=2557533)[0m       ],
[36m(WorkerDict pid=2557533)[0m       "rope_type": "default"
[36m(WorkerDict pid=2557533)[0m     },
[36m(WorkerDict pid=2557533)[0m     "rope_theta": 5000000,
[36m(WorkerDict pid=2557533)[0m     "tie_word_embeddings": true,
[36m(WorkerDict pid=2557533)[0m     "use_cache": true,
[36m(WorkerDict pid=2557533)[0m     "vocab_size": 151936
[36m(WorkerDict pid=2557533)[0m   },
[36m(WorkerDict pid=2557533)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=2557533)[0m   "transformers_version": "4.57.3",
[36m(WorkerDict pid=2557533)[0m   "video_token_id": 151656,
[36m(WorkerDict pid=2557533)[0m   "vision_config": {
[36m(WorkerDict pid=2557533)[0m     "deepstack_visual_indexes": [
[36m(WorkerDict pid=2557533)[0m       5,
[36m(WorkerDict pid=2557533)[0m       11,
[36m(WorkerDict pid=2557533)[0m       17
[36m(WorkerDict pid=2557533)[0m     ],
[36m(WorkerDict pid=2557533)[0m     "depth": 24,
[36m(WorkerDict pid=2557533)[0m     "hidden_act": "gelu_pytorch_tanh",
[36m(WorkerDict pid=2557533)[0m     "hidden_size": 1024,
[36m(WorkerDict pid=2557533)[0m     "in_channels": 3,
[36m(WorkerDict pid=2557533)[0m     "initializer_range": 0.02,
[36m(WorkerDict pid=2557533)[0m     "intermediate_size": 4096,
[36m(WorkerDict pid=2557533)[0m     "model_type": "qwen3_vl",
[36m(WorkerDict pid=2557533)[0m     "num_heads": 16,
[36m(WorkerDict pid=2557533)[0m     "num_position_embeddings": 2304,
[36m(WorkerDict pid=2557533)[0m     "out_hidden_size": 2560,
[36m(WorkerDict pid=2557533)[0m     "patch_size": 16,
[36m(WorkerDict pid=2557533)[0m     "spatial_merge_size": 2,
[36m(WorkerDict pid=2557533)[0m     "temporal_patch_size": 2
[36m(WorkerDict pid=2557533)[0m   },
[36m(WorkerDict pid=2557533)[0m   "vision_end_token_id": 151653,
[36m(WorkerDict pid=2557533)[0m   "vision_start_token_id": 151652
[36m(WorkerDict pid=2557533)[0m }
[36m(WorkerDict pid=2557533)[0m 
[36m(WorkerDict pid=2557533)[0m Qwen3VLForConditionalGeneration contains 4.44B parameters
[36m(WorkerDict pid=2557533)[0m wrap_policy: functools.partial(<function _or_policy at 0x1524e7b5d120>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x1524e7b5d000>, transformer_layer_cls={<class 'transformers.models.qwen3_vl.modeling_qwen3_vl.Qwen3VLVisionBlock'>, <class 'transformers.models.qwen3_vl.modeling_qwen3_vl.Qwen3VLTextDecoderLayer'>})])
[36m(WorkerDict pid=2557533)[0m Total steps: 210, num_warmup_steps: 0
[36m(WorkerDict pid=2557533)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=2557533)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=2557535)[0m 
[36m(WorkerDict pid=2557535)[0m [2025-12-29 23:48:27] dgx-10:2557535:2559202 [0] transport/net_ib.cc:587 NCCL WARN NET/IB : Attempted to merge incompatible devices: [1]mlx5_1:1/IB and [2]mlx5_2:1/RoCE. Try selecting NICs of only one link type using NCCL_IB_HCA
[36m(WorkerDict pid=2557535)[0m 
[36m(WorkerDict pid=2557535)[0m [2025-12-29 23:48:27] dgx-10:2557535:2559202 [0] transport/net_ib.cc:587 NCCL WARN NET/IB : Attempted to merge incompatible devices: [7]mlx5_7:1/IB and [8]mlx5_8:1/RoCE. Try selecting NICs of only one link type using NCCL_IB_HCA
[36m(WorkerDict pid=2557535)[0m [Gloo] Rank 2 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[36m(WorkerDict pid=2557535)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=2557535)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(WorkerDict pid=2557539)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. [32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=2557539)[0m Monkey patch Qwen3VLForConditionalGeneration model forward[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=2557539)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=2557539)[0m Skipping monkey patch for Qwen3VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=2557534)[0m 
[36m(WorkerDict pid=2557534)[0m 
[36m(WorkerDict pid=2557533)[0m NCCL version 2.27.3+cuda12.9
[36m(WorkerDict pid=2557533)[0m 
[36m(WorkerDict pid=2557533)[0m 
[36m(WorkerDict pid=2557544)[0m 
[36m(WorkerDict pid=2557544)[0m 
[36m(WorkerDict pid=2557543)[0m 
[36m(WorkerDict pid=2557543)[0m 
[36m(WorkerDict pid=2557545)[0m 
[36m(WorkerDict pid=2557545)[0m 
[36m(WorkerDict pid=2557546)[0m 
[36m(WorkerDict pid=2557546)[0m 
[36m(WorkerDict pid=2557539)[0m 
[36m(WorkerDict pid=2557539)[0m 
[36m(WorkerDict pid=2557535)[0m All deep_gemm operations loaded successfully!
[36m(WorkerDict pid=2557539)[0m [2025-12-29 23:48:27] dgx-10:2557539:2559205 [0] transport/net_ib.cc:587 NCCL WARN NET/IB : Attempted to merge incompatible devices: [7]mlx5_7:1/IB and [8]mlx5_8:1/RoCE. Try selecting NICs of only one link type using NCCL_IB_HCA[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=2557539)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 21x across cluster][0m
[36m(pid=2559817)[0m All deep_gemm operations loaded successfully![32m [repeated 8x across cluster][0m
[36m(SGLangHttpServer pid=2559810)[0m SGLang http server: rollout_mode=<RolloutMode.HYBRID: 'hybrid'>, replica_rank=7, node_rank=0, nnodes=1, cuda_visible_devices='7'
[36m(SGLangHttpServer pid=2559816)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 4x across cluster][0m
[36m(pid=2559818)[0m All deep_gemm operations loaded successfully![32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=2559818)[0m SGLang http server: rollout_mode=<RolloutMode.HYBRID: 'hybrid'>, replica_rank=5, node_rank=0, nnodes=1, cuda_visible_devices='5'[32m [repeated 7x across cluster][0m
[36m(SGLangHttpServer pid=2559818)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 28x across cluster][0m
[36m(SGLangHttpServer pid=2559816)[0m All deep_gemm operations loaded successfully!
[36m(SGLangHttpServer pid=2559810)[0m All deep_gemm operations loaded successfully!
[36m(TaskRunner pid=2544183)[0m AgentLoopManager: ['10.22.4.84:44285', '10.22.4.84:44685', '10.22.4.84:33273', '10.22.4.84:36627', '10.22.4.84:34607', '10.22.4.84:39517', '10.22.4.84:46667', '10.22.4.84:40509']
[36m(SGLangHttpServer pid=2559812)[0m All deep_gemm operations loaded successfully![32m [repeated 6x across cluster][0m
[36m(TaskRunner pid=2544183)[0m Checkpoint tracker file does not exist: /project/peilab/qjl/CODE/verl/checkpoints/gsm8k_async_rl/qwen2.5-0.5b_function_rm-gsm8k-sgl-multi-w-interaction-n8/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=2544183)[0m Training from scratch
[36m(TaskRunner pid=2544183)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 0}
[36m(TaskRunner pid=2544183)[0m validation generation end
[36m(TaskRunner pid=2544183)[0m ("Initial validation metrics: {'val-aux/openai/gsm8k/reward/mean@1': "
[36m(TaskRunner pid=2544183)[0m  "0.07505686125852919, 'val-core/openai/gsm8k/acc/mean@1': "
[36m(TaskRunner pid=2544183)[0m  "0.07505686125852919, 'val-aux/num_turns/min': 2, 'val-aux/num_turns/max': 2, "
[36m(TaskRunner pid=2544183)[0m  "'val-aux/num_turns/mean': 2.0}")
[36m(TaskRunner pid=2544183)[0m Training Progress:   0%|          | 0/210 [00:00<?, ?it/s]
[36m(WorkerDict pid=2557546)[0m nvcc warning : incompatible redefinition for option 'compiler-bindir', the last value of this option was used
[36m(WorkerDict pid=2557539)[0m nvcc warning : incompatible redefinition for option 'compiler-bindir', the last value of this option was used
[36m(TaskRunner pid=2544183)[0m Training Progress:   0%|          | 1/210 [06:39<23:10:33, 399.20s/it]
[36m(WorkerDict pid=2557545)[0m nvcc warning : incompatible redefinition for option 'compiler-bindir', the last value of this option was used[32m [repeated 6x across cluster][0m
[36m(TaskRunner pid=2544183)[0m Training Progress:   1%|          | 2/210 [12:37<21:40:25, 375.12s/it]
[36m(TaskRunner pid=2544183)[0m step:0 - val-aux/openai/gsm8k/reward/mean@1:0.07505686125852919 - val-core/openai/gsm8k/acc/mean@1:0.07505686125852919 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0
[36m(TaskRunner pid=2544183)[0m step:1 - actor/entropy:0.2269759178161621 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:8.265227150694443e-06 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:6.692257777961286e-05 - actor/grad_norm:1.5703125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:26.25554847717285 - perf/max_memory_reserved_gb:33.3359375 - perf/cpu_memory_used_gb:235.46181344985962 - actor/lr:1e-06 - training/global_step:1 - training/epoch:0 - critic/score/mean:0.112060546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.112060546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0037674098275601864 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0037674098275601864 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:277.995849609375 - response_length/max:3072.0 - response_length/min:62.0 - response_length/clip_ratio:0.009521484375 - response_length_non_aborted/mean:277.995849609375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:62.0 - response_length_non_aborted/clip_ratio:0.009521484375 - response/aborted_ratio:0.0 - prompt_length/mean:138.5546875 - prompt_length/max:255.0 - prompt_length/min:98.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.0003809528425335884 - timing_s/agent_loop/generate_sequences/min:1.8677976997569203 - timing_s/agent_loop/generate_sequences/max:65.1155251879245 - timing_s/agent_loop/generate_sequences/mean:22.54661760511965 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:65.1155251879245 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:181 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:82.88688232610002 - timing_s/reward:0.00016297493129968643 - timing_s/old_log_prob:66.25643426412717 - timing_s/ref:62.05875587370247 - timing_s/adv:0.17715479573234916 - timing_s/update_actor:184.9092390667647 - timing_s/step:397.1560000460595 - timing_s/stop_profile:7.466506212949753e-05 - timing_per_token_ms/update_actor:0.10837546269249147 - timing_per_token_ms/adv:0.00010383057684183608 - timing_per_token_ms/ref:0.03637268973620331 - timing_per_token_ms/gen:0.07279265242207804 - perf/total_num_tokens:1706191 - perf/time_per_step:397.1560000460595 - perf/throughput:537.0027771839426
[36m(TaskRunner pid=2544183)[0m step:2 - actor/entropy:0.2821905016899109 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:2.3339930572241485e-05 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.0180865678252076e-05 - actor/grad_norm:2.1875 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:238.21835565567017 - actor/lr:1e-06 - training/global_step:2 - training/epoch:0 - critic/score/mean:0.196044921875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.196044921875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.004429252352565527 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.004429252352565527 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:315.8125 - response_length/max:3072.0 - response_length/min:63.0 - response_length/clip_ratio:0.01708984375 - response_length_non_aborted/mean:315.8125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:63.0 - response_length_non_aborted/clip_ratio:0.01708984375 - response/aborted_ratio:0.0 - prompt_length/mean:137.349609375 - prompt_length/max:248.0 - prompt_length/min:101.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010435516014695168 - timing_s/agent_loop/generate_sequences/min:1.6023242468945682 - timing_s/agent_loop/generate_sequences/max:66.79253680072725 - timing_s/agent_loop/generate_sequences/mean:22.29891332743125 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:66.79253680072725 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:158 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:96.012367377989 - timing_s/reward:0.004303696099668741 - timing_s/old_log_prob:53.545755384955555 - timing_s/ref:52.29809731990099 - timing_s/adv:0.13037287490442395 - timing_s/update_actor:154.7566104591824 - timing_s/step:357.7462636339478 - timing_s/stop_profile:7.863994687795639e-05 - timing_per_token_ms/update_actor:0.0833749663061982 - timing_per_token_ms/adv:7.023825360445909e-05 - timing_per_token_ms/ref:0.028175546679313435 - timing_per_token_ms/gen:0.07422289928166823 - perf/total_num_tokens:1856152 - perf/time_per_step:357.7462636339478 - perf/throughput:648.5574374507119
[36m(TaskRunner pid=2544183)[0m Training Progress:   1%|▏         | 3/210 [18:26<20:53:27, 363.32s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:   2%|▏         | 4/210 [24:15<20:27:49, 357.62s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:   2%|▏         | 5/210 [30:04<20:10:55, 354.42s/it]
[36m(TaskRunner pid=2544183)[0m step:3 - actor/entropy:0.24829012155532837 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:4.4101235068261246e-05 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.0222952707982245e-05 - actor/grad_norm:2.375 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:240.14256191253662 - actor/lr:1e-06 - training/global_step:3 - training/epoch:0 - critic/score/mean:0.340576171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.340576171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:0.001308252103626728 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:0.001308252103626728 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:272.744873046875 - response_length/max:3072.0 - response_length/min:54.0 - response_length/clip_ratio:0.00927734375 - response_length_non_aborted/mean:272.744873046875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:54.0 - response_length_non_aborted/clip_ratio:0.00927734375 - response/aborted_ratio:0.0 - prompt_length/mean:136.14453125 - prompt_length/max:289.0 - prompt_length/min:99.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.000428980216383934 - timing_s/agent_loop/generate_sequences/min:1.0736785060726106 - timing_s/agent_loop/generate_sequences/max:62.59627589723095 - timing_s/agent_loop/generate_sequences/mean:21.430813772735178 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:62.59627589723095 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:178 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:91.87046084273607 - timing_s/reward:0.005340024828910828 - timing_s/old_log_prob:53.557169035542756 - timing_s/ref:56.19780466891825 - timing_s/adv:0.14310162235051394 - timing_s/update_actor:145.7839311300777 - timing_s/step:348.72950467141345 - timing_s/stop_profile:6.438978016376495e-05 - timing_per_token_ms/update_actor:0.08704500455876973 - timing_per_token_ms/adv:8.544344546967624e-05 - timing_per_token_ms/ref:0.033554714334285037 - timing_per_token_ms/gen:0.0822355026461994 - perf/total_num_tokens:1674811 - perf/time_per_step:348.72950467141345 - perf/throughput:600.3259609400101
[36m(TaskRunner pid=2544183)[0m step:4 - actor/entropy:0.236649289727211 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:8.72605960466899e-05 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:1.0270877698559389e-05 - actor/grad_norm:2.171875 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:241.82745170593262 - actor/lr:1e-06 - training/global_step:4 - training/epoch:0 - critic/score/mean:0.4462890625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.4462890625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.027687136083841324 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.027687136083841324 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:276.32666015625 - response_length/max:3072.0 - response_length/min:53.0 - response_length/clip_ratio:0.01123046875 - response_length_non_aborted/mean:276.32666015625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:53.0 - response_length_non_aborted/clip_ratio:0.01123046875 - response/aborted_ratio:0.0 - prompt_length/mean:137.578125 - prompt_length/max:244.0 - prompt_length/min:96.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00011902395635843277 - timing_s/agent_loop/generate_sequences/min:1.9103711070492864 - timing_s/agent_loop/generate_sequences/max:61.76467274921015 - timing_s/agent_loop/generate_sequences/mean:20.92257465887417 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:61.76467274921015 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:134 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:86.60668946569785 - timing_s/reward:0.003507888875901699 - timing_s/old_log_prob:55.678291206713766 - timing_s/ref:52.8698937445879 - timing_s/adv:0.13665420515462756 - timing_s/update_actor:151.69896020600572 - timing_s/step:348.1421749978326 - timing_s/stop_profile:6.455881521105766e-05 - timing_per_token_ms/update_actor:0.08947922392963695 - timing_per_token_ms/adv:8.060511560100578e-05 - timing_per_token_ms/ref:0.03118516471756807 - timing_per_token_ms/gen:0.0765188971754673 - perf/total_num_tokens:1695354 - perf/time_per_step:348.1421749978326 - perf/throughput:608.7146723930225
[36m(TaskRunner pid=2544183)[0m step:5 - actor/entropy:0.22064772248268127 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0001488599912455868 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:6.885454540217495e-05 - actor/grad_norm:1.7578125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:241.68275928497314 - actor/lr:1e-06 - training/global_step:5 - training/epoch:0 - critic/score/mean:0.54931640625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.54931640625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.010234222747385502 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.010234222747385502 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:258.268310546875 - response_length/max:3072.0 - response_length/min:59.0 - response_length/clip_ratio:0.005859375 - response_length_non_aborted/mean:258.268310546875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:59.0 - response_length_non_aborted/clip_ratio:0.005859375 - response/aborted_ratio:0.0 - prompt_length/mean:137.408203125 - prompt_length/max:229.0 - prompt_length/min:99.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:5.922187119722366e-05 - timing_s/agent_loop/generate_sequences/min:1.1987565970048308 - timing_s/agent_loop/generate_sequences/max:60.90164694003761 - timing_s/agent_loop/generate_sequences/mean:20.6902155589612 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:60.90164694003761 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:135 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:84.23241473082453 - timing_s/reward:0.00015949085354804993 - timing_s/old_log_prob:58.68502956489101 - timing_s/ref:53.62054917495698 - timing_s/adv:0.12672036234289408 - timing_s/update_actor:150.57236352795735 - timing_s/step:348.1784766386263 - timing_s/stop_profile:6.43809325993061e-05 - timing_per_token_ms/update_actor:0.09290627487161794 - timing_per_token_ms/adv:7.818909486317507e-05 - timing_per_token_ms/ref:0.03308499225019265 - timing_per_token_ms/gen:0.07962476826559911 - perf/total_num_tokens:1620691 - perf/time_per_step:348.1784766386263 - perf/throughput:581.8463477576299
[36m(TaskRunner pid=2544183)[0m Training Progress:   3%|▎         | 6/210 [36:12<20:20:44, 359.04s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:   3%|▎         | 7/210 [42:09<20:12:44, 358.45s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:   4%|▍         | 8/210 [48:01<19:59:17, 356.22s/it]
[36m(TaskRunner pid=2544183)[0m step:6 - actor/entropy:0.2467300444841385 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00016835125567560283 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:3.511699196678819e-05 - actor/grad_norm:1.03125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:241.8488426208496 - actor/lr:1e-06 - training/global_step:6 - training/epoch:0 - critic/score/mean:0.651611328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.651611328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.043047405779361725 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.043047405779361725 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:274.370361328125 - response_length/max:3072.0 - response_length/min:57.0 - response_length/clip_ratio:0.00927734375 - response_length_non_aborted/mean:274.370361328125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:57.0 - response_length_non_aborted/clip_ratio:0.00927734375 - response/aborted_ratio:0.0 - prompt_length/mean:135.5703125 - prompt_length/max:239.0 - prompt_length/min:97.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00013657519593834877 - timing_s/agent_loop/generate_sequences/min:1.4662337959744036 - timing_s/agent_loop/generate_sequences/max:63.6425233669579 - timing_s/agent_loop/generate_sequences/mean:21.143059208607497 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:63.6425233669579 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:144 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:93.52859932603315 - timing_s/reward:0.005234536714851856 - timing_s/old_log_prob:58.29605121770874 - timing_s/ref:54.03972916677594 - timing_s/adv:0.5742719960398972 - timing_s/update_actor:159.98457311512902 - timing_s/step:367.5187483248301 - timing_s/stop_profile:6.430083885788918e-05 - timing_per_token_ms/update_actor:0.09527899075235914 - timing_per_token_ms/adv:0.0003420083270194377 - timing_per_token_ms/ref:0.032183420909189735 - timing_per_token_ms/gen:0.08322375122553605 - perf/total_num_tokens:1679117 - perf/time_per_step:367.5187483248301 - perf/throughput:571.0990961867606
[36m(TaskRunner pid=2544183)[0m step:7 - actor/entropy:0.21449607610702515 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00021700477298658427 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:7.391053879857168e-05 - actor/grad_norm:0.76953125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:241.80186319351196 - actor/lr:1e-06 - training/global_step:7 - training/epoch:0 - critic/score/mean:0.72607421875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.72607421875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04332355409860611 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04332355409860611 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:255.859130859375 - response_length/max:3072.0 - response_length/min:50.0 - response_length/clip_ratio:0.0087890625 - response_length_non_aborted/mean:255.859130859375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:50.0 - response_length_non_aborted/clip_ratio:0.0087890625 - response/aborted_ratio:0.0 - prompt_length/mean:136.88671875 - prompt_length/max:227.0 - prompt_length/min:102.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:4.6236906200647354e-05 - timing_s/agent_loop/generate_sequences/min:1.4453798197209835 - timing_s/agent_loop/generate_sequences/max:61.350270056165755 - timing_s/agent_loop/generate_sequences/mean:21.17772665056725 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:61.350270056165755 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:224 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:88.03851935081184 - timing_s/reward:0.0001959400251507759 - timing_s/old_log_prob:58.01950160274282 - timing_s/ref:53.82151140877977 - timing_s/adv:0.1684307148680091 - timing_s/update_actor:155.4158725659363 - timing_s/step:356.6726655368693 - timing_s/stop_profile:6.522005423903465e-05 - timing_per_token_ms/update_actor:0.09661038633738962 - timing_per_token_ms/adv:0.00010470073722732209 - timing_per_token_ms/ref:0.0334567951433559 - timing_per_token_ms/gen:0.08400630091327553 - perf/total_num_tokens:1608687 - perf/time_per_step:356.6726655368693 - perf/throughput:563.7826904882727
[36m(TaskRunner pid=2544183)[0m step:8 - actor/entropy:0.23150494694709778 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00023380694448427164 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:3.957116930397575e-05 - actor/grad_norm:0.6953125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:242.15883874893188 - actor/lr:1e-06 - training/global_step:8 - training/epoch:0 - critic/score/mean:0.715576171875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.715576171875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0038067770656198263 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0038067770656198263 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:266.831787109375 - response_length/max:3072.0 - response_length/min:58.0 - response_length/clip_ratio:0.010986328125 - response_length_non_aborted/mean:266.831787109375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:58.0 - response_length_non_aborted/clip_ratio:0.010986328125 - response/aborted_ratio:0.0 - prompt_length/mean:136.556640625 - prompt_length/max:228.0 - prompt_length/min:98.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:5.3233932703733444e-05 - timing_s/agent_loop/generate_sequences/min:1.8093343749642372 - timing_s/agent_loop/generate_sequences/max:63.33592955395579 - timing_s/agent_loop/generate_sequences/mean:20.87511141258142 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:63.33592955395579 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:141 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:90.2239834619686 - timing_s/reward:0.0050412374548614025 - timing_s/old_log_prob:54.289709385018796 - timing_s/ref:52.02631113305688 - timing_s/adv:0.16000306885689497 - timing_s/update_actor:153.3357103932649 - timing_s/step:350.9912315509282 - timing_s/stop_profile:4.3460167944431305e-05 - timing_per_token_ms/update_actor:0.09280255355981944 - timing_per_token_ms/adv:9.68378033352085e-05 - timing_per_token_ms/ref:0.03148760659250458 - timing_per_token_ms/gen:0.08255140795262754 - perf/total_num_tokens:1652279 - perf/time_per_step:350.9912315509282 - perf/throughput:588.4331471398372
[36m(TaskRunner pid=2544183)[0m Training Progress:   4%|▍         | 9/210 [53:57<19:53:41, 356.33s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:   5%|▍         | 10/210 [59:44<19:38:03, 353.42s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:   5%|▌         | 11/210 [1:05:36<19:31:12, 353.13s/it]
[36m(TaskRunner pid=2544183)[0m step:9 - actor/entropy:0.24553538858890533 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0002480688223389649 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:6.94627258468472e-05 - actor/grad_norm:0.6953125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:242.24829769134521 - actor/lr:1e-06 - training/global_step:9 - training/epoch:0 - critic/score/mean:0.7509765625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.7509765625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06263349950313568 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06263349950313568 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:271.199462890625 - response_length/max:3072.0 - response_length/min:54.0 - response_length/clip_ratio:0.012939453125 - response_length_non_aborted/mean:271.199462890625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:54.0 - response_length_non_aborted/clip_ratio:0.012939453125 - response/aborted_ratio:0.0 - prompt_length/mean:136.189453125 - prompt_length/max:271.0 - prompt_length/min:89.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:7.62580893933773e-05 - timing_s/agent_loop/generate_sequences/min:1.29994376283139 - timing_s/agent_loop/generate_sequences/max:63.46907672518864 - timing_s/agent_loop/generate_sequences/mean:20.90819434261789 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:63.46907672518864 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:146 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:89.44511266006157 - timing_s/reward:0.00018231011927127838 - timing_s/old_log_prob:59.244791550096124 - timing_s/ref:54.279072558972985 - timing_s/adv:0.15252602798864245 - timing_s/update_actor:151.15786747867242 - timing_s/step:356.0817449418828 - timing_s/stop_profile:0.00013932771980762482 - timing_per_token_ms/update_actor:0.09058610774401837 - timing_per_token_ms/adv:9.14060209740376e-05 - timing_per_token_ms/ref:0.032528441933505514 - timing_per_token_ms/gen:0.08052075573921694 - perf/total_num_tokens:1668665 - perf/time_per_step:356.0817449418828 - perf/throughput:585.7731488988393
[36m(TaskRunner pid=2544183)[0m step:10 - actor/entropy:0.24339517951011658 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0002589868491806868 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.8424038565642036e-05 - actor/grad_norm:0.61328125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:242.5893292427063 - actor/lr:1e-06 - training/global_step:10 - training/epoch:0 - critic/score/mean:0.78125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.78125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04228119179606438 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04228119179606438 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:271.699462890625 - response_length/max:3072.0 - response_length/min:58.0 - response_length/clip_ratio:0.010009765625 - response_length_non_aborted/mean:271.699462890625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:58.0 - response_length_non_aborted/clip_ratio:0.010009765625 - response/aborted_ratio:0.0 - prompt_length/mean:138.236328125 - prompt_length/max:265.0 - prompt_length/min:102.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.0001475699245929718 - timing_s/agent_loop/generate_sequences/min:1.6408905871212482 - timing_s/agent_loop/generate_sequences/max:63.08412400027737 - timing_s/agent_loop/generate_sequences/mean:20.292547232028824 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:63.08412400027737 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:203 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:85.52760380785912 - timing_s/reward:0.005475666839629412 - timing_s/old_log_prob:56.46014298405498 - timing_s/ref:52.51511920103803 - timing_s/adv:0.15398626495152712 - timing_s/update_actor:150.4411754757166 - timing_s/step:346.37303074495867 - timing_s/stop_profile:6.161723285913467e-05 - timing_per_token_ms/update_actor:0.08959647684184809 - timing_per_token_ms/adv:9.170778397646302e-05 - timing_per_token_ms/ref:0.03127581027244884 - timing_per_token_ms/gen:0.07685242519897377 - perf/total_num_tokens:1679097 - perf/time_per_step:346.37303074495867 - perf/throughput:605.9568914721425
[36m(TaskRunner pid=2544183)[0m step:11 - actor/entropy:0.21285468339920044 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00028909662566434235 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.7355433643758715e-05 - actor/grad_norm:0.65234375 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:242.18528127670288 - actor/lr:1e-06 - training/global_step:11 - training/epoch:0 - critic/score/mean:0.79248046875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.79248046875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04026462882757187 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04026462882757187 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:252.00927734375 - response_length/max:3072.0 - response_length/min:51.0 - response_length/clip_ratio:0.0087890625 - response_length_non_aborted/mean:252.00927734375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:51.0 - response_length_non_aborted/clip_ratio:0.0087890625 - response/aborted_ratio:0.0 - prompt_length/mean:136.267578125 - prompt_length/max:223.0 - prompt_length/min:101.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010760314762592316 - timing_s/agent_loop/generate_sequences/min:1.5677537326700985 - timing_s/agent_loop/generate_sequences/max:61.3627471649088 - timing_s/agent_loop/generate_sequences/mean:20.209308205680372 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:61.3627471649088 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:164 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:86.7797853788361 - timing_s/reward:0.00016873329877853394 - timing_s/old_log_prob:58.68558196583763 - timing_s/ref:52.4198341825977 - timing_s/adv:0.14905927516520023 - timing_s/update_actor:152.99697661725804 - timing_s/step:351.9447814691812 - timing_s/stop_profile:6.430502980947495e-05 - timing_per_token_ms/update_actor:0.09620140105789556 - timing_per_token_ms/adv:9.37254541142947e-05 - timing_per_token_ms/ref:0.03296053035220324 - timing_per_token_ms/gen:0.08407020274438458 - perf/total_num_tokens:1590382 - perf/time_per_step:351.9447814691812 - perf/throughput:564.8549444890922
[36m(TaskRunner pid=2544183)[0m Training Progress:   6%|▌         | 12/210 [1:11:44<19:40:10, 357.63s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:   6%|▌         | 13/210 [1:17:35<19:27:04, 355.46s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:   7%|▋         | 14/210 [1:23:47<19:37:40, 360.52s/it]Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs00000007691999d6000005be'
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076813be29000005c2'
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076a6c8204000005bd'
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs00000007691999d5000005bc'
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076a8e5093000005c0'
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs0000000769156a63000005c3'
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076a8e5094000005bf'
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076a7d3dd0000005c1'
[36m(TaskRunner pid=2544183)[0m step:12 - actor/entropy:0.24106910824775696 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0002816300085015655 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:5.8799882779680956e-05 - actor/grad_norm:0.48828125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:242.7760715484619 - actor/lr:1e-06 - training/global_step:12 - training/epoch:0 - critic/score/mean:0.8173828125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.8173828125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06252436339855194 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06252436339855194 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:269.479736328125 - response_length/max:3072.0 - response_length/min:58.0 - response_length/clip_ratio:0.011962890625 - response_length_non_aborted/mean:269.479736328125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:58.0 - response_length_non_aborted/clip_ratio:0.011962890625 - response/aborted_ratio:0.0 - prompt_length/mean:135.724609375 - prompt_length/max:227.0 - prompt_length/min:101.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.625684469938278e-05 - timing_s/agent_loop/generate_sequences/min:1.2330461321398616 - timing_s/agent_loop/generate_sequences/max:62.20868263999 - timing_s/agent_loop/generate_sequences/mean:20.392553288834392 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:62.20868263999 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:134 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:90.86791069060564 - timing_s/reward:0.007119054906070232 - timing_s/old_log_prob:56.7187836910598 - timing_s/ref:56.27617210382596 - timing_s/adv:0.15707276808097959 - timing_s/update_actor:162.2446558647789 - timing_s/step:367.38708485336974 - timing_s/stop_profile:4.347367212176323e-05 - timing_per_token_ms/update_actor:0.09775440985708944 - timing_per_token_ms/adv:9.463828356339038e-05 - timing_per_token_ms/ref:0.033907089042183675 - timing_per_token_ms/gen:0.08232362407181594 - perf/total_num_tokens:1659717 - perf/time_per_step:367.38708485336974 - perf/throughput:564.7030980493029
[36m(TaskRunner pid=2544183)[0m step:13 - actor/entropy:0.2215181142091751 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0002848283940455332 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:5.324467434286717e-05 - actor/grad_norm:0.46484375 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:243.29156970977783 - actor/lr:1e-06 - training/global_step:13 - training/epoch:0 - critic/score/mean:0.847412109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.847412109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03258437290787697 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.03258437290787697 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:256.51953125 - response_length/max:3072.0 - response_length/min:59.0 - response_length/clip_ratio:0.011474609375 - response_length_non_aborted/mean:256.51953125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:59.0 - response_length_non_aborted/clip_ratio:0.011474609375 - response/aborted_ratio:0.0 - prompt_length/mean:134.76953125 - prompt_length/max:245.0 - prompt_length/min:95.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:3.325939178466797e-05 - timing_s/agent_loop/generate_sequences/min:1.238152998033911 - timing_s/agent_loop/generate_sequences/max:61.552069147117436 - timing_s/agent_loop/generate_sequences/mean:20.430094924937407 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:61.552069147117436 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:139 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:87.09940626006573 - timing_s/reward:0.005350990686565638 - timing_s/old_log_prob:56.146189966239035 - timing_s/ref:52.08094079326838 - timing_s/adv:0.2719017378985882 - timing_s/update_actor:153.48003809712827 - timing_s/step:350.0351254013367 - timing_s/stop_profile:4.926091060042381e-05 - timing_per_token_ms/update_actor:0.09576222802306596 - timing_per_token_ms/adv:0.0001696501808791231 - timing_per_token_ms/ref:0.032495345907749565 - timing_per_token_ms/gen:0.08289623553357152 - perf/total_num_tokens:1602720 - perf/time_per_step:350.0351254013367 - perf/throughput:572.342560679583
[36m(TaskRunner pid=2544183)[0m step:14 - actor/entropy:0.23164978623390198 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003034641555537121 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:5.394807219127884e-05 - actor/grad_norm:0.455078125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:242.04181098937988 - actor/lr:1e-06 - training/global_step:14 - training/epoch:0 - critic/score/mean:0.833251953125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.833251953125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07592928409576416 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.07592928409576416 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:268.861328125 - response_length/max:3072.0 - response_length/min:66.0 - response_length/clip_ratio:0.01025390625 - response_length_non_aborted/mean:268.861328125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:66.0 - response_length_non_aborted/clip_ratio:0.01025390625 - response/aborted_ratio:0.0 - prompt_length/mean:135.47265625 - prompt_length/max:222.0 - prompt_length/min:101.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:8.890172466635704e-05 - timing_s/agent_loop/generate_sequences/min:1.6186372432857752 - timing_s/agent_loop/generate_sequences/max:64.13140316214412 - timing_s/agent_loop/generate_sequences/mean:21.22027011192347 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:64.13140316214412 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:166 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:95.16082951705903 - timing_s/reward:0.006365751847624779 - timing_s/old_log_prob:57.600686819292605 - timing_s/ref:50.03231104789302 - timing_s/adv:0.12467906577512622 - timing_s/update_actor:167.2741933092475 - timing_s/step:371.76971436291933 - timing_s/stop_profile:5.1212962716817856e-05 - timing_per_token_ms/update_actor:0.10100171560898244 - timing_per_token_ms/adv:7.528238095001317e-05 - timing_per_token_ms/ref:0.030209975321041194 - timing_per_token_ms/gen:0.08641117916003094 - perf/total_num_tokens:1656152 - perf/time_per_step:371.76971436291933 - perf/throughput:556.8474031155462
[36m(TaskRunner pid=2544183)[0m Training Progress:   7%|▋         | 15/210 [1:29:54<19:37:59, 362.46s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:   8%|▊         | 16/210 [1:35:47<19:22:32, 359.55s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:   8%|▊         | 17/210 [1:41:40<19:09:56, 357.49s/it]
[36m(TaskRunner pid=2544183)[0m step:15 - actor/entropy:0.24909140169620514 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003044639027915963 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:3.169593599494647e-05 - actor/grad_norm:0.3828125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:244.19396495819092 - actor/lr:1e-06 - training/global_step:15 - training/epoch:1 - critic/score/mean:0.82568359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.82568359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06346400082111359 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06346400082111359 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:278.17041015625 - response_length/max:3072.0 - response_length/min:55.0 - response_length/clip_ratio:0.01171875 - response_length_non_aborted/mean:278.17041015625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:55.0 - response_length_non_aborted/clip_ratio:0.01171875 - response/aborted_ratio:0.0 - prompt_length/mean:137.25390625 - prompt_length/max:248.0 - prompt_length/min:102.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.0003747907467186451 - timing_s/agent_loop/generate_sequences/min:1.4511796771548688 - timing_s/agent_loop/generate_sequences/max:65.80903035774827 - timing_s/agent_loop/generate_sequences/mean:21.278215620758374 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:65.80903035774827 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:163 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:87.40518294088542 - timing_s/reward:0.0019436608999967575 - timing_s/old_log_prob:64.03560836985707 - timing_s/ref:54.64712167810649 - timing_s/adv:0.20837775524705648 - timing_s/update_actor:154.58328053588048 - timing_s/step:361.9142951522954 - timing_s/stop_profile:6.490899249911308e-05 - timing_per_token_ms/update_actor:0.09084701408685378 - timing_per_token_ms/adv:0.00012246147708013178 - timing_per_token_ms/ref:0.03211555490145411 - timing_per_token_ms/gen:0.07671253020564184 - perf/total_num_tokens:1701578 - perf/time_per_step:361.9142951522954 - perf/throughput:587.7006043944629
[36m(TaskRunner pid=2544183)[0m step:16 - actor/entropy:0.23035313189029694 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003036317348144024 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:6.745949129260964e-05 - actor/grad_norm:0.3671875 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:247.02322673797607 - actor/lr:1e-06 - training/global_step:16 - training/epoch:1 - critic/score/mean:0.86279296875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.86279296875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05388667806982994 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.05388667806982994 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:270.4677734375 - response_length/max:3072.0 - response_length/min:59.0 - response_length/clip_ratio:0.013671875 - response_length_non_aborted/mean:270.4677734375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:59.0 - response_length_non_aborted/clip_ratio:0.013671875 - response/aborted_ratio:0.0 - prompt_length/mean:137.642578125 - prompt_length/max:223.0 - prompt_length/min:95.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.475182741880417e-05 - timing_s/agent_loop/generate_sequences/min:1.7828257600776851 - timing_s/agent_loop/generate_sequences/max:64.9120831200853 - timing_s/agent_loop/generate_sequences/mean:21.013942130670102 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:64.9120831200853 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:141 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:84.28916760068387 - timing_s/reward:0.0048193070106208324 - timing_s/old_log_prob:60.897435603663325 - timing_s/ref:54.20169753301889 - timing_s/adv:0.23068344919010997 - timing_s/update_actor:151.7381458170712 - timing_s/step:352.20902322186157 - timing_s/stop_profile:0.0001590251922607422 - timing_per_token_ms/update_actor:0.09077310980789366 - timing_per_token_ms/adv:0.00013799993371107667 - timing_per_token_ms/ref:0.032424652452721844 - timing_per_token_ms/gen:0.07608451756458887 - perf/total_num_tokens:1671620 - perf/time_per_step:352.20902322186157 - perf/throughput:593.262767911479
[36m(TaskRunner pid=2544183)[0m step:17 - actor/entropy:0.24525079131126404 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00029490671884957464 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.976928999617103e-05 - actor/grad_norm:0.3359375 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:248.08593559265137 - actor/lr:1e-06 - training/global_step:17 - training/epoch:1 - critic/score/mean:0.86474609375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.86474609375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03841415420174599 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.03841415420174599 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:276.227294921875 - response_length/max:3072.0 - response_length/min:61.0 - response_length/clip_ratio:0.010009765625 - response_length_non_aborted/mean:276.227294921875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:61.0 - response_length_non_aborted/clip_ratio:0.010009765625 - response/aborted_ratio:0.0 - prompt_length/mean:136.53125 - prompt_length/max:227.0 - prompt_length/min:101.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:7.751816883683205e-05 - timing_s/agent_loop/generate_sequences/min:1.7738280412741005 - timing_s/agent_loop/generate_sequences/max:63.292037040926516 - timing_s/agent_loop/generate_sequences/mean:20.27841930732268 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:63.292037040926516 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:140 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:88.02378700487316 - timing_s/reward:0.00269499234855175 - timing_s/old_log_prob:59.82093660486862 - timing_s/ref:46.525021872948855 - timing_s/adv:0.257673901040107 - timing_s/update_actor:156.6789082302712 - timing_s/step:352.23780606500804 - timing_s/stop_profile:5.27440570294857e-05 - timing_per_token_ms/update_actor:0.09267327605996904 - timing_per_token_ms/adv:0.00015241033291758243 - timing_per_token_ms/ref:0.027518868011200872 - timing_per_token_ms/gen:0.07779890969976247 - perf/total_num_tokens:1690659 - perf/time_per_step:352.23780606500804 - perf/throughput:599.9707338655098
[36m(TaskRunner pid=2544183)[0m Training Progress:   9%|▊         | 18/210 [1:47:28<18:55:35, 354.87s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:   9%|▉         | 19/210 [1:53:27<18:52:54, 355.89s/it]
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076a3c82d3000005c4'
[36m(TaskRunner pid=2544183)[0m step:18 - actor/entropy:0.2182292491197586 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003244756399123361 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:6.12928216501274e-05 - actor/grad_norm:0.32421875 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:249.86363315582275 - actor/lr:1e-06 - training/global_step:18 - training/epoch:1 - critic/score/mean:0.877685546875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.877685546875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06351590901613235 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06351590901613235 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:249.693359375 - response_length/max:3072.0 - response_length/min:53.0 - response_length/clip_ratio:0.0087890625 - response_length_non_aborted/mean:249.693359375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:53.0 - response_length_non_aborted/clip_ratio:0.0087890625 - response/aborted_ratio:0.0 - prompt_length/mean:135.9140625 - prompt_length/max:234.0 - prompt_length/min:100.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.0001726970076560974 - timing_s/agent_loop/generate_sequences/min:1.8180183279328048 - timing_s/agent_loop/generate_sequences/max:61.65388776175678 - timing_s/agent_loop/generate_sequences/mean:20.36183952632109 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:61.65388776175678 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:154 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:88.55986598599702 - timing_s/reward:0.0034838300198316574 - timing_s/old_log_prob:55.201300497632474 - timing_s/ref:51.31509909592569 - timing_s/adv:0.11901933187618852 - timing_s/update_actor:151.7786651593633 - timing_s/step:348.20585373276845 - timing_s/stop_profile:6.573228165507317e-05 - timing_per_token_ms/update_actor:0.09609601908981068 - timing_per_token_ms/adv:7.535501762399807e-05 - timing_per_token_ms/ref:0.03248926149890702 - timing_per_token_ms/gen:0.08659045272912579 - perf/total_num_tokens:1579448 - perf/time_per_step:348.20585373276845 - perf/throughput:566.995063074152
[36m(TaskRunner pid=2544183)[0m step:19 - actor/entropy:0.25123533606529236 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003162137875811766 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:6.159526613780386e-05 - actor/grad_norm:0.359375 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:251.1204319000244 - actor/lr:1e-06 - training/global_step:19 - training/epoch:1 - critic/score/mean:0.88427734375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.88427734375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04551758989691734 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04551758989691734 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:272.881591796875 - response_length/max:3072.0 - response_length/min:54.0 - response_length/clip_ratio:0.01123046875 - response_length_non_aborted/mean:272.881591796875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:54.0 - response_length_non_aborted/clip_ratio:0.01123046875 - response/aborted_ratio:0.0 - prompt_length/mean:135.630859375 - prompt_length/max:226.0 - prompt_length/min:98.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:5.640089511871338e-05 - timing_s/agent_loop/generate_sequences/min:1.9783279076218605 - timing_s/agent_loop/generate_sequences/max:65.07348503218964 - timing_s/agent_loop/generate_sequences/mean:21.52278342816419 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:65.07348503218964 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:174 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:87.5670233881101 - timing_s/reward:0.000128050334751606 - timing_s/old_log_prob:58.059977382887155 - timing_s/ref:56.83243241906166 - timing_s/adv:0.09392232820391655 - timing_s/update_actor:154.3811311200261 - timing_s/step:357.76099856523797 - timing_s/stop_profile:5.970010533928871e-05 - timing_per_token_ms/update_actor:0.09226329756101453 - timing_per_token_ms/adv:5.6131106514331875e-05 - timing_per_token_ms/ref:0.03396495145070193 - timing_per_token_ms/gen:0.07834411870213828 - perf/total_num_tokens:1673267 - perf/time_per_step:357.76099856523797 - perf/throughput:584.6315720238014
[36m(TaskRunner pid=2544183)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 20}
[36m(TaskRunner pid=2544183)[0m validation generation end
[36m(TaskRunner pid=2544183)[0m Training Progress:  10%|▉         | 20/210 [2:00:19<19:41:06, 372.98s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  10%|█         | 21/210 [2:06:16<19:19:53, 368.22s/it]
[36m(TaskRunner pid=2544183)[0m step:20 - actor/entropy:0.2411535233259201 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003265294689178688 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.8144307944752995e-05 - actor/grad_norm:0.314453125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:252.01679277420044 - actor/lr:1e-06 - val-aux/openai/gsm8k/reward/mean@1:0.8635329795299469 - val-core/openai/gsm8k/acc/mean@1:0.8635329795299469 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0 - training/global_step:20 - training/epoch:1 - critic/score/mean:0.878173828125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.878173828125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0823599100112915 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0823599100112915 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:268.112060546875 - response_length/max:3072.0 - response_length/min:63.0 - response_length/clip_ratio:0.01123046875 - response_length_non_aborted/mean:268.112060546875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:63.0 - response_length_non_aborted/clip_ratio:0.01123046875 - response/aborted_ratio:0.0 - prompt_length/mean:135.947265625 - prompt_length/max:219.0 - prompt_length/min:98.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:4.658615216612816e-05 - timing_s/agent_loop/generate_sequences/min:1.8203738238662481 - timing_s/agent_loop/generate_sequences/max:62.798950931057334 - timing_s/agent_loop/generate_sequences/mean:20.781175658326333 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:62.798950931057334 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:151 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:83.20177666982636 - timing_s/reward:0.007928075268864632 - timing_s/old_log_prob:57.94440404092893 - timing_s/ref:51.634253684896976 - timing_s/adv:0.2332256962545216 - timing_s/update_actor:158.7497384129092 - timing_s/step:352.7104389881715 - timing_s/testing:59.7201695330441 - timing_s/stop_profile:7.098494097590446e-05 - timing_per_token_ms/update_actor:0.09591972723883611 - timing_per_token_ms/adv:0.00014091957185865948 - timing_per_token_ms/ref:0.031198435847207915 - timing_per_token_ms/gen:0.07576284974218996 - perf/total_num_tokens:1655027 - perf/time_per_step:352.7104389881715 - perf/throughput:586.5388492426725
[36m(TaskRunner pid=2544183)[0m step:21 - actor/entropy:0.25785356760025024 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00031336063000075853 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:1.9527939622676627e-05 - actor/grad_norm:0.25 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:251.23198318481445 - actor/lr:1e-06 - training/global_step:21 - training/epoch:1 - critic/score/mean:0.88818359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.88818359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0568326972424984 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0568326972424984 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:285.9853515625 - response_length/max:3072.0 - response_length/min:54.0 - response_length/clip_ratio:0.011962890625 - response_length_non_aborted/mean:285.9853515625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:54.0 - response_length_non_aborted/clip_ratio:0.011962890625 - response/aborted_ratio:0.0 - prompt_length/mean:134.6640625 - prompt_length/max:223.0 - prompt_length/min:97.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00017009582370519638 - timing_s/agent_loop/generate_sequences/min:1.4043530067428946 - timing_s/agent_loop/generate_sequences/max:63.97437519300729 - timing_s/agent_loop/generate_sequences/mean:20.89712831230895 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:63.97437519300729 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:164 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:79.98869389109313 - timing_s/reward:0.00022920500487089157 - timing_s/old_log_prob:61.0641652867198 - timing_s/ref:53.45685873599723 - timing_s/adv:0.12249562935903668 - timing_s/update_actor:161.12585845123976 - timing_s/step:356.66973193362355 - timing_s/stop_profile:4.8255082219839096e-05 - timing_per_token_ms/update_actor:0.09351580311509115 - timing_per_token_ms/adv:7.109521257300531e-05 - timing_per_token_ms/ref:0.03102581500423524 - timing_per_token_ms/gen:0.06828493002459726 - perf/total_num_tokens:1722980 - perf/time_per_step:356.66973193362355 - perf/throughput:603.8429412902381
[36m(TaskRunner pid=2544183)[0m Training Progress:  10%|█         | 22/210 [2:12:11<19:01:17, 364.24s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  11%|█         | 23/210 [2:18:17<18:56:12, 364.56s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  11%|█▏        | 24/210 [2:24:03<18:33:13, 359.11s/it]
[36m(TaskRunner pid=2544183)[0m step:22 - actor/entropy:0.23753753304481506 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00033136238947761854 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.219665344238564e-05 - actor/grad_norm:0.26953125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:251.34646034240723 - actor/lr:1e-06 - training/global_step:22 - training/epoch:1 - critic/score/mean:0.869384765625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.869384765625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05654067546129227 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.05654067546129227 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:265.677001953125 - response_length/max:3072.0 - response_length/min:57.0 - response_length/clip_ratio:0.009765625 - response_length_non_aborted/mean:265.677001953125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:57.0 - response_length_non_aborted/clip_ratio:0.009765625 - response/aborted_ratio:0.0 - prompt_length/mean:137.896484375 - prompt_length/max:271.0 - prompt_length/min:89.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:4.759570583701134e-05 - timing_s/agent_loop/generate_sequences/min:1.9508890542201698 - timing_s/agent_loop/generate_sequences/max:63.35536873387173 - timing_s/agent_loop/generate_sequences/mean:21.698209545797454 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:63.35536873387173 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:130 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:87.55912084970623 - timing_s/reward:0.00511519517749548 - timing_s/old_log_prob:57.02367053600028 - timing_s/ref:56.2297253231518 - timing_s/adv:0.1564735290594399 - timing_s/update_actor:152.22317087184638 - timing_s/step:354.3886718386784 - timing_s/stop_profile:6.580585613846779e-05 - timing_per_token_ms/update_actor:0.09208697135747498 - timing_per_token_ms/adv:9.465821337298554e-05 - timing_per_token_ms/ref:0.03401601133135665 - timing_per_token_ms/gen:0.08046138104369846 - perf/total_num_tokens:1653037 - perf/time_per_step:354.3886718386784 - perf/throughput:583.0593397016371
[36m(TaskRunner pid=2544183)[0m step:23 - actor/entropy:0.25126412510871887 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.000330904547450217 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:1.4391976984384769e-05 - actor/grad_norm:0.2255859375 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:250.99276638031006 - actor/lr:1e-06 - training/global_step:23 - training/epoch:1 - critic/score/mean:0.906494140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.906494140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03437897562980652 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.03437897562980652 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:275.492919921875 - response_length/max:3072.0 - response_length/min:58.0 - response_length/clip_ratio:0.010009765625 - response_length_non_aborted/mean:275.492919921875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:58.0 - response_length_non_aborted/clip_ratio:0.010009765625 - response/aborted_ratio:0.0 - prompt_length/mean:136.0859375 - prompt_length/max:255.0 - prompt_length/min:100.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.407335892319679e-05 - timing_s/agent_loop/generate_sequences/min:1.354777849279344 - timing_s/agent_loop/generate_sequences/max:63.14108705613762 - timing_s/agent_loop/generate_sequences/mean:21.25879557645328 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:63.14108705613762 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:166 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:88.26244282023981 - timing_s/reward:0.00015290407463908195 - timing_s/old_log_prob:60.551217718981206 - timing_s/ref:51.741685492917895 - timing_s/adv:0.1401534336619079 - timing_s/update_actor:162.69398142863065 - timing_s/step:364.2988883587532 - timing_s/stop_profile:0.00010598637163639069 - timing_per_token_ms/update_actor:0.09650692593524167 - timing_per_token_ms/adv:8.313630856660139e-05 - timing_per_token_ms/ref:0.030692167994057454 - timing_per_token_ms/gen:0.0782177921678382 - perf/total_num_tokens:1685827 - perf/time_per_step:364.2988883587532 - perf/throughput:578.4491299146638
[36m(TaskRunner pid=2544183)[0m step:24 - actor/entropy:0.20947423577308655 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00031974360415887304 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.436830029508343e-05 - actor/grad_norm:0.25 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:250.88024520874023 - actor/lr:1e-06 - training/global_step:24 - training/epoch:1 - critic/score/mean:0.894287109375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.894287109375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.020410684868693352 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.020410684868693352 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:260.606689453125 - response_length/max:3072.0 - response_length/min:50.0 - response_length/clip_ratio:0.009033203125 - response_length_non_aborted/mean:260.606689453125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:50.0 - response_length_non_aborted/clip_ratio:0.009033203125 - response/aborted_ratio:0.0 - prompt_length/mean:136.943359375 - prompt_length/max:289.0 - prompt_length/min:101.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:4.6940986067056656e-05 - timing_s/agent_loop/generate_sequences/min:1.482676177751273 - timing_s/agent_loop/generate_sequences/max:63.18812960386276 - timing_s/agent_loop/generate_sequences/mean:20.816165157193268 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:63.18812960386276 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:158 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:87.00836227834225 - timing_s/reward:0.0035934816114604473 - timing_s/old_log_prob:50.62148752389476 - timing_s/ref:52.46261951467022 - timing_s/adv:0.12713733920827508 - timing_s/update_actor:154.77025187108666 - timing_s/step:345.9308154848404 - timing_s/stop_profile:6.928015500307083e-05 - timing_per_token_ms/update_actor:0.0950464127336848 - timing_per_token_ms/adv:7.807668379526401e-05 - timing_per_token_ms/ref:0.03221797294505238 - timing_per_token_ms/gen:0.08151086217869984 - perf/total_num_tokens:1628365 - perf/time_per_step:345.9308154848404 - perf/throughput:588.3998068073814
[36m(TaskRunner pid=2544183)[0m Training Progress:  12%|█▏        | 25/210 [2:30:04<18:29:03, 359.70s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  12%|█▏        | 26/210 [2:36:10<18:28:39, 361.52s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  13%|█▎        | 27/210 [2:42:05<18:16:37, 359.55s/it]
[36m(TaskRunner pid=2544183)[0m step:25 - actor/entropy:0.25357720255851746 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00030461324588237915 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:9.68028596481929e-06 - actor/grad_norm:0.2275390625 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:251.14636325836182 - actor/lr:1e-06 - training/global_step:25 - training/epoch:1 - critic/score/mean:0.90966796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.90966796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04400363564491272 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04400363564491272 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:283.61767578125 - response_length/max:3072.0 - response_length/min:56.0 - response_length/clip_ratio:0.01318359375 - response_length_non_aborted/mean:283.61767578125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:56.0 - response_length_non_aborted/clip_ratio:0.01318359375 - response/aborted_ratio:0.0 - prompt_length/mean:138.65234375 - prompt_length/max:245.0 - prompt_length/min:97.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:5.155429244041443e-05 - timing_s/agent_loop/generate_sequences/min:1.792892074212432 - timing_s/agent_loop/generate_sequences/max:65.01248383522034 - timing_s/agent_loop/generate_sequences/mean:21.186488729343978 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:65.01248383522034 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:123 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:94.3784400220029 - timing_s/reward:0.00015972089022397995 - timing_s/old_log_prob:58.2622582949698 - timing_s/ref:48.88798137800768 - timing_s/adv:0.1537688821554184 - timing_s/update_actor:158.0666440683417 - timing_s/step:360.61808023415506 - timing_s/stop_profile:8.812826126813889e-05 - timing_per_token_ms/update_actor:0.0913881817073722 - timing_per_token_ms/adv:8.890337759864803e-05 - timing_per_token_ms/ref:0.02826518998877653 - timing_per_token_ms/gen:0.08124180296600571 - perf/total_num_tokens:1729618 - perf/time_per_step:360.61808023415506 - perf/throughput:599.5324745215671
[36m(TaskRunner pid=2544183)[0m step:26 - actor/entropy:0.22857829928398132 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00031864151965876886 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:7.295901554771334e-05 - actor/grad_norm:0.181640625 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:251.12470960617065 - actor/lr:1e-06 - training/global_step:26 - training/epoch:1 - critic/score/mean:0.9091796875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.9091796875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.08573193848133087 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.08573193848133087 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:253.0341796875 - response_length/max:3072.0 - response_length/min:53.0 - response_length/clip_ratio:0.009521484375 - response_length_non_aborted/mean:253.0341796875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:53.0 - response_length_non_aborted/clip_ratio:0.009521484375 - response/aborted_ratio:0.0 - prompt_length/mean:135.81640625 - prompt_length/max:249.0 - prompt_length/min:99.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00012115016579627991 - timing_s/agent_loop/generate_sequences/min:1.2764704478904605 - timing_s/agent_loop/generate_sequences/max:62.8357289978303 - timing_s/agent_loop/generate_sequences/mean:20.53702776663647 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:62.8357289978303 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:121 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:93.09905785601586 - timing_s/reward:0.00257631903514266 - timing_s/old_log_prob:58.85744935274124 - timing_s/ref:52.89451415324584 - timing_s/adv:0.2513448353856802 - timing_s/update_actor:159.1646841838956 - timing_s/step:365.3410570542328 - timing_s/stop_profile:5.8896373957395554e-05 - timing_per_token_ms/update_actor:0.09993186812589663 - timing_per_token_ms/adv:0.0001578073620581995 - timing_per_token_ms/ref:0.03320992744118021 - timing_per_token_ms/gen:0.08982684552715274 - perf/total_num_tokens:1592732 - perf/time_per_step:365.3410570542328 - perf/throughput:544.9469643660827
[36m(TaskRunner pid=2544183)[0m step:27 - actor/entropy:0.227117657661438 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003309511812332744 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:3.448893755830795e-05 - actor/grad_norm:0.17578125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:251.19056177139282 - actor/lr:1e-06 - training/global_step:27 - training/epoch:1 - critic/score/mean:0.9033203125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.9033203125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07069986313581467 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.07069986313581467 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:264.124267578125 - response_length/max:3072.0 - response_length/min:65.0 - response_length/clip_ratio:0.010986328125 - response_length_non_aborted/mean:264.124267578125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:65.0 - response_length_non_aborted/clip_ratio:0.010986328125 - response/aborted_ratio:0.0 - prompt_length/mean:136.44140625 - prompt_length/max:228.0 - prompt_length/min:96.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:8.21240246295929e-05 - timing_s/agent_loop/generate_sequences/min:1.6580640329048038 - timing_s/agent_loop/generate_sequences/max:61.86606996646151 - timing_s/agent_loop/generate_sequences/mean:20.797524316090744 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:61.86606996646151 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:127 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:88.48328718589619 - timing_s/reward:0.0029838532209396362 - timing_s/old_log_prob:54.52446375694126 - timing_s/ref:53.949917727615684 - timing_s/adv:0.1472692028619349 - timing_s/update_actor:156.3351985490881 - timing_s/step:354.5548276398331 - timing_s/stop_profile:6.32130540907383e-05 - timing_per_token_ms/update_actor:0.09528468258029148 - timing_per_token_ms/adv:8.975905220823268e-05 - timing_per_token_ms/ref:0.0328819154842765 - timing_per_token_ms/gen:0.08178864151219822 - perf/total_num_tokens:1640717 - perf/time_per_step:354.5548276398331 - perf/throughput:578.4426244178401
[36m(TaskRunner pid=2544183)[0m Training Progress:  13%|█▎        | 28/210 [2:48:11<18:16:09, 361.37s/it]Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076ad81c9e000005c7'
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076857b657000005c5'
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs0000000769ecaa4e000005c9'
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076ad33846000005cc'
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076ad33848000005c6'
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs0000000769ecaa4f000005cb'
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs0000000769fcb2f3000005c8'
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076b7b06f0000005ca'
[36m(TaskRunner pid=2544183)[0m Training Progress:  14%|█▍        | 29/210 [2:54:16<18:14:12, 362.72s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  14%|█▍        | 30/210 [3:00:22<18:10:41, 363.57s/it]
[36m(TaskRunner pid=2544183)[0m step:28 - actor/entropy:0.2344324290752411 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00033259569789301224 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.13922654765031e-05 - actor/grad_norm:0.20703125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:251.03698015213013 - actor/lr:1e-06 - training/global_step:28 - training/epoch:1 - critic/score/mean:0.90478515625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.90478515625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05148294195532799 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.05148294195532799 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:275.832275390625 - response_length/max:3072.0 - response_length/min:57.0 - response_length/clip_ratio:0.010986328125 - response_length_non_aborted/mean:275.832275390625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:57.0 - response_length_non_aborted/clip_ratio:0.010986328125 - response/aborted_ratio:0.0 - prompt_length/mean:137.4140625 - prompt_length/max:250.0 - prompt_length/min:101.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:3.14260832965374e-05 - timing_s/agent_loop/generate_sequences/min:1.493279058020562 - timing_s/agent_loop/generate_sequences/max:62.800044354982674 - timing_s/agent_loop/generate_sequences/mean:20.62808643674839 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:62.800044354982674 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:142 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:93.84840479120612 - timing_s/reward:0.010954998899251223 - timing_s/old_log_prob:58.88147155707702 - timing_s/ref:54.40123235993087 - timing_s/adv:0.16542853182181716 - timing_s/update_actor:156.54685075487942 - timing_s/step:365.0431778943166 - timing_s/stop_profile:6.545521318912506e-05 - timing_per_token_ms/update_actor:0.09248586734044725 - timing_per_token_ms/adv:9.773305035917918e-05 - timing_per_token_ms/ref:0.03213954886307791 - timing_per_token_ms/gen:0.08306572596890813 - perf/total_num_tokens:1692657 - perf/time_per_step:365.0431778943166 - perf/throughput:579.6084896599683
[36m(TaskRunner pid=2544183)[0m step:29 - actor/entropy:0.23782673478126526 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00033206576531341625 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.0964127115163933e-05 - actor/grad_norm:0.177734375 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:247.54860258102417 - actor/lr:1e-06 - training/global_step:29 - training/epoch:2 - critic/score/mean:0.90625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.90625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.038807064294815063 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.038807064294815063 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:269.74560546875 - response_length/max:3072.0 - response_length/min:52.0 - response_length/clip_ratio:0.008544921875 - response_length_non_aborted/mean:269.74560546875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:52.0 - response_length_non_aborted/clip_ratio:0.008544921875 - response/aborted_ratio:0.0 - prompt_length/mean:137.744140625 - prompt_length/max:289.0 - prompt_length/min:102.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.0004239492118358612 - timing_s/agent_loop/generate_sequences/min:1.7751665241084993 - timing_s/agent_loop/generate_sequences/max:63.875583212822676 - timing_s/agent_loop/generate_sequences/mean:21.071051488871376 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:63.875583212822676 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:164 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:89.36819088459015 - timing_s/reward:0.00018332479521632195 - timing_s/old_log_prob:58.97645519627258 - timing_s/ref:52.26684834109619 - timing_s/adv:0.15766485268250108 - timing_s/update_actor:157.37761249300092 - timing_s/step:359.56161819864064 - timing_s/stop_profile:9.224610403180122e-05 - timing_per_token_ms/update_actor:0.09429014850893783 - timing_per_token_ms/adv:9.446224363540893e-05 - timing_per_token_ms/ref:0.031314802748041846 - timing_per_token_ms/gen:0.0808851211487514 - perf/total_num_tokens:1669078 - perf/time_per_step:359.56161819864064 - perf/throughput:580.2475554683349
[36m(TaskRunner pid=2544183)[0m step:30 - actor/entropy:0.2436433881521225 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003263031563740526 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.7126119849008035e-05 - actor/grad_norm:0.142578125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:247.6857304573059 - actor/lr:1e-06 - training/global_step:30 - training/epoch:2 - critic/score/mean:0.892333984375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.892333984375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.055210404098033905 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.055210404098033905 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:276.86328125 - response_length/max:3072.0 - response_length/min:58.0 - response_length/clip_ratio:0.01171875 - response_length_non_aborted/mean:276.86328125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:58.0 - response_length_non_aborted/clip_ratio:0.01171875 - response/aborted_ratio:0.0 - prompt_length/mean:136.08203125 - prompt_length/max:224.0 - prompt_length/min:89.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:4.983367398381233e-05 - timing_s/agent_loop/generate_sequences/min:1.448601562064141 - timing_s/agent_loop/generate_sequences/max:62.41580066876486 - timing_s/agent_loop/generate_sequences/mean:20.432241613052042 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:62.41580066876486 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:163 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:87.73459767876193 - timing_s/reward:0.0034153941087424755 - timing_s/old_log_prob:63.670403860043734 - timing_s/ref:51.81674347212538 - timing_s/adv:0.17910477565601468 - timing_s/update_actor:160.30365733709186 - timing_s/step:365.0803132131696 - timing_s/stop_profile:4.90313395857811e-05 - timing_per_token_ms/update_actor:0.09477437788342359 - timing_per_token_ms/adv:0.00010588993395861397 - timing_per_token_ms/ref:0.030634981809484423 - timing_per_token_ms/gen:0.07736518694248656 - perf/total_num_tokens:1691424 - perf/time_per_step:365.0803132131696 - perf/throughput:579.1273655354505
[36m(TaskRunner pid=2544183)[0m Training Progress:  15%|█▍        | 31/210 [3:06:21<18:00:25, 362.15s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  15%|█▌        | 32/210 [3:12:11<17:44:06, 358.69s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  16%|█▌        | 33/210 [3:18:01<17:29:39, 355.82s/it]
[36m(TaskRunner pid=2544183)[0m step:31 - actor/entropy:0.26227858662605286 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00033227017669901215 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:5.032162914275773e-05 - actor/grad_norm:0.203125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:247.20781707763672 - actor/lr:1e-06 - training/global_step:31 - training/epoch:2 - critic/score/mean:0.913818359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.913818359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07180586457252502 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.07180586457252502 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:278.490966796875 - response_length/max:3072.0 - response_length/min:56.0 - response_length/clip_ratio:0.011474609375 - response_length_non_aborted/mean:278.490966796875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:56.0 - response_length_non_aborted/clip_ratio:0.011474609375 - response/aborted_ratio:0.0 - prompt_length/mean:136.0859375 - prompt_length/max:248.0 - prompt_length/min:98.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00010873889550566673 - timing_s/agent_loop/generate_sequences/min:1.6383575852960348 - timing_s/agent_loop/generate_sequences/max:63.60196967702359 - timing_s/agent_loop/generate_sequences/mean:21.005072464298223 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:63.60196967702359 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:196 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:85.00848486972973 - timing_s/reward:0.00016026105731725693 - timing_s/old_log_prob:60.17505770036951 - timing_s/ref:59.182775031775236 - timing_s/adv:0.15229979436844587 - timing_s/update_actor:152.49282579123974 - timing_s/step:358.307764952071 - timing_s/stop_profile:4.056282341480255e-05 - timing_per_token_ms/update_actor:0.08980165901868359 - timing_per_token_ms/adv:8.96879845430505e-05 - timing_per_token_ms/ref:0.034852206033998585 - timing_per_token_ms/gen:0.0745231519180167 - perf/total_num_tokens:1698107 - perf/time_per_step:358.307764952071 - perf/throughput:592.4051772319067
[36m(TaskRunner pid=2544183)[0m step:32 - actor/entropy:0.22808754444122314 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00031957761832401843 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.4915641250753424e-05 - actor/grad_norm:0.1748046875 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:248.74547719955444 - actor/lr:1e-06 - training/global_step:32 - training/epoch:2 - critic/score/mean:0.90380859375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.90380859375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.061027832329273224 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.061027832329273224 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:255.43701171875 - response_length/max:3072.0 - response_length/min:49.0 - response_length/clip_ratio:0.010498046875 - response_length_non_aborted/mean:255.43701171875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:49.0 - response_length_non_aborted/clip_ratio:0.010498046875 - response/aborted_ratio:0.0 - prompt_length/mean:136.72265625 - prompt_length/max:255.0 - prompt_length/min:97.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:4.857825115323067e-05 - timing_s/agent_loop/generate_sequences/min:1.4586867559701204 - timing_s/agent_loop/generate_sequences/max:61.076610897202045 - timing_s/agent_loop/generate_sequences/mean:20.302719016141623 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:61.076610897202045 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:155 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:83.9701075530611 - timing_s/reward:0.00017493125051259995 - timing_s/old_log_prob:53.45484682684764 - timing_s/ref:58.509798982180655 - timing_s/adv:0.16989838983863592 - timing_s/update_actor:152.6297939158976 - timing_s/step:349.9881639396772 - timing_s/stop_profile:5.6669581681489944e-05 - timing_per_token_ms/update_actor:0.09502031015391879 - timing_per_token_ms/adv:0.00010577094604487365 - timing_per_token_ms/ref:0.03642551761154655 - timing_per_token_ms/gen:0.08025663313777619 - perf/total_num_tokens:1606286 - perf/time_per_step:349.9881639396772 - perf/throughput:573.6929721846444
[36m(TaskRunner pid=2544183)[0m step:33 - actor/entropy:0.20949102938175201 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003197624262263332 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:3.0296167025767318e-05 - actor/grad_norm:0.140625 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:249.98126983642578 - actor/lr:1e-06 - training/global_step:33 - training/epoch:2 - critic/score/mean:0.920166015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.920166015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03368113189935684 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.03368113189935684 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:255.666748046875 - response_length/max:3072.0 - response_length/min:59.0 - response_length/clip_ratio:0.00927734375 - response_length_non_aborted/mean:255.666748046875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:59.0 - response_length_non_aborted/clip_ratio:0.00927734375 - response/aborted_ratio:0.0 - prompt_length/mean:136.615234375 - prompt_length/max:219.0 - prompt_length/min:97.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00011041481047868729 - timing_s/agent_loop/generate_sequences/min:1.4465442467480898 - timing_s/agent_loop/generate_sequences/max:62.44641863927245 - timing_s/agent_loop/generate_sequences/mean:20.59202573913751 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:62.44641863927245 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:148 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:86.91050172504038 - timing_s/reward:0.00017452705651521683 - timing_s/old_log_prob:61.63657004199922 - timing_s/ref:49.61520903604105 - timing_s/adv:0.18745980877429247 - timing_s/update_actor:149.31278757797554 - timing_s/step:348.6320889000781 - timing_s/stop_profile:6.311992183327675e-05 - timing_per_token_ms/update_actor:0.09292631044312379 - timing_per_token_ms/adv:0.0001166674915681372 - timing_per_token_ms/ref:0.030878522813565863 - timing_per_token_ms/gen:0.08299234989418597 - perf/total_num_tokens:1606787 - perf/time_per_step:348.6320889000781 - perf/throughput:576.1040976855272
[36m(TaskRunner pid=2544183)[0m Training Progress:  16%|█▌        | 34/210 [3:24:07<17:32:42, 358.88s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  17%|█▋        | 35/210 [3:29:59<17:21:12, 356.98s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  17%|█▋        | 36/210 [3:35:56<17:15:16, 356.99s/it]
[36m(TaskRunner pid=2544183)[0m step:34 - actor/entropy:0.22098731994628906 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.000352678964997466 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:3.119746796187428e-05 - actor/grad_norm:0.15625 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:250.74354553222656 - actor/lr:1e-06 - training/global_step:34 - training/epoch:2 - critic/score/mean:0.926025390625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.926025390625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03970496729016304 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.03970496729016304 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:255.685302734375 - response_length/max:3072.0 - response_length/min:50.0 - response_length/clip_ratio:0.010009765625 - response_length_non_aborted/mean:255.685302734375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:50.0 - response_length_non_aborted/clip_ratio:0.010009765625 - response/aborted_ratio:0.0 - prompt_length/mean:138.041015625 - prompt_length/max:245.0 - prompt_length/min:96.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.841006249189377e-05 - timing_s/agent_loop/generate_sequences/min:1.4572365023195744 - timing_s/agent_loop/generate_sequences/max:62.94304732000455 - timing_s/agent_loop/generate_sequences/mean:20.688344049198463 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:62.94304732000455 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:153 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:86.82469981303439 - timing_s/reward:0.00013573607429862022 - timing_s/old_log_prob:64.90800570463762 - timing_s/ref:55.236232708673924 - timing_s/adv:0.12634517485275865 - timing_s/update_actor:157.50298427976668 - timing_s/step:365.57158031174913 - timing_s/stop_profile:6.205122917890549e-05 - timing_per_token_ms/update_actor:0.09766397425921988 - timing_per_token_ms/adv:7.83437339998491e-05 - timing_per_token_ms/ref:0.03425071616328234 - timing_per_token_ms/gen:0.08290439947505734 - perf/total_num_tokens:1612703 - perf/time_per_step:365.57158031174913 - perf/throughput:551.4320200385696
[36m(TaskRunner pid=2544183)[0m step:35 - actor/entropy:0.21801364421844482 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00033668283494492357 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.53578359911333e-05 - actor/grad_norm:0.1318359375 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:251.99564170837402 - actor/lr:1e-06 - training/global_step:35 - training/epoch:2 - critic/score/mean:0.916015625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.916015625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04837939515709877 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04837939515709877 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:254.5546875 - response_length/max:3072.0 - response_length/min:50.0 - response_length/clip_ratio:0.004150390625 - response_length_non_aborted/mean:254.5546875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:50.0 - response_length_non_aborted/clip_ratio:0.004150390625 - response/aborted_ratio:0.0 - prompt_length/mean:136.923828125 - prompt_length/max:244.0 - prompt_length/min:95.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:5.938718095421791e-05 - timing_s/agent_loop/generate_sequences/min:1.1682271831668913 - timing_s/agent_loop/generate_sequences/max:60.822450244333595 - timing_s/agent_loop/generate_sequences/mean:20.172031527711283 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:60.822450244333595 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:126 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:86.19773264694959 - timing_s/reward:0.0036273831501603127 - timing_s/old_log_prob:58.14465443463996 - timing_s/ref:51.32766080601141 - timing_s/adv:0.11749536357820034 - timing_s/update_actor:155.51104970416054 - timing_s/step:352.1623846371658 - timing_s/stop_profile:4.185875877737999e-05 - timing_per_token_ms/update_actor:0.09698249930412084 - timing_per_token_ms/adv:7.327449745942637e-05 - timing_per_token_ms/ref:0.032009846489178276 - timing_per_token_ms/gen:0.082671305442015 - perf/total_num_tokens:1603496 - perf/time_per_step:352.1623846371658 - perf/throughput:569.160730231058
[36m(TaskRunner pid=2544183)[0m step:36 - actor/entropy:0.2409970909357071 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00034905221439274214 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:7.947776335726076e-06 - actor/grad_norm:0.109375 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:251.8870391845703 - actor/lr:1e-06 - training/global_step:36 - training/epoch:2 - critic/score/mean:0.944580078125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.944580078125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.050771117210388184 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.050771117210388184 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:271.467041015625 - response_length/max:3072.0 - response_length/min:54.0 - response_length/clip_ratio:0.009521484375 - response_length_non_aborted/mean:271.467041015625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:54.0 - response_length_non_aborted/clip_ratio:0.009521484375 - response/aborted_ratio:0.0 - prompt_length/mean:136.0859375 - prompt_length/max:227.0 - prompt_length/min:100.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:4.883715882897377e-05 - timing_s/agent_loop/generate_sequences/min:1.6838970063254237 - timing_s/agent_loop/generate_sequences/max:64.38676997972652 - timing_s/agent_loop/generate_sequences/mean:20.68911764597317 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:64.38676997972652 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:152 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:88.21727707982063 - timing_s/reward:0.00591766694560647 - timing_s/old_log_prob:56.53936444595456 - timing_s/ref:55.492975309025496 - timing_s/adv:0.15863678976893425 - timing_s/update_actor:155.16085936222225 - timing_s/step:356.6154208597727 - timing_s/stop_profile:5.318084731698036e-05 - timing_per_token_ms/update_actor:0.09294759498065534 - timing_per_token_ms/adv:9.502981708842149e-05 - timing_per_token_ms/ref:0.033242524013440966 - timing_per_token_ms/gen:0.07933714929624161 - perf/total_num_tokens:1669337 - perf/time_per_step:356.6154208597727 - perf/throughput:585.1320856987043
[36m(TaskRunner pid=2544183)[0m Training Progress:  18%|█▊        | 37/210 [3:41:53<17:09:08, 356.93s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  18%|█▊        | 38/210 [3:47:37<16:52:24, 353.16s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  19%|█▊        | 39/210 [3:53:42<16:56:29, 356.67s/it]
[36m(TaskRunner pid=2544183)[0m step:37 - actor/entropy:0.2663048505783081 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003247567618398506 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.1610136799132817e-05 - actor/grad_norm:0.11767578125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:252.37635946273804 - actor/lr:1e-06 - training/global_step:37 - training/epoch:2 - critic/score/mean:0.913818359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.913818359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07747866958379745 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.07747866958379745 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:295.94384765625 - response_length/max:3072.0 - response_length/min:58.0 - response_length/clip_ratio:0.01513671875 - response_length_non_aborted/mean:295.94384765625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:58.0 - response_length_non_aborted/clip_ratio:0.01513671875 - response/aborted_ratio:0.0 - prompt_length/mean:135.845703125 - prompt_length/max:265.0 - prompt_length/min:99.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.122909978032112e-05 - timing_s/agent_loop/generate_sequences/min:1.8963580531999469 - timing_s/agent_loop/generate_sequences/max:66.64371949667111 - timing_s/agent_loop/generate_sequences/mean:21.871433661405604 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:66.64371949667111 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:144 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:84.6984094157815 - timing_s/reward:0.00013948697596788406 - timing_s/old_log_prob:56.899008033797145 - timing_s/ref:51.948665460105985 - timing_s/adv:0.168308240827173 - timing_s/update_actor:161.59080857317895 - timing_s/step:356.2870031138882 - timing_s/stop_profile:6.33099116384983e-05 - timing_per_token_ms/update_actor:0.0913659928266712 - timing_per_token_ms/adv:9.516413501403531e-05 - timing_per_token_ms/ref:0.02937259512278342 - timing_per_token_ms/gen:0.06987245308540233 - perf/total_num_tokens:1768610 - perf/time_per_step:356.2870031138882 - perf/throughput:620.5004618968161
[36m(TaskRunner pid=2544183)[0m step:38 - actor/entropy:0.2568563222885132 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003359142330214837 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.4871794337855135e-05 - actor/grad_norm:0.09814453125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:252.61774730682373 - actor/lr:1e-06 - training/global_step:38 - training/epoch:2 - critic/score/mean:0.9296875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.9296875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.08580037951469421 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.08580037951469421 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:274.107421875 - response_length/max:3072.0 - response_length/min:64.0 - response_length/clip_ratio:0.012451171875 - response_length_non_aborted/mean:274.107421875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:64.0 - response_length_non_aborted/clip_ratio:0.012451171875 - response/aborted_ratio:0.0 - prompt_length/mean:136.076171875 - prompt_length/max:271.0 - prompt_length/min:96.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:4.665320739150047e-05 - timing_s/agent_loop/generate_sequences/min:1.8136920230463147 - timing_s/agent_loop/generate_sequences/max:63.843743063975126 - timing_s/agent_loop/generate_sequences/mean:21.151880487136964 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:63.843743063975126 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:140 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:86.42972925212234 - timing_s/reward:0.00018179602921009064 - timing_s/old_log_prob:53.771080753766 - timing_s/ref:53.12493397202343 - timing_s/adv:0.14141888404265046 - timing_s/update_actor:148.58027429226786 - timing_s/step:343.80232899077237 - timing_s/stop_profile:6.528571248054504e-05 - timing_per_token_ms/update_actor:0.0884347438100959 - timing_per_token_ms/adv:8.417229568186553e-05 - timing_per_token_ms/ref:0.03161987651538911 - timing_per_token_ms/gen:0.07698079816246833 - perf/total_num_tokens:1680112 - perf/time_per_step:343.80232899077237 - perf/throughput:610.8568275744193
[36m(TaskRunner pid=2544183)[0m step:39 - actor/entropy:0.2135310024023056 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003469666276014749 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:3.431706255696554e-05 - actor/grad_norm:0.12451171875 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:251.9037628173828 - actor/lr:1e-06 - training/global_step:39 - training/epoch:2 - critic/score/mean:0.937255859375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.937255859375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04925914853811264 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.04925914853811264 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:262.930908203125 - response_length/max:3072.0 - response_length/min:53.0 - response_length/clip_ratio:0.00830078125 - response_length_non_aborted/mean:262.930908203125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:53.0 - response_length_non_aborted/clip_ratio:0.00830078125 - response/aborted_ratio:0.0 - prompt_length/mean:136.5 - prompt_length/max:249.0 - prompt_length/min:101.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00012307707220315933 - timing_s/agent_loop/generate_sequences/min:1.4626959301531315 - timing_s/agent_loop/generate_sequences/max:63.56099660182372 - timing_s/agent_loop/generate_sequences/mean:21.590654614188452 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:63.56099660182372 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:129 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:91.53638477483764 - timing_s/reward:0.00018217181786894798 - timing_s/old_log_prob:55.95460389088839 - timing_s/ref:53.08606768772006 - timing_s/adv:0.15796422213315964 - timing_s/update_actor:162.3014224539511 - timing_s/step:364.27775148814544 - timing_s/stop_profile:5.210982635617256e-05 - timing_per_token_ms/update_actor:0.09920206449358254 - timing_per_token_ms/adv:9.655107586120124e-05 - timing_per_token_ms/ref:0.03244732813085515 - timing_per_token_ms/gen:0.08499476285193822 - perf/total_num_tokens:1636069 - perf/time_per_step:364.27775148814544 - perf/throughput:561.4084971276519
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076a35860d000005cd'
[36m(TaskRunner pid=2544183)[0m Training Progress:  19%|█▉        | 40/210 [4:00:41<17:43:26, 375.33s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  20%|█▉        | 41/210 [4:06:29<17:13:40, 366.98s/it]
[36m(TaskRunner pid=2544183)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 40}
[36m(TaskRunner pid=2544183)[0m validation generation end
[36m(TaskRunner pid=2544183)[0m step:40 - actor/entropy:0.24554915726184845 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003348910253180293 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.113663104874597e-05 - actor/grad_norm:0.130859375 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:251.54833459854126 - actor/lr:1e-06 - val-aux/openai/gsm8k/reward/mean@1:0.9006823351023503 - val-core/openai/gsm8k/acc/mean@1:0.9006823351023503 - val-aux/num_turns/min:2 - val-aux/num_turns/max:2 - val-aux/num_turns/mean:2.0 - training/global_step:40 - training/epoch:2 - critic/score/mean:0.91357421875 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.91357421875 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.061258453875780106 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.061258453875780106 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:288.752685546875 - response_length/max:3072.0 - response_length/min:65.0 - response_length/clip_ratio:0.013427734375 - response_length_non_aborted/mean:288.752685546875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:65.0 - response_length_non_aborted/clip_ratio:0.013427734375 - response/aborted_ratio:0.0 - prompt_length/mean:137.427734375 - prompt_length/max:235.0 - prompt_length/min:99.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.52710397541523e-05 - timing_s/agent_loop/generate_sequences/min:1.8113080197945237 - timing_s/agent_loop/generate_sequences/max:63.75043018814176 - timing_s/agent_loop/generate_sequences/mean:22.12734784021518 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:63.75043018814176 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:130 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:89.92435608385131 - timing_s/reward:0.005333710927516222 - timing_s/old_log_prob:56.89612507307902 - timing_s/ref:54.93945535784587 - timing_s/adv:0.13534079724922776 - timing_s/update_actor:151.89426846709102 - timing_s/step:355.24231966072693 - timing_s/testing:63.23593081207946 - timing_s/stop_profile:7.059285417199135e-05 - timing_per_token_ms/update_actor:0.0870137620218952 - timing_per_token_ms/adv:7.75309828510701e-05 - timing_per_token_ms/ref:0.03147247583707125 - timing_per_token_ms/gen:0.07603111450012835 - perf/total_num_tokens:1745635 - perf/time_per_step:355.24231966072693 - perf/throughput:614.2409361823653
[36m(TaskRunner pid=2544183)[0m step:41 - actor/entropy:0.21352176368236542 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00035223684361795904 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.7628072820771195e-05 - actor/grad_norm:0.1474609375 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:252.0338020324707 - actor/lr:1e-06 - training/global_step:41 - training/epoch:2 - critic/score/mean:0.937744140625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.937744140625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.051902156323194504 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.051902156323194504 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:243.775634765625 - response_length/max:3072.0 - response_length/min:59.0 - response_length/clip_ratio:0.009033203125 - response_length_non_aborted/mean:243.775634765625 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:59.0 - response_length_non_aborted/clip_ratio:0.009033203125 - response/aborted_ratio:0.0 - prompt_length/mean:136.541015625 - prompt_length/max:227.0 - prompt_length/min:98.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:9.211013093590736e-05 - timing_s/agent_loop/generate_sequences/min:1.7366895321756601 - timing_s/agent_loop/generate_sequences/max:60.08095827000216 - timing_s/agent_loop/generate_sequences/mean:20.31964436893611 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:60.08095827000216 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:129 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:76.49872620217502 - timing_s/reward:0.0001697242259979248 - timing_s/old_log_prob:57.55265555670485 - timing_s/ref:53.48743909411132 - timing_s/adv:0.1094651659950614 - timing_s/update_actor:158.17276288708672 - timing_s/step:347.01311422511935 - timing_s/stop_profile:6.599491462111473e-05 - timing_per_token_ms/update_actor:0.10153748764238188 - timing_per_token_ms/adv:7.027011311314867e-05 - timing_per_token_ms/ref:0.03433574837355496 - timing_per_token_ms/gen:0.07661326303040547 - perf/total_num_tokens:1557777 - perf/time_per_step:347.01311422511935 - perf/throughput:561.1376545085759
[36m(TaskRunner pid=2544183)[0m Training Progress:  20%|██        | 42/210 [4:12:27<17:00:40, 364.53s/it]Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076a7d40a8000005ce'
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076ab15cc4000005cf'
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076a3584aa000005d1'
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076a7d40a7000005d3'
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076aa62bf3000005d0'
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs000000076a219a27000005d2'
[36m(TaskRunner pid=2544183)[0m Traceback (most recent call last):
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 300, in _run_finalizers
[36m(TaskRunner pid=2544183)[0m     finalizer()
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 224, in __call__
[36m(TaskRunner pid=2544183)[0m     res = self._callback(*self._args, **self._kwargs)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/multiprocessing/util.py", line 133, in _remove_temp_dir
[36m(TaskRunner pid=2544183)[0m     rmtree(tempdir)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs0000000768baddd4000005d5'
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 725, in rmtree
[36m(TaskRunner pid=2544183)[0m     _rmtree_safe_fd(fd, path, onerror)
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 681, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     onerror(os.unlink, fullname, sys.exc_info())
[36m(TaskRunner pid=2544183)[0m   File "/home/hzhangex/anaconda3/envs/a2po/lib/python3.10/shutil.py", line 679, in _rmtree_safe_fd
[36m(TaskRunner pid=2544183)[0m     os.unlink(entry.name, dir_fd=topfd)
[36m(TaskRunner pid=2544183)[0m OSError: [Errno 16] Device or resource busy: '.nfs0000000764d8bc0d000005d4'
[36m(TaskRunner pid=2544183)[0m Training Progress:  20%|██        | 43/210 [4:18:15<16:40:51, 359.59s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  21%|██        | 44/210 [4:24:04<16:25:50, 356.33s/it]
[36m(TaskRunner pid=2544183)[0m step:42 - actor/entropy:0.24060600996017456 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.000329726454513235 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.8009707661833545e-05 - actor/grad_norm:0.11669921875 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:252.01641702651978 - actor/lr:1e-06 - training/global_step:42 - training/epoch:2 - critic/score/mean:0.92822265625 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.92822265625 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.09091492742300034 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.09091492742300034 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:277.7568359375 - response_length/max:3072.0 - response_length/min:57.0 - response_length/clip_ratio:0.0146484375 - response_length_non_aborted/mean:277.7568359375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:57.0 - response_length_non_aborted/clip_ratio:0.0146484375 - response/aborted_ratio:0.0 - prompt_length/mean:136.970703125 - prompt_length/max:250.0 - prompt_length/min:103.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:4.960130900144577e-05 - timing_s/agent_loop/generate_sequences/min:1.4118361989967525 - timing_s/agent_loop/generate_sequences/max:65.2444973778911 - timing_s/agent_loop/generate_sequences/mean:20.87133530659969 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:65.2444973778911 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:121 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:90.33548600412905 - timing_s/reward:0.00015149405226111412 - timing_s/old_log_prob:62.07983165374026 - timing_s/ref:54.36582439998165 - timing_s/adv:0.13516874518245459 - timing_s/update_actor:150.4711611471139 - timing_s/step:358.31336892116815 - timing_s/stop_profile:6.479304283857346e-05 - timing_per_token_ms/update_actor:0.08857893403938126 - timing_per_token_ms/adv:7.957075144782471e-05 - timing_per_token_ms/ref:0.03200391847055887 - timing_per_token_ms/gen:0.07940240944309097 - perf/total_num_tokens:1698724 - perf/time_per_step:358.31336892116815 - perf/throughput:592.6111566513072
[36m(TaskRunner pid=2544183)[0m step:43 - actor/entropy:0.18267327547073364 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00033253048148296216 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.6572360972920706e-05 - actor/grad_norm:0.08251953125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:247.61190605163574 - actor/lr:1e-06 - training/global_step:43 - training/epoch:3 - critic/score/mean:0.9453125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.9453125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0421409085392952 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0421409085392952 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:234.372802734375 - response_length/max:3072.0 - response_length/min:60.0 - response_length/clip_ratio:0.004150390625 - response_length_non_aborted/mean:234.372802734375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:60.0 - response_length_non_aborted/clip_ratio:0.004150390625 - response/aborted_ratio:0.0 - prompt_length/mean:137.484375 - prompt_length/max:271.0 - prompt_length/min:97.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.0003536418080329895 - timing_s/agent_loop/generate_sequences/min:1.337682945188135 - timing_s/agent_loop/generate_sequences/max:57.47128560207784 - timing_s/agent_loop/generate_sequences/mean:19.916717749640384 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:57.47128560207784 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:196 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:86.01560612907633 - timing_s/reward:0.00018544215708971024 - timing_s/old_log_prob:58.27910952735692 - timing_s/ref:53.23821228928864 - timing_s/adv:0.16433315305039287 - timing_s/update_actor:143.66300524072722 - timing_s/step:342.36397934285924 - timing_s/stop_profile:0.00014433125033974648 - timing_per_token_ms/update_actor:0.09432109419682483 - timing_per_token_ms/adv:0.00010789195717126206 - timing_per_token_ms/ref:0.034953232586178724 - timing_per_token_ms/gen:0.08960042972181649 - perf/total_num_tokens:1523127 - perf/time_per_step:342.36397934285924 - perf/throughput:556.1066189423325
[36m(TaskRunner pid=2544183)[0m step:44 - actor/entropy:0.22277911007404327 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003279240741473899 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.684605452531798e-05 - actor/grad_norm:0.1162109375 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:249.0575008392334 - actor/lr:1e-06 - training/global_step:44 - training/epoch:3 - critic/score/mean:0.93798828125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.93798828125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03796113282442093 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.03796113282442093 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:262.6171875 - response_length/max:3072.0 - response_length/min:53.0 - response_length/clip_ratio:0.0107421875 - response_length_non_aborted/mean:262.6171875 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:53.0 - response_length_non_aborted/clip_ratio:0.0107421875 - response/aborted_ratio:0.0 - prompt_length/mean:136.99609375 - prompt_length/max:218.0 - prompt_length/min:98.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:3.82130965590477e-05 - timing_s/agent_loop/generate_sequences/min:1.658820625860244 - timing_s/agent_loop/generate_sequences/max:61.81300732307136 - timing_s/agent_loop/generate_sequences/mean:20.771573191041057 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:61.81300732307136 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:125 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:86.41528496704996 - timing_s/reward:0.0050960080698132515 - timing_s/old_log_prob:56.614355423953384 - timing_s/ref:50.25631353305653 - timing_s/adv:0.23040506383404136 - timing_s/update_actor:152.71884242631495 - timing_s/step:348.2451515789144 - timing_s/stop_profile:5.515012890100479e-05 - timing_per_token_ms/update_actor:0.09330238855577838 - timing_per_token_ms/adv:0.00014076418108940856 - timing_per_token_ms/ref:0.030703703735213077 - timing_per_token_ms/gen:0.08033549472617317 - perf/total_num_tokens:1636816 - perf/time_per_step:348.2451515789144 - perf/throughput:587.5228960758008
[36m(TaskRunner pid=2544183)[0m Training Progress:  21%|██▏       | 45/210 [4:30:16<16:32:29, 360.91s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  22%|██▏       | 46/210 [4:36:14<16:24:40, 360.25s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  22%|██▏       | 47/210 [4:42:11<16:15:45, 359.17s/it]
[36m(TaskRunner pid=2544183)[0m step:45 - actor/entropy:0.25956326723098755 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.00035083339473374053 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.4298723882765216e-05 - actor/grad_norm:0.14453125 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:249.66053104400635 - actor/lr:1e-06 - training/global_step:45 - training/epoch:3 - critic/score/mean:0.913818359375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.913818359375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06051461026072502 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06051461026072502 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:285.581298828125 - response_length/max:3072.0 - response_length/min:63.0 - response_length/clip_ratio:0.012939453125 - response_length_non_aborted/mean:285.581298828125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:63.0 - response_length_non_aborted/clip_ratio:0.012939453125 - response/aborted_ratio:0.0 - prompt_length/mean:135.998046875 - prompt_length/max:232.0 - prompt_length/min:96.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:5.920417606830597e-05 - timing_s/agent_loop/generate_sequences/min:1.654054418206215 - timing_s/agent_loop/generate_sequences/max:62.91861072881147 - timing_s/agent_loop/generate_sequences/mean:21.14536830311522 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:62.91861072881147 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:117 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:87.94580098008737 - timing_s/reward:0.0072798216715455055 - timing_s/old_log_prob:65.05322988610715 - timing_s/ref:56.91027512261644 - timing_s/adv:0.15840231301262975 - timing_s/update_actor:159.28407048806548 - timing_s/step:371.1136330268346 - timing_s/stop_profile:7.509300485253334e-05 - timing_per_token_ms/update_actor:0.09224292631471795 - timing_per_token_ms/adv:9.17322921402845e-05 - timing_per_token_ms/ref:0.032957283792412646 - timing_per_token_ms/gen:0.0751839945595541 - perf/total_num_tokens:1726789 - perf/time_per_step:371.1136330268346 - perf/throughput:581.6240789634164
[36m(TaskRunner pid=2544183)[0m step:46 - actor/entropy:0.23743920028209686 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003370716641910576 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:4.162926290973701e-05 - actor/grad_norm:0.08154296875 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:252.00712156295776 - actor/lr:1e-06 - training/global_step:46 - training/epoch:3 - critic/score/mean:0.900146484375 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.900146484375 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06476090848445892 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.06476090848445892 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:275.647705078125 - response_length/max:3072.0 - response_length/min:63.0 - response_length/clip_ratio:0.01123046875 - response_length_non_aborted/mean:275.647705078125 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:63.0 - response_length_non_aborted/clip_ratio:0.01123046875 - response/aborted_ratio:0.0 - prompt_length/mean:136.658203125 - prompt_length/max:223.0 - prompt_length/min:97.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:0.00013035396113991737 - timing_s/agent_loop/generate_sequences/min:1.4781964290887117 - timing_s/agent_loop/generate_sequences/max:62.62296300986782 - timing_s/agent_loop/generate_sequences/mean:21.415729828416943 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:62.62296300986782 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:136 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:88.69501427235082 - timing_s/reward:0.004668530076742172 - timing_s/old_log_prob:59.000274672638625 - timing_s/ref:60.26175326528028 - timing_s/adv:0.1592273199930787 - timing_s/update_actor:148.91990514099598 - timing_s/step:358.27152190497145 - timing_s/stop_profile:5.0827860832214355e-05 - timing_per_token_ms/update_actor:0.08818063964815119 - timing_per_token_ms/adv:9.428401739281842e-05 - timing_per_token_ms/ref:0.03568307369132628 - timing_per_token_ms/gen:0.07855699800837589 - perf/total_num_tokens:1688805 - perf/time_per_step:358.27152190497145 - perf/throughput:589.2196618853583
[36m(TaskRunner pid=2544183)[0m step:47 - actor/entropy:0.256484717130661 - perf/mfu/actor_infer:0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/kl_loss:0.0003500495703949724 - actor/kl_coef:0.0010000000000000005 - actor/pg_loss:2.357974768685267e-05 - actor/grad_norm:0.09716796875 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:32.88169050216675 - perf/max_memory_reserved_gb:39.56640625 - perf/cpu_memory_used_gb:248.02609300613403 - actor/lr:1e-06 - training/global_step:47 - training/epoch:3 - critic/score/mean:0.92236328125 - critic/score/max:1.0 - critic/score/min:0.0 - critic/rewards/mean:0.92236328125 - critic/rewards/max:1.0 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0538705550134182 - critic/advantages/max:2.4748666286468506 - critic/advantages/min:-2.4748666286468506 - critic/returns/mean:-0.0538705550134182 - critic/returns/max:2.4748666286468506 - critic/returns/min:-2.4748666286468506 - response_length/mean:276.988037109375 - response_length/max:3072.0 - response_length/min:54.0 - response_length/clip_ratio:0.01416015625 - response_length_non_aborted/mean:276.988037109375 - response_length_non_aborted/max:3072.0 - response_length_non_aborted/min:54.0 - response_length_non_aborted/clip_ratio:0.01416015625 - response/aborted_ratio:0.0 - prompt_length/mean:136.6484375 - prompt_length/max:219.0 - prompt_length/min:95.0 - prompt_length/clip_ratio:0.0 - num_turns/min:2 - num_turns/max:2 - num_turns/mean:2.0 - timing_s/start_profile:4.578614607453346e-05 - timing_s/agent_loop/generate_sequences/min:1.388189238961786 - timing_s/agent_loop/generate_sequences/max:65.43299868516624 - timing_s/agent_loop/generate_sequences/mean:21.347697436076146 - timing_s/agent_loop/tool_calls/min:0.0 - timing_s/agent_loop/tool_calls/max:0.0 - timing_s/agent_loop/tool_calls/mean:0.0 - timing_s/agent_loop/slowest/generate_sequences:65.43299868516624 - timing_s/agent_loop/slowest/tool_calls:0.0 - timing_s/agent_loop/slowest/prompt_length:132 - timing_s/agent_loop/slowest/response_length:3072 - timing_s/gen:89.543813908007 - timing_s/reward:0.009487582370638847 - timing_s/old_log_prob:60.652162830810994 - timing_s/ref:53.34556676680222 - timing_s/adv:0.11567349312826991 - timing_s/update_actor:151.46830854797736 - timing_s/step:356.07469330495223 - timing_s/stop_profile:5.290703848004341e-05 - timing_per_token_ms/update_actor:0.08940112825281753 - timing_per_token_ms/adv:6.827395706565417e-05 - timing_per_token_ms/ref:0.0314861498220765 - timing_per_token_ms/gen:0.07892500672782521 - perf/total_num_tokens:1694255 - perf/time_per_step:356.07469330495223 - perf/throughput:594.7681174259249
[36m(TaskRunner pid=2544183)[0m Training Progress:  23%|██▎       | 48/210 [4:48:11<16:10:19, 359.38s/it]
[36m(TaskRunner pid=2544183)[0m Training Progress:  23%|██▎       | 49/210 [4:54:04<15:59:22, 357.53s/it]
